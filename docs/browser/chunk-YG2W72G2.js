import{a as rt}from"./chunk-DI4WVV2Y.js";import{a as Ke}from"./chunk-OY6EC6Y2.js";import{a as G}from"./chunk-CYXIDJUQ.js";import{$ as he,$a as q,A as h,B as m,G as He,Ha as _t,Ia as Me,K as a,L as r,La as V,M as u,N as pe,Na as T,O as ue,Oa as g,P as R,Pa as N,Q as f,Qa as ee,R as C,Ra as ge,S as ze,Sa as te,T as Ve,Ta as kt,U as Te,Ua as Ft,V as Ne,Va as ie,W as Y,Wa as ne,X as l,Xa as P,Y as b,Ya as A,Z as Q,Za as O,_ as Pe,_a as oe,ab as we,ba as H,ca as K,d as U,da as $,ea as Dt,fa as me,fb as fe,ga as it,h as B,ha as Ae,hb as k,ia as X,ib as _e,ja as F,jb as ve,ka as M,kb as De,la as J,lb as se,m as Ce,mb as ye,n as Je,na as Fe,nb as be,o as Ee,oa as I,p as D,pa as z,pb as Mt,q as Qe,r as Xe,s as S,t as E,ta as xt,u as W,ua as nt,v as et,va as ot,w as ke,x as c,y as _,z as tt}from"./chunk-XSDZE57B.js";import"./chunk-7RV22KDK.js";import{a as Mi}from"./chunk-7GML436D.js";import{a as Le,b as wt,g as Fi,i as Ye}from"./chunk-P2VZOJAX.js";var at=(()=>{class o{constructor(t){this.apiService=t}zoneList(t){let n=q.zoneList.replace("{pageNo}",t.pageNo).replace("{pageSize}",t?.pageSize);return this.apiService.get(n).pipe(B(e=>U(e)))}createZone(t){let n=q.addZone;return this.apiService.post(n,t).pipe(B(e=>U(e)))}updateZone(t,n){let e=q.updateZone.replace("{zoneId}",n);return this.apiService.put(e,t).pipe(B(i=>U(i)))}deleteZone(t){let n=q.updateZone.replace("{zoneId}",t);return this.apiService.delete(n).pipe(B(e=>U(e)))}static{this.\u0275fac=function(n){return new(n||o)(Ee(we))}}static{this.\u0275prov=Ce({token:o,factory:o.\u0275fac,providedIn:"root"})}}return o})();function Ii(o,p){o&1&&(a(0,"span",20),l(1," Zone Name is Required "),r())}function zi(o,p){o&1&&(a(0,"span",21),l(1," State is Required "),r())}function Vi(o,p){if(o&1&&(a(0,"option",22),l(1),r()),o&2){let t=p.$implicit;m("ngValue",t.id),c(),b(t.value)}}function Ti(o,p){o&1&&(a(0,"span",21),l(1," Status is Required "),r())}var zt=(()=>{class o{constructor(t,n,e,i,s){this.commonService=t,this.fb=n,this.zoneService=e,this.notificationSerivce=i,this.bsModelService=s,this.mapdata=new W,this.config={displayKey:"text",search:!0,height:"300px"},this.stateList=[],this.status=[{id:1,value:"Active"},{id:0,value:"Inactive"}],this.label="Create"}ngOnInit(){this.setInitialvalue()}getStateList(){this.commonService.stateList().subscribe(t=>{if(this.stateList=t?.body?.result,this.editData&&this.editData?.state_id){let n=this.stateList.find(e=>e.value==this.editData?.state_id);this.zoneForm.controls.state.setValue(n)}})}setInitialvalue(){this.editData?(this.getStateList(),this.label="Update",this.zoneForm=this.fb.group({name:[this.editData?.zone_name,[g.required]],state:[null,[g.required]],status:[this.editData?.is_active,[g.required]]})):(this.zoneForm=this.fb.group({name:["",[g.required]],state:[null,[g.required]],status:[1,[g.required]]}),this.getStateList())}submit(t){if(this.zoneForm.invalid){this.zoneForm.markAllAsTouched();return}let n=this.commonService.getUserDetails(),e={zone_id:0,zone_name:t?.name,state_id:t?.state?Number(t?.state?.value):null,state_name:t?.state?t?.state?.text:null,is_active:t?.status,created_by:n?.user_id},i=this.zoneService.createZone(e);this.editData?.zone_id&&(e.zone_id=this.editData?.zone_id,i=this.zoneService.updateZone(e,this.editData?.zone_id)),i.subscribe(s=>{s?.status==200?(this.bsModelService.hide(),this.mapdata.emit(),this.notificationSerivce.successAlert(s?.body?.actionResponse)):this.notificationSerivce.errorAlert(s?.title)})}close(){this.bsModelService.hide()}static{this.\u0275fac=function(n){return new(n||o)(_(G),_(oe),_(at),_(V),_(k))}}static{this.\u0275cmp=D({type:o,selectors:[["app-create-zone"]],outputs:{mapdata:"mapdata"},decls:33,vars:8,consts:[[1,"modal-header","text-center"],[1,"close-modal",3,"click"],[1,"fa","fa-close",2,"cursor","pointer"],[1,"modal-body"],[3,"formGroup"],[1,"_card","white-bg"],[1,"row"],[1,"col-md-6","mb-2"],[1,"form-label"],[1,"input-group","mb-2"],["type","text","formControlName","name","placeholder","Enter Zone Name","aria-describedby","button-addon2",1,"form-control"],["class","text-danger",4,"ngIf"],["formControlName","state",3,"config","options"],["class","text-danger mt-2",4,"ngIf"],["formControlName","status",1,"form-control"],[3,"ngValue",4,"ngFor","ngForOf"],[1,"footer"],[1,"button-container"],["type","submit",1,"btn","btn-success",3,"click"],["type","button",1,"btn","btn-danger",3,"click"],[1,"text-danger"],[1,"text-danger","mt-2"],[3,"ngValue"]],template:function(n,e){if(n&1&&(a(0,"div",0)(1,"h5"),l(2),r(),a(3,"div",1),f("click",function(){return e.close()}),u(4,"i",2),r()(),a(5,"div",3)(6,"div")(7,"form",4)(8,"div",5)(9,"div",6)(10,"div",7)(11,"label",8),l(12,"Zone Name"),r(),a(13,"div",9),u(14,"input",10),r(),h(15,Ii,2,0,"span",11),r(),a(16,"div",7)(17,"label",8),l(18,"State"),r(),u(19,"ngx-select-dropdown",12),h(20,zi,2,0,"span",13),r(),a(21,"div",7)(22,"label",8),l(23,"Status"),r(),a(24,"select",14),h(25,Vi,2,2,"option",15),r(),h(26,Ti,2,0,"span",13),r()()(),a(27,"div",16)(28,"div",17)(29,"button",18),f("click",function(){return e.submit(e.zoneForm.value)}),l(30,"Submit"),r(),a(31,"button",19),f("click",function(){return e.close()}),l(32,"Cancel"),r()()()()()()),n&2){let i,s,d;c(2),Q("",e.label," Zone"),c(5),m("formGroup",e.zoneForm),c(8),m("ngIf",(e.zoneForm==null||(i=e.zoneForm.get("name"))==null?null:i.invalid)&&((e.zoneForm==null||(i=e.zoneForm.get("name"))==null?null:i.dirty)||(e.zoneForm==null||(i=e.zoneForm.get("name"))==null?null:i.touched))),c(4),m("config",e.config)("options",e.stateList),c(),m("ngIf",(e.zoneForm==null||(s=e.zoneForm.get("state"))==null?null:s.invalid)&&((e.zoneForm==null||(s=e.zoneForm.get("state"))==null?null:s.dirty)||(e.zoneForm==null||(s=e.zoneForm.get("state"))==null?null:s.touched))),c(5),m("ngForOf",e.status),c(),m("ngIf",(e.zoneForm==null||(d=e.zoneForm.get("status"))==null?null:d.invalid)&&((e.zoneForm==null||(d=e.zoneForm.get("status"))==null?null:d.dirty)||(e.zoneForm==null||(d=e.zoneForm.get("status"))==null?null:d.touched)))}},dependencies:[I,z,se,te,A,O,T,P,N,ee,ie,ne]})}}return o})();var Ni=["table"],Pi=()=>[25,50,100],Vt=(o,p,t)=>({id:"zoneID",itemsPerPage:o,currentPage:p,totalItems:t});function Ai(o,p){if(o&1){let t=R();a(0,"div",22)(1,"div",26)(2,"pagination-controls",27),f("pageChange",function(e){S(t);let i=C();return E(i.onTablePageChange(e))}),r()()()}o&2&&(c(2),m("maxSize",10)("responsive",!0)("nextLabel","")("previousLabel",""))}function Oi(o,p){if(o&1&&(a(0,"option",28),l(1),r()),o&2){let t=p.$implicit;m("value",t),c(),b(t)}}function Ri(o,p){if(o&1&&(pe(0),u(1,"app-skeleton-loader",29),F(2,"paginate"),ue()),o&2){let t=C();c(),m("isLoading",t.isLoading)("columns",t.columns)("items",M(2,3,t.zoneList,X(6,Vt,t.pagesize.limit,t.pagesize.offset,t.pagesize.count)))}}function Ui(o,p){if(o&1&&(a(0,"th")(1,"span"),l(2),r()()),o&2){let t=p.$implicit;c(2),b(t==null?null:t.title)}}function Bi(o,p){o&1&&(a(0,"span",41),l(1,"Active"),r())}function qi(o,p){o&1&&(a(0,"span",42),l(1,"Inactive"),r())}function ji(o,p){if(o&1){let t=R();a(0,"tr")(1,"td"),l(2),r(),a(3,"td"),l(4),r(),a(5,"td"),l(6),r(),a(7,"td"),h(8,Bi,2,0,"span",35)(9,qi,2,0,"ng-template",null,2,J),r(),a(11,"td",36)(12,"button",37),f("click",function(){let e=S(t).$implicit,i=C(2);return E(i.onCreateZone(e))}),u(13,"i",38),r(),a(14,"button",39),f("click",function(){let e=S(t).$implicit,i=C(2);return E(i.onDeleteZone(e))}),u(15,"i",40),r()()()}if(o&2){let t=p.$implicit,n=p.index,e=Y(10),i=C(2);c(2),Q(" ",(i.pagesize.offset-1)*i.pagesize.limit+n+1," "),c(2),b((t==null?null:t.zone_name)||"NA"),c(2),b((t==null?null:t.state_name)||"NA"),c(2),m("ngIf",t==null?null:t.is_active)("ngIfElse",e)}}function Gi(o,p){o&1&&(a(0,"div",43),l(1," No zone Available "),r())}function Wi(o,p){if(o&1&&(a(0,"div",30)(1,"table",31,1)(3,"thead")(4,"tr",32),h(5,Ui,3,1,"th",33),r()(),a(6,"tbody"),h(7,ji,16,5,"tr",33),F(8,"searchFilter"),F(9,"paginate"),r()(),h(10,Gi,2,0,"div",34),F(11,"searchFilter"),r()),o&2){let t,n=C();c(5),m("ngForOf",n.columns),c(2),m("ngForOf",M(9,6,M(8,3,n.zoneList,n.searchKeyword),X(12,Vt,n.pagesize.limit,n.pagesize.offset,n.pagesize.count))),c(3),m("ngIf",!(n.zoneList!=null&&n.zoneList.length)||!((t=M(11,9,n.zoneList,n.searchKeyword))!=null&&t.length))}}var Tt=(()=>{class o{get startValue(){return this.pagesize.offset*this.pagesize.limit-(this.pagesize.limit-1)}get lastValue(){let t=this.startValue+this.pagesize.limit-1;return Math.min(t,this.pagesize.count)}constructor(t,n,e,i){this.commonService=t,this.modalService=n,this.zoneService=e,this.notificationSerivce=i,this.breadcrumbs=[{label:"Home",path:"/admin/dashboard/home"},{label:"Master",path:"/admin/master/zone-master"},{label:"Zone Master",path:"/admin/master/zone-master"}],this.isLoading=!1,this.pagesize={limit:25,offset:1,count:0}}ngOnInit(){this.tableProperty(),this.setInitialtable(),this.getZoneList(this.pagesize.offset,this.pagesize.limit)}setInitialtable(){this.columns=[{key:"S No.",title:"S No."},{key:"Zone Name",title:"Zone Name"},{key:"State Name",title:"State Name"},{key:"Status",title:"Status",width:"5%"},{key:"Action",title:"Action",width:"10%"}]}tableProperty(){this.configuration=Le({},De),this.configuration.checkboxes=!1,this.configuration.tableLayout.striped=!0,this.configuration.tableLayout.hover=!1,this.configuration.paginationRangeEnabled=!1,this.configuration.paginationEnabled=!1}getZoneList(t,n){this.isLoading=!0;let e={pageNo:t,pageSize:n};this.zoneService.zoneList(e).subscribe(i=>{setTimeout(()=>{this.isLoading=!1},600),this.zoneList=i?.body?.result||[],this.pagesize.count=i?.body?.totalRow},i=>{setTimeout(()=>{this.isLoading=!1},600),console.error("Error fetching zone list",i)})}onTablePageChange(t){this.pagesize.offset=t,this.getZoneList(this.pagesize.offset,this.pagesize.limit)}onCreateZone(t){let n={initialState:{editData:t||""}};this.bsModalRef=this.modalService.show(zt,Object.assign(n,{class:"modal-md modal-dialog-centered alert-popup"})),this.bsModalRef?.content?.mapdata?.subscribe(e=>{this.pagesize.offset=1,this.pagesize.limit=25,this.getZoneList(this.pagesize.offset,this.pagesize.limit)})}onDeleteZone(t){let n=this.zoneService.deleteZone(t?.zone_id),e={initialState:{title:t?.zone_name,content:"Are you sure you want to delete?",primaryActionLabel:"Delete",secondaryActionLabel:"Cancel",service:n}};this.bsModalRef=this.modalService.show(be,Object.assign(e,{id:"confirmation",class:"modal-md modal-dialog-centered"})),this.bsModalRef?.content.mapdata.subscribe(i=>{i?.status==200?(this.notificationSerivce.successAlert(i?.body?.actionResponse),this.pagesize.offset=1,this.pagesize.limit=25,this.getZoneList(this.pagesize.offset,this.pagesize.limit)):this.notificationSerivce.errorAlert(i?.title)})}onPageSizeChange(t){let n=parseInt(t.target.value,10);this.pagesize.limit=n,this.getZoneList(this.pagesize.offset,this.pagesize.limit)}static{this.\u0275fac=function(n){return new(n||o)(_(G),_(k),_(at),_(V))}}static{this.\u0275cmp=D({type:o,selectors:[["zone-list"]],viewQuery:function(n,e){if(n&1&&Ve(Ni,7),n&2){let i;Te(i=Ne())&&(e.table=i.first)}},decls:31,vars:10,consts:[["content",""],["TABLE",""],["inactive",""],[1,"card"],[1,"card-header"],[1,"header-part"],[1,"counting"],["class","row",4,"ngIf"],[1,"card-body"],[1,"header-container"],[1,"left-section"],[1,"search-form"],["placeholder","Search for...","type","text",1,"form-control","search-input",3,"ngModelChange","ngModel"],["type","button",1,"btn-search"],["aria-hidden","true",1,"fa","fa-search"],[1,"right-section","flex","gap-x-2"],[1,"flex","items-center","space-x-2"],["for","itemsPerPage",1,"text-sm","text-gray-700"],["id","itemsPerPage",1,"block","w-20","p-2","bg-white","border","border-gray-300","rounded","shadow-sm","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:border-blue-500","text-gray-700",3,"ngModelChange","change","ngModel"],[3,"value",4,"ngFor","ngForOf"],[1,"btn","btn-primary",3,"click"],["aria-hidden","true",1,"fa","fa-plus"],[1,"row"],[1,"col-md-12"],[1,"overflow-auto"],[4,"ngIf","ngIfElse"],[1,"d-flex","justify-content-center"],["id","zoneID",3,"pageChange","maxSize","responsive","nextLabel","previousLabel"],[3,"value"],[3,"isLoading","columns","items"],["id","datatable_wrapper"],["id","datatable","role","grid","aria-describedby","datatable_info","width","100%",1,"table","table-striped","nowrap","dataTable","no-footer","dtr-inline",2,"width","100%"],["role","row"],[4,"ngFor","ngForOf"],["class","text-center py-4 text-gray-500",4,"ngIf"],["class","text-green-600 font-medium",4,"ngIf","ngIfElse"],[1,"flex","space-x-2"],[1,"btn","btn-success",3,"click"],[1,"fa","fa-pencil"],[1,"btn","btn-danger",3,"click"],[1,"fa","fa-trash"],[1,"text-green-600","font-medium"],[1,"text-red-600","font-medium"],[1,"text-center","py-4","text-gray-500"]],template:function(n,e){if(n&1){let i=R();a(0,"div",3)(1,"div",4)(2,"div",5)(3,"span"),l(4,"Zone Master"),r(),a(5,"div",6)(6,"span"),l(7),r()(),h(8,Ai,3,4,"div",7),r()(),a(9,"div",8)(10,"div",9)(11,"div",10)(12,"div",11)(13,"input",12),$("ngModelChange",function(d){return S(i),K(e.searchKeyword,d)||(e.searchKeyword=d),E(d)}),r(),a(14,"button",13),u(15,"i",14),r()()(),a(16,"div",15)(17,"div",16)(18,"label",17),l(19,"Items per page:"),r(),a(20,"select",18),$("ngModelChange",function(d){return S(i),K(e.pagesize.limit,d)||(e.pagesize.limit=d),E(d)}),f("change",function(d){return S(i),E(e.onPageSizeChange(d))}),h(21,Oi,2,2,"option",19),r()(),a(22,"button",20),f("click",function(){return S(i),E(e.onCreateZone(""))}),u(23,"i",21),l(24," Create Zone "),r()()(),a(25,"div",22)(26,"div",23)(27,"div",24),h(28,Ri,3,10,"ng-container",25)(29,Wi,12,16,"ng-template",null,0,J),r()()()()()}if(n&2){let i=Y(30);c(7),he(" ",e.pagesize.count>0?e.startValue:0," - ",e.pagesize.count>0?e.lastValue:0," OF ",e.pagesize.count>0?e.pagesize.count:0," Zone "),c(),m("ngIf",e.pagesize.count&&e.pagesize.count>0),c(5),H("ngModel",e.searchKeyword),c(7),H("ngModel",e.pagesize.limit),c(),m("ngForOf",me(9,Pi)),c(7),m("ngIf",e.isLoading)("ngIfElse",i)}},dependencies:[I,z,ve,A,O,T,P,N,ge,ye,_e,fe]})}}return o})();var Nt=(()=>{class o{static{this.\u0275fac=function(n){return new(n||o)}}static{this.\u0275cmp=D({type:o,selectors:[["app-manage-zone-master"]],decls:2,vars:0,consts:[[1,"main-section"]],template:function(n,e){n&1&&(a(0,"div",0),u(1,"zone-list"),r())},dependencies:[Tt]})}}return o})();var Ie=(()=>{class o{constructor(t){this.apiService=t}userList(t){let n=q.user.replace("{pageNo}",t.pageNo).replace("{pageSize}",t?.pageSize).replace("{searchText}",t.searchText);return this.apiService.get(n).pipe(B(e=>U(e)))}createUser(t){let n=q.adduser;return this.apiService.post(n,t).pipe(B(e=>U(e)))}userById(t){let n=q.userById.replace("{userId}",t);return this.apiService.get(n).pipe(B(e=>U(e)))}updateUser(t,n){let e=q.userById.replace("{userId}",n);return this.apiService.put(e,t).pipe(B(i=>U(i)))}deleteUser(t){let n=q.userById.replace("{userId}",t);return this.apiService.delete(n).pipe(B(e=>U(e)))}static{this.\u0275fac=function(n){return new(n||o)(Ee(we))}}static{this.\u0275prov=Ce({token:o,factory:o.\u0275fac,providedIn:"root"})}}return o})();var Hi=(o,p)=>({"fa-eye":o,"fa-eye-slash":p});function Ki(o,p){o&1&&(a(0,"div")(1,"span",8),l(2,"Contact No. must be a 10-digit number."),r()())}function $i(o,p){o&1&&(a(0,"div")(1,"span",8),l(2,"Please enter a valid email address."),r()())}function Yi(o,p){if(o&1&&(a(0,"option",25),l(1),r()),o&2){let t=p.$implicit;m("ngValue",t.id),c(),b(t.value)}}function Ji(o,p){if(o&1&&(a(0,"div"),u(1,"img",26),r()),o&2){let t=C();c(),m("src",t.getImageUrl(t.imagePath),ke)}}var vt=(()=>{class o{constructor(t,n,e,i,s){this.commonService=t,this.fb=n,this.bsModelService=e,this.UserMasterService=i,this.notificationSerivce=s,this.mapdata=new W,this.config={displayKey:"text",search:!0,height:"300px",placeholder:"Select",noResultsFound:"",selectAllLabel:"Select all",enableSelectAll:!0},this.status=[{id:1,value:"Active"},{id:0,value:"Inactive"}],this.label="Create",this.imgeUrl=Me,this.showPassword=!1,this.photoBase64=null}ngOnInit(){this.initializeForm()}initializeForm(){this.userForm=this.fb.group({chiefEngineer:[null],zone:[null],supritendingEngineer:[null],circle:[null],executiveEngineer:[null],city:[null],assistantEngineer:[null],division:[null],name:[null,[g.required]],contactNo:[null],email:[null],address:[null],loginId:[null,g.required],loginPassword:[null,g.required],remarks:[null],status:[1,g.required],photo:[null]}),this.updateValidators()}updateValidators(){this.userForm.controls.chiefEngineer.clearValidators(),this.userForm.controls.supritendingEngineer.clearValidators(),this.userForm.controls.executiveEngineer.clearValidators(),this.userForm.controls.assistantEngineer.clearValidators(),this.userForm.controls.zone.clearValidators(),this.userForm.controls.circle.clearValidators(),this.userForm.controls.city.clearValidators(),this.userForm.controls.division.clearValidators(),this.userForm.get("contactNo")?.valueChanges.subscribe(t=>{this.userForm.controls.contactNo.setValidators([g.pattern(/^\d{10}$/)])}),this.userForm.get("email")?.valueChanges.subscribe(t=>{this.userForm.controls.email.setValidators([g.email])}),this.designation?.value==="2"?this.userForm.controls.zone.setValidators(g.required):["3","4","5","6"].includes(this.designation?.value)&&(this.userForm.controls.chiefEngineer.setValidators(g.required),this.userForm.controls.zone.setValidators(g.required),this.userForm.controls.circle.setValidators(g.required)),["4","5","6"].includes(this.designation?.value)&&(this.userForm.controls.supritendingEngineer.setValidators(g.required),this.userForm.controls.city.setValidators(g.required)),["5","6"].includes(this.designation?.value)&&(this.userForm.controls.executiveEngineer.setValidators(g.required),this.userForm.controls.division.setValidators(g.required)),this.designation?.value==="6"&&this.userForm.controls.assistantEngineer.setValidators(g.required),this.userForm.updateValueAndValidity(),this.editData&&(this.getChiefBasedOnId(this.editData?.user_id),this.label="Update")}getChiefBasedOnId(t){this.UserMasterService.userById(t).subscribe(n=>{this.userData=n?.body?.result,this.userForm&&(this.userForm.patchValue({name:this.userData?.full_name,contactNo:this.userData?.contact_no,email:this.userData?.email_id,address:this.userData?.cur_address,loginId:this.userData?.login_id,loginPassword:this.userData?.login_pass,remarks:this.userData?.remarks,status:this.userData?.is_active}),this.imagePath=this.userData?.img_path)})}getImageUrl(t){return t?`${this.imgeUrl}${t.replace(/\\/g,"/")}`:""}getChiefEngList(){this.commonService.chiefEngList().subscribe({next:t=>{if(this.chiefEngData=t?.body?.result||[],this.chiefEngData.length>0&&this.chiefEngData.length===1){let n=this.chiefEngData[0].value;this.userForm.controls.chiefEngineer.setValue(this.chiefEngData[0]),this.designation?.value!=="3"?this.getSupritendingEngList(n):this.getZoneBasedOnCE(n)}else this.supritendingEngList=[],this.zoneList=[],this.userForm.controls.zone.setValue(null),this.userForm.controls.chiefEngineer.setValue(null),this.userForm.controls.supritendingEngineer.setValue(null)},error:t=>{console.error("Error fetching Chief Engineer List:",t)}})}onChiefEngineerChange(t){this.getZoneBasedOnCE(t.value.value),this.designation?.value!=="3"&&(t?.value?.value?this.getSupritendingEngList(t.value.value):(this.supritendingEngList=[],this.zoneList=[],this.userForm.controls.zone.setValue(null),this.userForm.controls.supritendingEngineer.setValue(null)))}getSupritendingEngList(t){this.commonService.supritendingEngList(t).subscribe({next:n=>{if(this.supritendingEngList=n?.body?.result||[],this.supritendingEngList.length>0&&this.supritendingEngList.length===1){let e=this.supritendingEngList[0].value;this.userForm.controls.supritendingEngineer.setValue(this.supritendingEngList[0]),this.designation?.value!=="4"&&this.getExecutiveEngList(e)}else this.executiveEngList=[],this.assistantEngList=[],this.userForm.controls.supritendingEngineer.setValue(null),this.userForm.controls.executiveEngineer.setValue(null),this.userForm.controls.assistantEngineer.setValue(null)},error:n=>{console.error("Error fetching Supritending Engineer List:",n)}})}onSupritendingEngineerChange(t){this.designation?.value!=="4"&&(t?.value?.value?this.getExecutiveEngList(t.value.value):(this.executiveEngList=[],this.assistantEngList=[],this.userForm.controls.executiveEngineer.setValue(null),this.userForm.controls.assistantEngineer.setValue(null)))}getExecutiveEngList(t){this.commonService.executiveEngList(t).subscribe({next:n=>{if(this.executiveEngList=n?.body?.result||[],this.executiveEngList.length>0&&this.executiveEngList.length===1){let e=this.executiveEngList[0].value;this.userForm.controls.executiveEngineer.setValue(this.executiveEngList[0]),this.getAssistantEngList(e)}else this.assistantEngList=[],this.userForm.controls.executiveEngineer.setValue(null),this.userForm.controls.assistantEngineer.setValue(null)},error:n=>{console.error("Error fetching Executive Engineer List:",n)}})}onExecutiveEngineerChange(t){t?.value?.value?this.getAssistantEngList(t.value.value):(this.assistantEngList=[],this.userForm.controls.assistantEngineer.setValue(null))}getAssistantEngList(t){this.commonService.assistantEngList(t).subscribe({next:n=>{this.assistantEngList=n?.body?.result||[],this.assistantEngList.length>0&&this.assistantEngList.length===1?this.userForm.controls.assistantEngineer.setValue(this.assistantEngList[0]):this.userForm.controls.assistantEngineer.setValue(null)},error:n=>{console.error("Error fetching Assistant Engineer List:",n)}})}getZoneList(){this.commonService.zoneList(30).subscribe({next:t=>{this.zoneList=t?.body?.result||[],this.zoneList.length>0&&this.zoneList.length===1?this.userForm.controls.zone.setValue(this.zoneList[0]):this.userForm.controls.zone.setValue(null)},error:t=>{console.error("Error fetching Zone List:",t)}})}onZoneChange(t){this.designation?.value!=="2"&&(t?.value?.value?this.getCircleList(t.value.value):(this.circleList=[],this.cityList=[],this.divisionData=[],this.userForm.controls.circle.setValue(null),this.userForm.controls.city.setValue(null),this.userForm.controls.division.setValue(null)))}getCircleList(t){this.circleList=[],this.commonService.circleList(t).subscribe({next:n=>{if(this.circleList=n?.body?.result||[],this.circleList.length>0&&this.circleList.length===1){let e=this.circleList[0].value;this.userForm.controls.circle.setValue(this.circleList[0]),this.designation?.value!=="3"&&this.getCityList(e)}else this.cityList=[],this.userForm.controls.circle.setValue(null),this.userForm.controls.city.setValue(null)},error:n=>{console.error("Error fetching Circle List:",n)}})}onCircleChange(t){this.designation?.value!=="3"&&(t?.value?.value?this.getCityList(t.value.value):(this.cityList=[],this.divisionData=[],this.userForm.controls.city.setValue(null),this.userForm.controls.division.setValue(null)))}getCityList(t){this.commonService.cityList(t).subscribe({next:n=>{if(this.cityList=n?.body?.result||[],this.cityList.length>0&&this.cityList.length===1){let e=this.cityList[0].value;this.userForm.controls.city.setValue(this.cityList[0]),this.designation?.value!=="4"&&this.getDivisionList(e)}else this.userForm.controls.city.setValue(null),this.divisionData=[],this.userForm.controls.division.setValue(null)},error:n=>{console.error("Error fetching City List:",n)}})}onCityChange(t){this.designation?.value!=="4"&&(t?.value?.value?this.getDivisionList(t.value.value):(this.divisionData=[],this.userForm.controls.division.setValue(null)))}getDivisionList(t){this.commonService.divisionList(t).subscribe({next:n=>{this.divisionData=n?.body?.result||[],this.divisionData.length>0&&this.divisionData.length===1?this.userForm.controls.division.setValue(this.divisionData[0]):this.userForm.controls.division.setValue(null)},error:n=>{console.error("Error fetching Division List:",n)}})}getSelectedValues(t){return console.log(t),t?.map(n=>n.value).join(",")}close(){this.bsModelService.hide()}onFileChange(t){let n=t.target.files[0];if(n){let e=new FileReader;e.onload=()=>{let i=e.result;this.photoBase64=i.split(",")[1]},e.onerror=i=>{console.error("Error reading file:",i),this.notificationSerivce.errorAlert("Failed to read file. Please try again.")},e.readAsDataURL(n)}}submit(t){let n=this.commonService.getUserDetails(),e={user_id:0,department_id:this.department?Number(this.department?.value):null,emp_id:0,full_name:t?.name,contact_no:t?.contactNo,email_id:t?.email,cur_address:t?.address,login_id:t?.loginId,login_pass:t?.loginPassword,designation_id:this.designation?Number(this.designation?.value):null,level_id:this.designation?Number(this.designation?.value):null,chief_eng_id:t?.chiefEngineer?Number(t?.chiefEngineer?.value):null,zone:this.designation?.value==="2"?t?.zone?this.getSelectedValues(t.zone):null:t?.zone?t.zone.value:null,sup_eng_id:t?.supritendingEngineer?Number(t?.supritendingEngineer?.value):null,circle:this.designation?.value==="3"?t?.circle?this.getSelectedValues(t?.circle):null:t?.circle?t?.circle.value:null,exec_eng_id:t?.executiveEngineer?Number(t?.executiveEngineer?.value):null,district:this.designation?.value==="4"?t?.city?this.getSelectedValues(t?.city):null:t?.city?t?.city.value:null,ass_eng_id:t?.assistantEngineer?Number(t?.assistantEngineer?.value):null,division:this.designation?.value==="5"?t?.division?this.getSelectedValues(t?.division):null:t?.division?t?.division.value:null,remarks:t?.remarks,img_path:this.photoBase64,is_active:t?.status,created_by:n?.user_id},i=this.UserMasterService.createUser(e);this.userData&&(e.user_id=this.userData?.user_id,i=this.UserMasterService.updateUser(e,this.userData?.user_id)),i.subscribe(s=>{s?.status==200?(this.bsModelService.hide(),this.mapdata.emit(),this.notificationSerivce.successAlert(s?.body?.actionResponse)):this.notificationSerivce.errorAlert(s?.title)})}getZoneBasedOnCE(t){this.commonService.getZoneByChiefEng(t).subscribe({next:n=>{if(this.zoneList=n?.body?.result||[],this.zoneList.length>0&&this.zoneList.length===1){let e=this.zoneList[0].value;this.userForm.controls.zone.setValue(this.zoneList[0]),this.getCircleList(e)}else this.circleList=[],this.userForm.controls.zone.setValue(null),this.userForm.controls.circle.setValue(null)},error:n=>{console.error("Error fetching Zone List:",n)}})}getCircleBasedOnSE(t){this.commonService.getCircleBySupEng(t).subscribe({next:n=>{if(this.circleList=n?.body?.result||[],this.circleList.length>0&&this.circleList.length===1){let e=this.circleList[0].value;this.userForm.controls.circle.setValue(this.circleList[0]),this.getCityList(e)}else this.cityList=[],this.divisionData=[],this.userForm.controls.circle.setValue(null),this.userForm.controls.city.setValue(null),this.userForm.controls.division.setValue(null)},error:n=>{console.error("Error fetching Circle List:",n)}})}static{this.\u0275fac=function(n){return new(n||o)(_(G),_(oe),_(k),_(Ie),_(V))}}static{this.\u0275cmp=D({type:o,selectors:[["app-create-user"]],outputs:{mapdata:"mapdata"},decls:65,vars:13,consts:[[1,"modal-header","text-center"],[1,"close-modal",3,"click"],[1,"fa","fa-close",2,"cursor","pointer"],[1,"modal-body"],[3,"formGroup"],[1,"row"],[1,"col-md-3","mb-2"],[1,"form-label"],[1,"text-danger"],[1,"input-group","mb-2"],["type","text","placeholder","Enter Name","formControlName","name",1,"form-control"],["type","text","placeholder","Enter Contact No.","formControlName","contactNo",1,"form-control"],[4,"ngIf"],["type","email","placeholder","Enter Email","formControlName","email",1,"form-control"],["type","text","placeholder","Enter Address","formControlName","address",1,"form-control"],["type","text","placeholder","Enter Login Id","formControlName","loginId",1,"form-control"],[1,"input-group","mb-2","password-container"],["placeholder","Enter Login Password","formControlName","loginPassword",1,"form-control","password",3,"type"],["id","visiblePassword",1,"fa",2,"cursor","pointer",3,"click","ngClass"],["type","text","placeholder","Enter Remarks","formControlName","remarks",1,"form-control"],["formControlName","status",1,"form-control"],[3,"ngValue",4,"ngFor","ngForOf"],["type","file","formControlName","photo",1,"form-control",3,"change"],[1,"col-md-3","mb-2","mt-4"],[1,"btn","btn-success",3,"click","disabled"],[3,"ngValue"],["alt","Profile Photo",1,"w-10","h-10","rounded-full","profile-image","mb-2",3,"src"]],template:function(n,e){if(n&1&&(a(0,"div",0)(1,"h5"),l(2),r(),a(3,"div",1),f("click",function(){return e.close()}),u(4,"i",2),r()(),a(5,"div",3)(6,"form",4)(7,"div",5)(8,"div",6)(9,"label",7),l(10,"Name "),a(11,"span",8),l(12,"*"),r()(),a(13,"div",9),u(14,"input",10),r()(),a(15,"div",6)(16,"label",7),l(17,"Contact No."),r(),a(18,"div",9),u(19,"input",11),r(),h(20,Ki,3,0,"div",12),r(),a(21,"div",6)(22,"label",7),l(23,"Email"),r(),a(24,"div",9),u(25,"input",13),r(),h(26,$i,3,0,"div",12),r(),a(27,"div",6)(28,"label",7),l(29,"Address"),r(),u(30,"input",14),r(),a(31,"div",6)(32,"label",7),l(33,"Login Id "),a(34,"span",8),l(35,"*"),r()(),a(36,"div",9),u(37,"input",15),r()(),a(38,"div",6)(39,"label",7),l(40,"Login Password "),a(41,"span",8),l(42,"*"),r()(),a(43,"div",16),u(44,"input",17),a(45,"i",18),f("click",function(){return e.showPassword=!e.showPassword}),r()()(),a(46,"div",6)(47,"label",7),l(48,"Remarks"),r(),u(49,"input",19),r(),a(50,"div",6)(51,"label",7),l(52,"Status "),a(53,"span",8),l(54,"*"),r()(),a(55,"select",20),h(56,Yi,2,2,"option",21),r()(),a(57,"div",6)(58,"label",7),l(59,"Photo"),r(),h(60,Ji,2,1,"div",12),a(61,"input",22),f("change",function(s){return e.onFileChange(s)}),r()(),a(62,"div",23)(63,"button",24),f("click",function(){return e.submit(e.userForm.value)}),l(64,"Submit"),r()()()()()),n&2){let i,s;c(2),Pe("",e.label," ",e.designation==null?null:e.designation.text,""),c(4),m("formGroup",e.userForm),c(14),m("ngIf",((i=e.userForm.get("contactNo"))==null?null:i.invalid)&&((i=e.userForm.get("contactNo"))==null?null:i.touched)),c(6),m("ngIf",((s=e.userForm.get("email"))==null?null:s.invalid)&&((s=e.userForm.get("email"))==null?null:s.touched)),c(18),ze("type",e.showPassword?"text":"password"),c(),m("ngClass",Ae(10,Hi,!e.showPassword,e.showPassword)),c(11),m("ngForOf",e.status),c(4),m("ngIf",e.imagePath),c(3),m("disabled",e.userForm.invalid)}},dependencies:[Fe,I,z,te,A,O,T,P,N,ee,ie,ne],styles:["button.btn.btn-success[_ngcontent-%COMP%]{width:100%}.profile-image[_ngcontent-%COMP%]{transition:transform .3s ease,box-shadow .3s ease}.profile-image[_ngcontent-%COMP%]:hover{-webkit-transform:scale(3.5);transform:scale(3.5)}.password-container[_ngcontent-%COMP%]{position:relative}.password-container[_ngcontent-%COMP%]   .password[_ngcontent-%COMP%]{width:100%}.password-container[_ngcontent-%COMP%]   .fa[_ngcontent-%COMP%]{position:absolute;top:50%;right:10px;transform:translateY(-50%);color:#666;font-size:16px;z-index:9}"]})}}return o})();var Qi=(o,p)=>({"fa-eye":o,"fa-eye-slash":p});function Xi(o,p){o&1&&(a(0,"div")(1,"span",8),l(2,"Zone is required."),r()())}function en(o,p){o&1&&(a(0,"div")(1,"span",8),l(2,"Contact No. must be a 10-digit number."),r()())}function tn(o,p){o&1&&(a(0,"div")(1,"span",8),l(2,"Please enter a valid email address."),r()())}function nn(o,p){if(o&1&&(a(0,"option",26),l(1),r()),o&2){let t=p.$implicit;m("ngValue",t.id),c(),b(t.value)}}function on(o,p){if(o&1&&(a(0,"div"),u(1,"img",27),r()),o&2){let t=C();c(),m("src",t.getImageUrl(t.imagePath),ke)}}var yt=(()=>{class o{constructor(t,n,e,i,s){this.commonService=t,this.fb=n,this.bsModelService=e,this.UserMasterService=i,this.notificationSerivce=s,this.mapdata=new W,this.config={displayKey:"text",search:!0,height:"300px",placeholder:"Select",noResultsFound:"",selectAllLabel:"Select all",enableSelectAll:!0},this.imgeUrl=Me,this.status=[{id:1,value:"Active"},{id:0,value:"Inactive"}],this.label="Create",this.showPassword=!1,this.photoBase64=null}ngOnInit(){this.initializeForm()}initializeForm(){this.userForm=this.fb.group({chiefEngineer:[null],zone:[null],supritendingEngineer:[null],circle:[null],executiveEngineer:[null],city:[null],assistantEngineer:[null],division:[null],name:[null,[g.required]],contactNo:[null],email:[null],address:[null],loginId:[null,g.required],loginPassword:[null,g.required],remarks:[null],status:[1,g.required],photo:[null]}),this.updateValidators(),this.editData?(this.getChiefBasedOnId(this.editData?.user_id),this.label="Update"):this.getZoneList()}updateValidators(){this.userForm.controls.chiefEngineer.clearValidators(),this.userForm.controls.supritendingEngineer.clearValidators(),this.userForm.controls.executiveEngineer.clearValidators(),this.userForm.controls.assistantEngineer.clearValidators(),this.userForm.controls.zone.clearValidators(),this.userForm.controls.circle.clearValidators(),this.userForm.controls.city.clearValidators(),this.userForm.controls.division.clearValidators(),this.userForm.get("contactNo")?.valueChanges.subscribe(t=>{this.userForm.controls.contactNo.setValidators([g.pattern(/^\d{10}$/)])}),this.userForm.get("email")?.valueChanges.subscribe(t=>{this.userForm.controls.email.setValidators([g.email])}),this.designation?.value==="2"?this.userForm.controls.zone.setValidators(g.required):["3","4","5","6"].includes(this.designation?.value)&&(this.userForm.controls.chiefEngineer.setValidators(g.required),this.userForm.controls.zone.setValidators(g.required),this.userForm.controls.circle.setValidators(g.required)),["4","5","6"].includes(this.designation?.value)&&(this.userForm.controls.supritendingEngineer.setValidators(g.required),this.userForm.controls.city.setValidators(g.required)),["5","6"].includes(this.designation?.value)&&(this.userForm.controls.executiveEngineer.setValidators(g.required),this.userForm.controls.division.setValidators(g.required)),this.designation?.value==="6"&&this.userForm.controls.assistantEngineer.setValidators(g.required),this.userForm.updateValueAndValidity()}getChiefBasedOnId(t){this.UserMasterService.userById(t).subscribe(n=>{this.userData=n?.body?.result,this.userForm&&(this.userForm.patchValue({name:this.userData?.full_name,contactNo:this.userData?.contact_no,email:this.userData?.email_id,address:this.userData?.cur_address,loginId:this.userData?.login_id,loginPassword:this.userData?.login_pass,remarks:this.userData?.remarks,status:this.userData?.is_active}),this.imagePath=this.userData?.img_path,this.getZoneList())})}getImageUrl(t){return t?`${this.imgeUrl}${t.replace(/\\/g,"/")}`:""}getZoneList(){this.commonService.zoneList(30).subscribe(t=>{if(this.zoneList=t?.body?.result||[],this.userData){let n=this.userData?.zone;if(n){let e;if(n.includes(",")){let i=n.split(",").map(s=>s.trim());e=this.zoneList.filter(s=>i.includes(s?.value.toString()))}else e=this.zoneList.find(i=>i?.value.toString()===n.toString());this.userForm.controls.zone.setValue(e||null)}}else this.zoneList.length>0&&this.zoneList.length===1?this.userForm.controls.zone.setValue(this.zoneList[0]):this.userForm.controls.zone.setValue(null)})}getSelectedValues(t){return Array.isArray(t)?t?.map(n=>n.value).join(","):t?.value}close(){this.bsModelService.hide()}onFileChange(t){let n=t.target.files[0];if(n){let e=new FileReader;e.onload=()=>{let i=e.result;this.photoBase64=i.split(",")[1]},e.onerror=i=>{console.error("Error reading file:",i),this.notificationSerivce.errorAlert("Failed to read file. Please try again.")},e.readAsDataURL(n)}}submit(t){let n=this.commonService.getUserDetails(),e={user_id:0,department_id:this.department?Number(this.department?.value):null,emp_id:0,full_name:t?.name,contact_no:t?.contactNo,email_id:t?.email,cur_address:t?.address,login_id:t?.loginId,login_pass:t?.loginPassword,designation_id:this.designation?Number(this.designation?.value):null,level_id:this.designation?Number(this.designation?.value):null,chief_eng_id:t?.chiefEngineer?Number(t?.chiefEngineer?.value):null,zone:this.designation?.value==="2"?t?.zone?this.getSelectedValues(t.zone):null:t?.zone?t.zone.value:null,sup_eng_id:t?.supritendingEngineer?Number(t?.supritendingEngineer?.value):null,circle:this.designation?.value==="3"?t?.circle?this.getSelectedValues(t?.circle):null:t?.circle?t?.circle.value:null,exec_eng_id:t?.executiveEngineer?Number(t?.executiveEngineer?.value):null,district:this.designation?.value==="4"?t?.city?this.getSelectedValues(t?.city):null:t?.city?t?.city.value:null,ass_eng_id:t?.assistantEngineer?Number(t?.assistantEngineer?.value):null,division:this.designation?.value==="5"?t?.division?this.getSelectedValues(t?.division):null:t?.division?t?.division.value:null,remarks:t?.remarks,img_path:this.photoBase64,is_active:t?.status,created_by:n?.user_id},i=this.UserMasterService.createUser(e);this.userData&&(e.user_id=this.userData?.user_id,i=this.UserMasterService.updateUser(e,this.userData?.user_id)),i.subscribe(s=>{s?.status==200?(this.bsModelService.hide(),this.mapdata.emit(),this.notificationSerivce.successAlert(s?.body?.actionResponse)):this.notificationSerivce.errorAlert(s?.title)})}static{this.\u0275fac=function(n){return new(n||o)(_(G),_(oe),_(k),_(Ie),_(V))}}static{this.\u0275cmp=D({type:o,selectors:[["app-crate-chief-eng"]],outputs:{mapdata:"mapdata"},decls:72,vars:17,consts:[[1,"modal-header","text-center"],[1,"close-modal",3,"click"],[1,"fa","fa-close",2,"cursor","pointer"],[1,"modal-body"],[3,"formGroup"],[1,"row"],[1,"col-md-3","mb-2"],[1,"form-label"],[1,"text-danger"],["formControlName","zone",3,"config","multiple","options"],[4,"ngIf"],[1,"input-group","mb-2"],["type","text","placeholder","Enter Name","formControlName","name",1,"form-control"],["type","text","placeholder","Enter Contact No.","formControlName","contactNo",1,"form-control"],["type","email","placeholder","Enter Email","formControlName","email",1,"form-control"],["type","text","placeholder","Enter Address","formControlName","address",1,"form-control"],["type","text","placeholder","Enter Login Id","formControlName","loginId",1,"form-control"],[1,"input-group","mb-2","password-container"],["placeholder","Enter Login Password","formControlName","loginPassword",1,"form-control","password",3,"type"],["id","visiblePassword",1,"fa",2,"cursor","pointer",3,"click","ngClass"],["type","text","placeholder","Enter Remarks","formControlName","remarks",1,"form-control"],["formControlName","status",1,"form-control"],[3,"ngValue",4,"ngFor","ngForOf"],["type","file","formControlName","photo",1,"form-control",3,"change"],[1,"col-md-3","mb-2","mt-4"],[1,"btn","btn-success",3,"click","disabled"],[3,"ngValue"],["alt","Profile Photo",1,"w-10","h-10","rounded-full","profile-image","mb-2",3,"src"]],template:function(n,e){if(n&1&&(a(0,"div",0)(1,"h5"),l(2),r(),a(3,"div",1),f("click",function(){return e.close()}),u(4,"i",2),r()(),a(5,"div",3)(6,"form",4)(7,"div",5)(8,"div",6)(9,"label",7),l(10,"Zone "),a(11,"span",8),l(12,"*"),r()(),u(13,"ngx-select-dropdown",9),h(14,Xi,3,0,"div",10),r(),a(15,"div",6)(16,"label",7),l(17,"Name "),a(18,"span",8),l(19,"*"),r()(),a(20,"div",11),u(21,"input",12),r()(),a(22,"div",6)(23,"label",7),l(24,"Contact No."),r(),a(25,"div",11),u(26,"input",13),r(),h(27,en,3,0,"div",10),r(),a(28,"div",6)(29,"label",7),l(30,"Email"),r(),a(31,"div",11),u(32,"input",14),r(),h(33,tn,3,0,"div",10),r(),a(34,"div",6)(35,"label",7),l(36,"Address"),r(),u(37,"input",15),r(),a(38,"div",6)(39,"label",7),l(40,"Login Id "),a(41,"span",8),l(42,"*"),r()(),a(43,"div",11),u(44,"input",16),r()(),a(45,"div",6)(46,"label",7),l(47,"Login Password "),a(48,"span",8),l(49,"*"),r()(),a(50,"div",17),u(51,"input",18),a(52,"i",19),f("click",function(){return e.showPassword=!e.showPassword}),r()()(),a(53,"div",6)(54,"label",7),l(55,"Remarks"),r(),u(56,"input",20),r(),a(57,"div",6)(58,"label",7),l(59,"Status "),a(60,"span",8),l(61,"*"),r()(),a(62,"select",21),h(63,nn,2,2,"option",22),r()(),a(64,"div",6)(65,"label",7),l(66,"Photo"),r(),h(67,on,2,1,"div",10),a(68,"input",23),f("change",function(s){return e.onFileChange(s)}),r()(),a(69,"div",24)(70,"button",25),f("click",function(){return e.submit(e.userForm.value)}),l(71,"Submit"),r()()()()()),n&2){let i,s,d;c(2),Pe("",e.label," ",e.designation==null?null:e.designation.text,""),c(4),m("formGroup",e.userForm),c(7),m("config",e.config)("multiple",!0)("options",e.zoneList),c(),m("ngIf",((i=e.userForm.get("zone"))==null?null:i.invalid)&&((i=e.userForm.get("zone"))==null?null:i.touched)),c(13),m("ngIf",((s=e.userForm.get("contactNo"))==null?null:s.invalid)&&((s=e.userForm.get("contactNo"))==null?null:s.touched)),c(6),m("ngIf",((d=e.userForm.get("email"))==null?null:d.invalid)&&((d=e.userForm.get("email"))==null?null:d.touched)),c(18),ze("type",e.showPassword?"text":"password"),c(),m("ngClass",Ae(14,Qi,!e.showPassword,e.showPassword)),c(11),m("ngForOf",e.status),c(4),m("ngIf",e.imagePath),c(3),m("disabled",e.userForm.invalid)}},dependencies:[Fe,I,z,se,te,A,O,T,P,N,ee,ie,ne],styles:[".profile-image[_ngcontent-%COMP%]{transition:transform .3s ease,box-shadow .3s ease}.profile-image[_ngcontent-%COMP%]:hover{-webkit-transform:scale(3.5);transform:scale(3.5)}.password-container[_ngcontent-%COMP%]{position:relative}.password-container[_ngcontent-%COMP%]   .password[_ngcontent-%COMP%]{width:100%}.password-container[_ngcontent-%COMP%]   .fa[_ngcontent-%COMP%]{position:absolute;top:50%;right:10px;transform:translateY(-50%);color:#666;font-size:16px;z-index:9}"]})}}return o})();var rn=(o,p)=>({"fa-eye":o,"fa-eye-slash":p});function an(o,p){o&1&&(a(0,"div")(1,"span",8),l(2,"Chief Engineer is required."),r()())}function sn(o,p){o&1&&(a(0,"div")(1,"span",8),l(2,"Zone is required."),r()())}function ln(o,p){o&1&&(a(0,"div")(1,"span",8),l(2,"Circle is required."),r()())}function cn(o,p){o&1&&(a(0,"div")(1,"span",8),l(2,"Contact No. must be a 10-digit number."),r()())}function dn(o,p){o&1&&(a(0,"div")(1,"span",8),l(2,"Please enter a valid email address."),r()())}function mn(o,p){if(o&1&&(a(0,"option",28),l(1),r()),o&2){let t=p.$implicit;m("ngValue",t.id),c(),b(t.value)}}function pn(o,p){if(o&1&&(a(0,"div"),u(1,"img",29),r()),o&2){let t=C();c(),m("src",t.getImageUrl(t.imagePath),ke)}}var bt=(()=>{class o{constructor(t,n,e,i,s){this.commonService=t,this.fb=n,this.bsModelService=e,this.UserMasterService=i,this.notificationSerivce=s,this.mapdata=new W,this.config={displayKey:"text",search:!0,height:"300px",placeholder:"Select",noResultsFound:"",selectAllLabel:"Select all",enableSelectAll:!0},this.status=[{id:1,value:"Active"},{id:0,value:"Inactive"}],this.label="Create",this.imgeUrl=Me,this.showPassword=!1,this.photoBase64=null}ngOnInit(){this.initializeForm()}initializeForm(){this.userForm=this.fb.group({chiefEngineer:[null],zone:[null],supritendingEngineer:[null],circle:[null],executiveEngineer:[null],city:[null],assistantEngineer:[null],division:[null],name:[null,[g.required]],contactNo:[null],email:[null],address:[null],loginId:[null,g.required],loginPassword:[null,g.required],remarks:[null],status:[1,g.required],photo:[null]}),this.updateValidators(),this.editData?(this.getChiefBasedOnId(this.editData?.user_id),this.label="Update"):this.getChiefEngList()}updateValidators(){this.userForm.controls.chiefEngineer.clearValidators(),this.userForm.controls.supritendingEngineer.clearValidators(),this.userForm.controls.executiveEngineer.clearValidators(),this.userForm.controls.assistantEngineer.clearValidators(),this.userForm.controls.zone.clearValidators(),this.userForm.controls.circle.clearValidators(),this.userForm.controls.city.clearValidators(),this.userForm.controls.division.clearValidators(),this.userForm.get("contactNo")?.valueChanges.subscribe(t=>{this.userForm.controls.contactNo.setValidators([g.pattern(/^\d{10}$/)])}),this.userForm.get("email")?.valueChanges.subscribe(t=>{this.userForm.controls.email.setValidators([g.email])}),this.designation?.value==="2"?this.userForm.controls.zone.setValidators(g.required):["3","4","5","6"].includes(this.designation?.value)&&(this.userForm.controls.chiefEngineer.setValidators(g.required),this.userForm.controls.zone.setValidators(g.required),this.userForm.controls.circle.setValidators(g.required)),["4","5","6"].includes(this.designation?.value)&&(this.userForm.controls.supritendingEngineer.setValidators(g.required),this.userForm.controls.city.setValidators(g.required)),["5","6"].includes(this.designation?.value)&&(this.userForm.controls.executiveEngineer.setValidators(g.required),this.userForm.controls.division.setValidators(g.required)),this.designation?.value==="6"&&this.userForm.controls.assistantEngineer.setValidators(g.required),this.userForm.updateValueAndValidity()}getChiefBasedOnId(t){this.UserMasterService.userById(t).subscribe(n=>{this.userData=n?.body?.result,this.userForm&&(this.userForm.patchValue({name:this.userData?.full_name,contactNo:this.userData?.contact_no,email:this.userData?.email_id,address:this.userData?.cur_address,loginId:this.userData?.login_id,loginPassword:this.userData?.login_pass,remarks:this.userData?.remarks,status:this.userData?.is_active}),this.imagePath=this.userData?.img_path,this.getChiefEngList())})}getImageUrl(t){return t?`${this.imgeUrl}${t.replace(/\\/g,"/")}`:""}getChiefEngList(){this.commonService.chiefEngList().subscribe(t=>{if(this.chiefEngData=t?.body?.result||[],this.userData){let n=this.chiefEngData.find(e=>e?.value==this.userData?.chief_eng_id);this.userForm.controls.chiefEngineer.setValue(n),this.getZoneBasedOnCE(n?.value)}else if(this.chiefEngData.length>0&&this.chiefEngData.length===1){let n=this.chiefEngData[0].value;this.userForm.controls.chiefEngineer.setValue(this.chiefEngData[0]),this.getZoneBasedOnCE(n)}else this.zoneList=[],this.userForm.controls.zone.setValue(null),this.userForm.controls.chiefEngineer.setValue(null)})}onChiefEngineerChange(t){t?.value?.value?this.getZoneBasedOnCE(t.value.value):(this.zoneList=[],this.userForm.controls.zone.setValue(null),this.circleList=[],this.userForm.controls.circle.setValue(null))}onZoneChange(t){t?.value?.value?this.getCircleList(t.value.value):(this.circleList=[],this.userForm.controls.circle.setValue(null))}getCircleList(t){this.circleList=[],this.commonService.circleList(t).subscribe(n=>{if(this.circleList=n?.body?.result||[],this.userData){let e=this.userData?.circle;if(e){let i;if(e.includes(",")){let s=e.split(",").map(d=>d.trim());i=this.circleList.filter(d=>s.includes(d?.value.toString()))}else i=this.circleList.find(s=>s?.value.toString()===e.toString());this.userForm.controls.circle.setValue(i||null)}}else!this.userData&&this.circleList.length>0&&this.circleList.length===1?this.userForm.controls.circle.setValue(this.circleList[0]):this.userForm.controls.circle.setValue(null)})}getSelectedValues(t){return Array.isArray(t)?t?.map(n=>n.value).join(","):t?.value}close(){this.bsModelService.hide()}onFileChange(t){let n=t.target.files[0];if(n){let e=new FileReader;e.onload=()=>{let i=e.result;this.photoBase64=i.split(",")[1]},e.onerror=i=>{console.error("Error reading file:",i),this.notificationSerivce.errorAlert("Failed to read file. Please try again.")},e.readAsDataURL(n)}}submit(t){let n=this.commonService.getUserDetails(),e={user_id:0,department_id:this.department?Number(this.department?.value):null,emp_id:0,full_name:t?.name,contact_no:t?.contactNo,email_id:t?.email,cur_address:t?.address,login_id:t?.loginId,login_pass:t?.loginPassword,designation_id:this.designation?Number(this.designation?.value):null,level_id:this.designation?Number(this.designation?.value):null,chief_eng_id:t?.chiefEngineer?Number(t?.chiefEngineer?.value):null,zone:this.designation?.value==="2"?t?.zone?this.getSelectedValues(t.zone):null:t?.zone?t.zone.value:null,sup_eng_id:t?.supritendingEngineer?Number(t?.supritendingEngineer?.value):null,circle:this.designation?.value==="3"?t?.circle?this.getSelectedValues(t?.circle):null:t?.circle?t?.circle.value:null,exec_eng_id:t?.executiveEngineer?Number(t?.executiveEngineer?.value):null,district:this.designation?.value==="4"?t?.city?this.getSelectedValues(t?.city):null:t?.city?t?.city.value:null,ass_eng_id:t?.assistantEngineer?Number(t?.assistantEngineer?.value):null,division:this.designation?.value==="5"?t?.division?this.getSelectedValues(t?.division):null:t?.division?t?.division.value:null,remarks:t?.remarks,img_path:this.photoBase64,is_active:t?.status,created_by:n?.user_id},i=this.UserMasterService.createUser(e);this.userData&&(e.user_id=this.userData?.user_id,i=this.UserMasterService.updateUser(e,this.userData?.user_id)),i.subscribe(s=>{s?.status==200?(this.bsModelService.hide(),this.mapdata.emit(),this.notificationSerivce.successAlert(s?.body?.actionResponse)):this.notificationSerivce.errorAlert(s?.title)})}getZoneBasedOnCE(t){this.commonService.getZoneByChiefEng(t).subscribe(n=>{if(this.zoneList=n?.body?.result||[],this.userData){let e=this.zoneList.find(i=>i?.value==this.userData?.zone);this.userForm.controls.zone.setValue(e),this.getCircleList(e?.value)}else if(this.zoneList.length>0&&this.zoneList.length===1){let e=this.zoneList[0].value;this.userForm.controls.zone.setValue(this.zoneList[0]),this.getCircleList(e)}else this.circleList=[],this.userForm.controls.zone.setValue(null),this.userForm.controls.circle.setValue(null)})}static{this.\u0275fac=function(n){return new(n||o)(_(G),_(oe),_(k),_(Ie),_(V))}}static{this.\u0275cmp=D({type:o,selectors:[["app-crate-supritending-eng"]],outputs:{mapdata:"mapdata"},decls:86,vars:24,consts:[[1,"modal-header","text-center"],[1,"close-modal",3,"click"],[1,"fa","fa-close",2,"cursor","pointer"],[1,"modal-body"],[3,"formGroup"],[1,"row"],[1,"col-md-3","mb-2"],[1,"form-label"],[1,"text-danger"],["formControlName","chiefEngineer",3,"change","config","options"],[4,"ngIf"],["formControlName","zone",3,"change","config","multiple","options"],["formControlName","circle",3,"config","multiple","options"],[1,"input-group","mb-2"],["type","text","placeholder","Enter Name","formControlName","name",1,"form-control"],["type","text","placeholder","Enter Contact No.","formControlName","contactNo",1,"form-control"],["type","email","placeholder","Enter Email","formControlName","email",1,"form-control"],["type","text","placeholder","Enter Address","formControlName","address",1,"form-control"],["type","text","placeholder","Enter Login Id","formControlName","loginId",1,"form-control"],[1,"input-group","mb-2","password-container"],["placeholder","Enter Login Password","formControlName","loginPassword",1,"form-control","password",3,"type"],["id","visiblePassword",1,"fa",2,"cursor","pointer",3,"click","ngClass"],["type","text","placeholder","Enter Remarks","formControlName","remarks",1,"form-control"],["formControlName","status",1,"form-control"],[3,"ngValue",4,"ngFor","ngForOf"],["type","file","formControlName","photo",1,"form-control",3,"change"],[1,"col-md-3","mb-2","mt-4"],[1,"btn","btn-success",3,"click","disabled"],[3,"ngValue"],["alt","Profile Photo",1,"w-10","h-10","rounded-full","profile-image","mb-2",3,"src"]],template:function(n,e){if(n&1&&(a(0,"div",0)(1,"h5"),l(2),r(),a(3,"div",1),f("click",function(){return e.close()}),u(4,"i",2),r()(),a(5,"div",3)(6,"form",4)(7,"div",5)(8,"div",6)(9,"label",7),l(10,"Chief Engineer "),a(11,"span",8),l(12,"*"),r()(),a(13,"ngx-select-dropdown",9),f("change",function(s){return e.onChiefEngineerChange(s)}),r(),h(14,an,3,0,"div",10),r(),a(15,"div",6)(16,"label",7),l(17,"Zone "),a(18,"span",8),l(19,"*"),r()(),a(20,"ngx-select-dropdown",11),f("change",function(s){return e.onZoneChange(s)}),r(),h(21,sn,3,0,"div",10),r(),a(22,"div",6)(23,"label",7),l(24,"Circle "),a(25,"span",8),l(26,"*"),r()(),u(27,"ngx-select-dropdown",12),h(28,ln,3,0,"div",10),r(),a(29,"div",6)(30,"label",7),l(31,"Name "),a(32,"span",8),l(33,"*"),r()(),a(34,"div",13),u(35,"input",14),r()(),a(36,"div",6)(37,"label",7),l(38,"Contact No."),r(),a(39,"div",13),u(40,"input",15),r(),h(41,cn,3,0,"div",10),r(),a(42,"div",6)(43,"label",7),l(44,"Email"),r(),a(45,"div",13),u(46,"input",16),r(),h(47,dn,3,0,"div",10),r(),a(48,"div",6)(49,"label",7),l(50,"Address"),r(),u(51,"input",17),r(),a(52,"div",6)(53,"label",7),l(54,"Login Id "),a(55,"span",8),l(56,"*"),r()(),a(57,"div",13),u(58,"input",18),r()(),a(59,"div",6)(60,"label",7),l(61,"Login Password "),a(62,"span",8),l(63,"*"),r()(),a(64,"div",19),u(65,"input",20),a(66,"i",21),f("click",function(){return e.showPassword=!e.showPassword}),r()()(),a(67,"div",6)(68,"label",7),l(69,"Remarks"),r(),u(70,"input",22),r(),a(71,"div",6)(72,"label",7),l(73,"Status "),a(74,"span",8),l(75,"*"),r()(),a(76,"select",23),h(77,mn,2,2,"option",24),r()(),a(78,"div",6)(79,"label",7),l(80,"Photo"),r(),h(81,pn,2,1,"div",10),a(82,"input",25),f("change",function(s){return e.onFileChange(s)}),r()(),a(83,"div",26)(84,"button",27),f("click",function(){return e.submit(e.userForm.value)}),l(85,"Submit"),r()()()()()),n&2){let i,s,d,v,y;c(2),Pe("",e.label," ",e.designation==null?null:e.designation.text,""),c(4),m("formGroup",e.userForm),c(7),m("config",e.config)("options",e.chiefEngData),c(),m("ngIf",((i=e.userForm.get("chiefEngineer"))==null?null:i.invalid)&&((i=e.userForm.get("chiefEngineer"))==null?null:i.touched)),c(6),m("config",e.config)("multiple",(e.designation==null?null:e.designation.value)==="2")("options",e.zoneList),c(),m("ngIf",((s=e.userForm.get("zone"))==null?null:s.invalid)&&((s=e.userForm.get("zone"))==null?null:s.touched)),c(6),m("config",e.config)("multiple",(e.designation==null?null:e.designation.value)==="3")("options",e.circleList),c(),m("ngIf",((d=e.userForm.get("circle"))==null?null:d.invalid)&&((d=e.userForm.get("circle"))==null?null:d.touched)),c(13),m("ngIf",((v=e.userForm.get("contactNo"))==null?null:v.invalid)&&((v=e.userForm.get("contactNo"))==null?null:v.touched)),c(6),m("ngIf",((y=e.userForm.get("email"))==null?null:y.invalid)&&((y=e.userForm.get("email"))==null?null:y.touched)),c(18),ze("type",e.showPassword?"text":"password"),c(),m("ngClass",Ae(21,rn,!e.showPassword,e.showPassword)),c(11),m("ngForOf",e.status),c(4),m("ngIf",e.imagePath),c(3),m("disabled",e.userForm.invalid)}},dependencies:[Fe,I,z,se,te,A,O,T,P,N,ee,ie,ne],styles:[".profile-image[_ngcontent-%COMP%]{transition:transform .3s ease,box-shadow .3s ease}.profile-image[_ngcontent-%COMP%]:hover{-webkit-transform:scale(3.5);transform:scale(3.5)}.password-container[_ngcontent-%COMP%]{position:relative}.password-container[_ngcontent-%COMP%]   .password[_ngcontent-%COMP%]{width:100%}.password-container[_ngcontent-%COMP%]   .fa[_ngcontent-%COMP%]{position:absolute;top:50%;right:10px;transform:translateY(-50%);color:#666;font-size:16px;z-index:9}"]})}}return o})();var un=(o,p)=>({"fa-eye":o,"fa-eye-slash":p});function hn(o,p){o&1&&(a(0,"div")(1,"span",8),l(2,"Chief Engineer is required."),r()())}function gn(o,p){o&1&&(a(0,"div")(1,"span",8),l(2,"Zone is required."),r()())}function fn(o,p){o&1&&(a(0,"div")(1,"span",8),l(2,"Supritending Engineer is required."),r()())}function _n(o,p){o&1&&(a(0,"div")(1,"span",8),l(2,"Circle is required."),r()())}function vn(o,p){o&1&&(a(0,"div")(1,"span",8),l(2,"City is required."),r()())}function yn(o,p){o&1&&(a(0,"div")(1,"span",8),l(2,"Contact No. must be a 10-digit number."),r()())}function bn(o,p){o&1&&(a(0,"div")(1,"span",8),l(2,"Please enter a valid email address."),r()())}function Cn(o,p){if(o&1&&(a(0,"option",30),l(1),r()),o&2){let t=p.$implicit;m("ngValue",t.id),c(),b(t.value)}}function Ln(o,p){if(o&1&&(a(0,"div"),u(1,"img",31),r()),o&2){let t=C();c(),m("src",t.getImageUrl(t.imagePath),ke)}}var Ct=(()=>{class o{constructor(t,n,e,i,s){this.commonService=t,this.fb=n,this.bsModelService=e,this.UserMasterService=i,this.notificationSerivce=s,this.mapdata=new W,this.config={displayKey:"text",search:!0,height:"300px",placeholder:"Select",noResultsFound:"",selectAllLabel:"Select all",enableSelectAll:!0},this.status=[{id:1,value:"Active"},{id:0,value:"Inactive"}],this.label="Create",this.imgeUrl=Me,this.showPassword=!1,this.photoBase64=null}ngOnInit(){console.log(this.department,this.designation),this.initializeForm()}initializeForm(){this.userForm=this.fb.group({chiefEngineer:[null],zone:[null],supritendingEngineer:[null],circle:[null],executiveEngineer:[null],city:[null],assistantEngineer:[null],division:[null],name:[null,[g.required]],contactNo:[null],email:[null],address:[null],loginId:[null,g.required],loginPassword:[null,g.required],remarks:[null],status:[1,g.required],photo:[null]}),this.updateValidators(),this.editData?(this.getChiefBasedOnId(this.editData?.user_id),this.label="Update"):this.getChiefEngList()}updateValidators(){this.userForm.controls.chiefEngineer.clearValidators(),this.userForm.controls.supritendingEngineer.clearValidators(),this.userForm.controls.executiveEngineer.clearValidators(),this.userForm.controls.assistantEngineer.clearValidators(),this.userForm.controls.zone.clearValidators(),this.userForm.controls.circle.clearValidators(),this.userForm.controls.city.clearValidators(),this.userForm.controls.division.clearValidators(),this.userForm.get("contactNo")?.valueChanges.subscribe(t=>{this.userForm.controls.contactNo.setValidators([g.pattern(/^\d{10}$/)])}),this.userForm.get("email")?.valueChanges.subscribe(t=>{this.userForm.controls.email.setValidators([g.email])}),this.designation?.value==="2"?this.userForm.controls.zone.setValidators(g.required):["3","4","5","6"].includes(this.designation?.value)&&(this.userForm.controls.chiefEngineer.setValidators(g.required),this.userForm.controls.zone.setValidators(g.required),this.userForm.controls.circle.setValidators(g.required)),["4","5","6"].includes(this.designation?.value)&&(this.userForm.controls.supritendingEngineer.setValidators(g.required),this.userForm.controls.city.setValidators(g.required)),["5","6"].includes(this.designation?.value)&&(this.userForm.controls.executiveEngineer.setValidators(g.required),this.userForm.controls.division.setValidators(g.required)),this.designation?.value==="6"&&this.userForm.controls.assistantEngineer.setValidators(g.required),this.userForm.updateValueAndValidity()}getChiefBasedOnId(t){this.UserMasterService.userById(t).subscribe(n=>{this.userData=n?.body?.result,this.userForm&&(this.userForm.patchValue({name:this.userData?.full_name,contactNo:this.userData?.contact_no,email:this.userData?.email_id,address:this.userData?.cur_address,loginId:this.userData?.login_id,loginPassword:this.userData?.login_pass,remarks:this.userData?.remarks,status:this.userData?.is_active}),this.imagePath=this.userData?.img_path,this.getChiefEngList())})}getImageUrl(t){return t?`${this.imgeUrl}${t.replace(/\\/g,"/")}`:""}getChiefEngList(){this.commonService.chiefEngList().subscribe(t=>{if(this.chiefEngData=t?.body?.result||[],this.userData){let n=this.chiefEngData?.find(e=>e?.value==this.userData?.chief_eng_id);this.userForm.controls.chiefEngineer.setValue(n),this.getZoneBasedOnCE(n?.value),this.getSupritendingEngList(n?.value)}else if(this.chiefEngData.length>0&&this.chiefEngData.length===1){let n=this.chiefEngData[0].value;this.userForm.controls.chiefEngineer.setValue(this.chiefEngData[0]),this.getZoneBasedOnCE(n),this.getSupritendingEngList(n)}else this.supritendingEngList=[],this.zoneList=[],this.circleList=[],this.cityList=[],this.userForm.controls.zone.setValue(null),this.userForm.controls.chiefEngineer.setValue(null),this.userForm.controls.supritendingEngineer.setValue(null),this.userForm.controls.circle.setValue(null),this.userForm.controls.city.setValue(null)})}onChiefEngineerChange(t){t?.value?.value?(this.getZoneBasedOnCE(t.value.value),this.getSupritendingEngList(t.value.value)):(this.supritendingEngList=[],this.zoneList=[],this.userForm.controls.zone.setValue(null),this.userForm.controls.supritendingEngineer.setValue(null),this.circleList=[],this.cityList=[],this.userForm.controls.zone.setValue(null),this.userForm.controls.chiefEngineer.setValue(null),this.userForm.controls.circle.setValue(null),this.userForm.controls.city.setValue(null))}getSupritendingEngList(t){this.commonService.supritendingEngList(t).subscribe(n=>{if(this.supritendingEngList=n?.body?.result||[],this.userData){let e=this.supritendingEngList?.find(i=>i.value==this.userData?.sup_eng_id);this.userForm.controls.supritendingEngineer.setValue(e),this.getCircleBasedOnSE(e.value)}else if(this.supritendingEngList.length>0&&this.supritendingEngList.length===1){let e=this.supritendingEngList[0].value;this.userForm.controls.supritendingEngineer.setValue(this.supritendingEngList[0]),this.getCircleBasedOnSE(e)}else this.circleList=[],this.cityList=[],this.userForm.controls.circle.setValue(null),this.userForm.controls.city.setValue(null),this.userForm.controls.supritendingEngineer.setValue(null)})}onSupritendingEngineerChange(t){t?.value?.value?this.getCircleBasedOnSE(t.value.value):(this.circleList=[],this.cityList=[],this.userForm.controls.circle.setValue(null),this.userForm.controls.city.setValue(null))}onCircleChange(t){this.designation?.value!=="3"&&(t?.value?.value?this.getCityList(t.value.value):(this.cityList=[],this.divisionData=[],this.userForm.controls.city.setValue(null),this.userForm.controls.division.setValue(null)))}getCityList(t){this.commonService.cityList(t).subscribe(n=>{if(this.cityList=n?.body?.result||[],this.userData){let e=this.userData?.district;if(e){let i;if(e.includes(",")){let s=e.split(",").map(d=>d.trim());i=this.cityList.filter(d=>s.includes(d?.value.toString()))}else i=this.cityList?.find(s=>s?.value.toString()===e.toString());this.userForm.controls.city.setValue(i||null)}}else this.cityList.length>0&&this.cityList.length===1?this.userForm.controls.city.setValue(this.cityList[0]):this.userForm.controls.city.setValue(null)})}getSelectedValues(t){return Array.isArray(t)?t.map(n=>n.value).join(","):t?.value}close(){this.bsModelService.hide()}onFileChange(t){let n=t.target.files[0];if(n){let e=new FileReader;e.onload=()=>{let i=e.result;this.photoBase64=i.split(",")[1]},e.onerror=i=>{console.error("Error reading file:",i),this.notificationSerivce.errorAlert("Failed to read file. Please try again.")},e.readAsDataURL(n)}}submit(t){let n=this.commonService.getUserDetails(),e={user_id:0,department_id:this.department?Number(this.department?.value):null,emp_id:0,full_name:t?.name,contact_no:t?.contactNo,email_id:t?.email,cur_address:t?.address,login_id:t?.loginId,login_pass:t?.loginPassword,designation_id:this.designation?Number(this.designation?.value):null,level_id:this.designation?Number(this.designation?.value):null,chief_eng_id:t?.chiefEngineer?Number(t?.chiefEngineer?.value):null,zone:this.designation?.value=="2"?t?.zone?this.getSelectedValues(t.zone):null:t?.zone?t.zone.value:null,sup_eng_id:t?.supritendingEngineer?Number(t?.supritendingEngineer?.value):null,circle:this.designation?.value=="3"?t?.circle?this.getSelectedValues(t?.circle):null:t?.circle?t?.circle.value:null,exec_eng_id:t?.executiveEngineer?Number(t?.executiveEngineer?.value):null,district:this.designation?.value=="4"?t?.city?this.getSelectedValues(t?.city):null:t?.city?t?.city.value:null,ass_eng_id:t?.assistantEngineer?Number(t?.assistantEngineer?.value):null,division:this.designation?.value=="5"?t?.division?this.getSelectedValues(t?.division):null:t?.division?t?.division.value:null,remarks:t?.remarks,img_path:this.photoBase64,is_active:t?.status,created_by:n?.user_id},i=this.UserMasterService.createUser(e);this.userData&&(e.user_id=this.userData?.user_id,i=this.UserMasterService.updateUser(e,this.userData?.user_id)),i.subscribe(s=>{s?.status==200?(this.bsModelService.hide(),this.mapdata.emit(),this.notificationSerivce.successAlert(s?.body?.actionResponse)):this.notificationSerivce.errorAlert(s?.title)})}getZoneBasedOnCE(t){this.commonService.getZoneByChiefEng(t).subscribe(n=>{if(this.zoneList=n?.body?.result||[],this.userData){let e=this.zoneList?.find(i=>i.value==this.userData?.zone);this.userForm.controls.zone.setValue(e)}else this.zoneList.length>0&&this.zoneList.length===1?this.userForm.controls.zone.setValue(this.zoneList[0]):this.userForm.controls.zone.setValue(null)})}getCircleBasedOnSE(t){this.commonService.getCircleBySupEng(t).subscribe(n=>{if(this.circleList=n?.body?.result||[],this.userData){let e=this.circleList?.find(i=>i.value==this.userData?.circle);this.userForm.controls.circle.setValue(e),this.getCityList(e.value)}else if(this.circleList.length>0&&this.circleList.length===1){let e=this.circleList[0].value;this.userForm.controls.circle.setValue(this.circleList[0]),this.getCityList(e)}else this.cityList=[],this.userForm.controls.circle.setValue(null),this.userForm.controls.city.setValue(null)})}static{this.\u0275fac=function(n){return new(n||o)(_(G),_(oe),_(k),_(Ie),_(V))}}static{this.\u0275cmp=D({type:o,selectors:[["app-crate-executive-eng"]],outputs:{mapdata:"mapdata"},decls:100,vars:31,consts:[[1,"modal-header","text-center"],[1,"close-modal",3,"click"],[1,"fa","fa-close",2,"cursor","pointer"],[1,"modal-body"],[3,"formGroup"],[1,"row"],[1,"col-md-3","mb-2"],[1,"form-label"],[1,"text-danger"],["formControlName","chiefEngineer",3,"change","config","options"],[4,"ngIf"],["formControlName","zone",3,"config","multiple","options"],["formControlName","supritendingEngineer",3,"change","config","options"],["formControlName","circle",3,"change","config","multiple","options"],["formControlName","city",3,"config","options","multiple"],[1,"input-group","mb-2"],["type","text","placeholder","Enter Name","formControlName","name",1,"form-control"],["type","text","placeholder","Enter Contact No.","formControlName","contactNo",1,"form-control"],["type","email","placeholder","Enter Email","formControlName","email",1,"form-control"],["type","text","placeholder","Enter Address","formControlName","address",1,"form-control"],["type","text","placeholder","Enter Login Id","formControlName","loginId",1,"form-control"],[1,"input-group","mb-2","password-container"],["placeholder","Enter Login Password","formControlName","loginPassword",1,"form-control","password",3,"type"],["id","visiblePassword",1,"fa",2,"cursor","pointer",3,"click","ngClass"],["type","text","placeholder","Enter Remarks","formControlName","remarks",1,"form-control"],["formControlName","status",1,"form-control"],[3,"ngValue",4,"ngFor","ngForOf"],["type","file","formControlName","photo",1,"form-control",3,"change"],[1,"col-md-3","mb-2","mt-4"],[1,"btn","btn-success",3,"click","disabled"],[3,"ngValue"],["alt","Profile Photo",1,"w-10","h-10","rounded-full","profile-image","mb-2",3,"src"]],template:function(n,e){if(n&1&&(a(0,"div",0)(1,"h5"),l(2),r(),a(3,"div",1),f("click",function(){return e.close()}),u(4,"i",2),r()(),a(5,"div",3)(6,"form",4)(7,"div",5)(8,"div",6)(9,"label",7),l(10,"Chief Engineer "),a(11,"span",8),l(12,"*"),r()(),a(13,"ngx-select-dropdown",9),f("change",function(s){return e.onChiefEngineerChange(s)}),r(),h(14,hn,3,0,"div",10),r(),a(15,"div",6)(16,"label",7),l(17,"Zone "),a(18,"span",8),l(19,"*"),r()(),u(20,"ngx-select-dropdown",11),h(21,gn,3,0,"div",10),r(),a(22,"div",6)(23,"label",7),l(24,"Supritending Engineer "),a(25,"span",8),l(26,"*"),r()(),a(27,"ngx-select-dropdown",12),f("change",function(s){return e.onSupritendingEngineerChange(s)}),r(),h(28,fn,3,0,"div",10),r(),a(29,"div",6)(30,"label",7),l(31,"Circle "),a(32,"span",8),l(33,"*"),r()(),a(34,"ngx-select-dropdown",13),f("change",function(s){return e.onCircleChange(s)}),r(),h(35,_n,3,0,"div",10),r(),a(36,"div",6)(37,"label",7),l(38,"City "),a(39,"span",8),l(40,"*"),r()(),u(41,"ngx-select-dropdown",14),h(42,vn,3,0,"div",10),r(),a(43,"div",6)(44,"label",7),l(45,"Name "),a(46,"span",8),l(47,"*"),r()(),a(48,"div",15),u(49,"input",16),r()(),a(50,"div",6)(51,"label",7),l(52,"Contact No."),r(),a(53,"div",15),u(54,"input",17),r(),h(55,yn,3,0,"div",10),r(),a(56,"div",6)(57,"label",7),l(58,"Email"),r(),a(59,"div",15),u(60,"input",18),r(),h(61,bn,3,0,"div",10),r(),a(62,"div",6)(63,"label",7),l(64,"Address"),r(),u(65,"input",19),r(),a(66,"div",6)(67,"label",7),l(68,"Login Id "),a(69,"span",8),l(70,"*"),r()(),a(71,"div",15),u(72,"input",20),r()(),a(73,"div",6)(74,"label",7),l(75,"Login Password "),a(76,"span",8),l(77,"*"),r()(),a(78,"div",21),u(79,"input",22),a(80,"i",23),f("click",function(){return e.showPassword=!e.showPassword}),r()()(),a(81,"div",6)(82,"label",7),l(83,"Remarks"),r(),u(84,"input",24),r(),a(85,"div",6)(86,"label",7),l(87,"Status "),a(88,"span",8),l(89,"*"),r()(),a(90,"select",25),h(91,Cn,2,2,"option",26),r()(),a(92,"div",6)(93,"label",7),l(94,"Photo"),r(),h(95,Ln,2,1,"div",10),a(96,"input",27),f("change",function(s){return e.onFileChange(s)}),r()(),a(97,"div",28)(98,"button",29),f("click",function(){return e.submit(e.userForm.value)}),l(99,"Submit"),r()()()()()),n&2){let i,s,d,v,y,w,x;c(2),Pe("",e.label," ",e.designation==null?null:e.designation.text,""),c(4),m("formGroup",e.userForm),c(7),m("config",e.config)("options",e.chiefEngData),c(),m("ngIf",((i=e.userForm.get("chiefEngineer"))==null?null:i.invalid)&&((i=e.userForm.get("chiefEngineer"))==null?null:i.touched)),c(6),m("config",e.config)("multiple",(e.designation==null?null:e.designation.value)==="2")("options",e.zoneList),c(),m("ngIf",((s=e.userForm.get("zone"))==null?null:s.invalid)&&((s=e.userForm.get("zone"))==null?null:s.touched)),c(6),m("config",e.config)("options",e.supritendingEngList),c(),m("ngIf",((d=e.userForm.get("supritendingEngineer"))==null?null:d.invalid)&&((d=e.userForm.get("supritendingEngineer"))==null?null:d.touched)),c(6),m("config",e.config)("multiple",(e.designation==null?null:e.designation.value)==="3")("options",e.circleList),c(),m("ngIf",((v=e.userForm.get("circle"))==null?null:v.invalid)&&((v=e.userForm.get("circle"))==null?null:v.touched)),c(6),m("config",e.config)("options",e.cityList)("multiple",(e.designation==null?null:e.designation.value)==="4"),c(),m("ngIf",((y=e.userForm.get("city"))==null?null:y.invalid)&&((y=e.userForm.get("city"))==null?null:y.touched)),c(13),m("ngIf",((w=e.userForm.get("contactNo"))==null?null:w.invalid)&&((w=e.userForm.get("contactNo"))==null?null:w.touched)),c(6),m("ngIf",((x=e.userForm.get("email"))==null?null:x.invalid)&&((x=e.userForm.get("email"))==null?null:x.touched)),c(18),ze("type",e.showPassword?"text":"password"),c(),m("ngClass",Ae(28,un,!e.showPassword,e.showPassword)),c(11),m("ngForOf",e.status),c(4),m("ngIf",e.imagePath),c(3),m("disabled",e.userForm.invalid)}},dependencies:[Fe,I,z,se,te,A,O,T,P,N,ee,ie,ne],styles:[".profile-image[_ngcontent-%COMP%]{transition:transform .3s ease,box-shadow .3s ease}.profile-image[_ngcontent-%COMP%]:hover{-webkit-transform:scale(3.5);transform:scale(3.5)}.password-container[_ngcontent-%COMP%]{position:relative}.password-container[_ngcontent-%COMP%]   .password[_ngcontent-%COMP%]{width:100%}.password-container[_ngcontent-%COMP%]   .fa[_ngcontent-%COMP%]{position:absolute;top:50%;right:10px;transform:translateY(-50%);color:#666;font-size:16px;z-index:9}"]})}}return o})();var Sn=(o,p)=>({"fa-eye":o,"fa-eye-slash":p});function En(o,p){o&1&&(a(0,"div")(1,"span",8),l(2,"Chief Engineer is required."),r()())}function wn(o,p){o&1&&(a(0,"div")(1,"span",8),l(2,"Zone is required."),r()())}function Dn(o,p){o&1&&(a(0,"div")(1,"span",8),l(2,"Supritending Engineer is required."),r()())}function xn(o,p){o&1&&(a(0,"div")(1,"span",8),l(2,"Circle is required."),r()())}function kn(o,p){o&1&&(a(0,"div")(1,"span",8),l(2,"Executive Engineer is required."),r()())}function Fn(o,p){o&1&&(a(0,"div")(1,"span",8),l(2,"City is required."),r()())}function Mn(o,p){o&1&&(a(0,"div")(1,"span",8),l(2,"Division is required."),r()())}function In(o,p){o&1&&(a(0,"div")(1,"span",8),l(2,"Contact No. must be a 10-digit number."),r()())}function zn(o,p){o&1&&(a(0,"div")(1,"span",8),l(2,"Please enter a valid email address."),r()())}function Vn(o,p){if(o&1&&(a(0,"option",32),l(1),r()),o&2){let t=p.$implicit;m("ngValue",t.id),c(),b(t.value)}}function Tn(o,p){if(o&1&&(a(0,"div"),u(1,"img",33),r()),o&2){let t=C();c(),m("src",t.getImageUrl(t.imagePath),ke)}}var Lt=(()=>{class o{constructor(t,n,e,i,s){this.commonService=t,this.fb=n,this.bsModelService=e,this.UserMasterService=i,this.notificationSerivce=s,this.mapdata=new W,this.config={displayKey:"text",search:!0,height:"300px",placeholder:"Select",noResultsFound:"",selectAllLabel:"Select all",enableSelectAll:!0},this.status=[{id:1,value:"Active"},{id:0,value:"Inactive"}],this.label="Create",this.imgeUrl=Me,this.showPassword=!1,this.photoBase64=null}ngOnInit(){this.initializeForm()}initializeForm(){this.userForm=this.fb.group({chiefEngineer:[null],zone:[null],supritendingEngineer:[null],circle:[null],executiveEngineer:[null],city:[null],assistantEngineer:[null],division:[null],name:[null,[g.required]],contactNo:[null],email:[null],address:[null],loginId:[null,g.required],loginPassword:[null,g.required],remarks:[null],status:[1,g.required],photo:[null]}),this.updateValidators(),this.editData?(this.getChiefBasedOnId(this.editData?.user_id),this.label="Update"):this.getChiefEngList()}updateValidators(){this.userForm.controls.chiefEngineer.clearValidators(),this.userForm.controls.supritendingEngineer.clearValidators(),this.userForm.controls.executiveEngineer.clearValidators(),this.userForm.controls.assistantEngineer.clearValidators(),this.userForm.controls.zone.clearValidators(),this.userForm.controls.circle.clearValidators(),this.userForm.controls.city.clearValidators(),this.userForm.controls.division.clearValidators(),this.userForm.get("contactNo")?.valueChanges.subscribe(t=>{this.userForm.controls.contactNo.setValidators([g.pattern(/^\d{10}$/)])}),this.userForm.get("email")?.valueChanges.subscribe(t=>{this.userForm.controls.email.setValidators([g.email])}),this.designation?.value==="2"?this.userForm.controls.zone.setValidators(g.required):["3","4","5","6"].includes(this.designation?.value)&&(this.userForm.controls.chiefEngineer.setValidators(g.required),this.userForm.controls.zone.setValidators(g.required),this.userForm.controls.circle.setValidators(g.required)),["4","5","6"].includes(this.designation?.value)&&(this.userForm.controls.supritendingEngineer.setValidators(g.required),this.userForm.controls.city.setValidators(g.required)),["5","6"].includes(this.designation?.value)&&(this.userForm.controls.executiveEngineer.setValidators(g.required),this.userForm.controls.division.setValidators(g.required)),this.designation?.value==="6"&&this.userForm.controls.assistantEngineer.setValidators(g.required),this.userForm.updateValueAndValidity()}getChiefBasedOnId(t){this.UserMasterService.userById(t).subscribe(n=>{this.userData=n?.body?.result,this.userForm&&(this.userForm.patchValue({name:this.userData?.full_name,contactNo:this.userData?.contact_no,email:this.userData?.email_id,address:this.userData?.cur_address,loginId:this.userData?.login_id,loginPassword:this.userData?.login_pass,remarks:this.userData?.remarks,status:this.userData?.is_active}),this.imagePath=this.userData?.img_path,this.getChiefEngList())})}getImageUrl(t){return t?`${this.imgeUrl}${t.replace(/\\/g,"/")}`:""}getChiefEngList(){this.commonService.chiefEngList().subscribe(t=>{if(this.chiefEngData=t?.body?.result||[],this.userData){let n=this.chiefEngData?.find(e=>e?.value==this.userData?.chief_eng_id);this.userForm.controls.chiefEngineer.setValue(n),this.getZoneBasedOnCE(n?.value),this.getSupritendingEngList(n?.value)}else if(this.chiefEngData.length>0&&this.chiefEngData.length===1){let n=this.chiefEngData[0].value;this.userForm.controls.chiefEngineer.setValue(this.chiefEngData[0]),this.getSupritendingEngList(n),this.getZoneBasedOnCE(n)}else this.supritendingEngList=[],this.zoneList=[],this.executiveEngList=[],this.circleList=[],this.cityList=[],this.divisionData=[],this.userForm.controls.zone.setValue(null),this.userForm.controls.chiefEngineer.setValue(null),this.userForm.controls.supritendingEngineer.setValue(null),this.userForm.controls.executiveEngineer.setValue(null),this.userForm.controls.circle.setValue(null),this.userForm.controls.city.setValue(null),this.userForm.controls.division.setValue(null)})}onChiefEngineerChange(t){t?.value?.value?(this.getZoneBasedOnCE(t.value.value),this.getSupritendingEngList(t.value.value)):(this.supritendingEngList=[],this.zoneList=[],this.executiveEngList=[],this.circleList=[],this.cityList=[],this.divisionData=[],this.userForm.controls.zone.setValue(null),this.userForm.controls.supritendingEngineer.setValue(null),this.userForm.controls.executiveEngineer.setValue(null),this.userForm.controls.circle.setValue(null),this.userForm.controls.city.setValue(null),this.userForm.controls.division.setValue(null))}getSupritendingEngList(t){this.commonService.supritendingEngList(t).subscribe(n=>{if(this.supritendingEngList=n?.body?.result||[],this.userData){let e=this.supritendingEngList?.find(i=>i.value==this.userData?.sup_eng_id);this.userForm.controls.supritendingEngineer.setValue(e),this.getCircleBasedOnSE(e.value),this.getExecutiveEngList(e.value)}else if(this.supritendingEngList.length>0&&this.supritendingEngList.length===1){let e=this.supritendingEngList[0].value;this.userForm.controls.supritendingEngineer.setValue(this.supritendingEngList[0]),this.getExecutiveEngList(e),this.getCircleBasedOnSE(e)}else this.executiveEngList=[],this.circleList=[],this.cityList=[],this.divisionData=[],this.userForm.controls.supritendingEngineer.setValue(null),this.userForm.controls.executiveEngineer.setValue(null),this.userForm.controls.circle.setValue(null),this.userForm.controls.city.setValue(null),this.userForm.controls.division.setValue(null)})}onSupritendingEngineerChange(t){t?.value?.value?(this.getExecutiveEngList(t.value.value),this.getCircleBasedOnSE(t.value.value)):(this.executiveEngList=[],this.circleList=[],this.cityList=[],this.divisionData=[],this.userForm.controls.executiveEngineer.setValue(null),this.userForm.controls.circle.setValue(null),this.userForm.controls.city.setValue(null),this.userForm.controls.division.setValue(null))}getExecutiveEngList(t){this.commonService.executiveEngList(t).subscribe(n=>{if(this.executiveEngList=n?.body?.result||[],this.userData){let e=this.executiveEngList?.find(i=>i.value==this.userData?.exec_eng_id);this.userForm.controls.executiveEngineer.setValue(e),this.getDistrictByExecEng(e.value)}else if(!this.userData&&this.executiveEngList.length>0&&this.executiveEngList.length===1){let e=this.executiveEngList[0].value;this.userForm.controls.executiveEngineer.setValue(this.executiveEngList[0]),this.getDistrictByExecEng(e)}else this.cityList=[],this.divisionList=[],this.userForm.controls.city.setValue(null),this.userForm.controls.division.setValue(null),this.userForm.controls.executiveEngineer.setValue(null)})}onExecutiveEngineerChange(t){t?.value?.value?this.getDistrictByExecEng(t.value.value):(this.cityList=[],this.divisionList=[],this.userForm.controls.city.setValue(null),this.userForm.controls.division.setValue(null))}onCityChange(t){t?.value?.value?this.getDivisionList(t.value.value):(this.divisionData=[],this.userForm.controls.division.setValue(null))}getDivisionList(t){this.commonService.divisionList(t).subscribe(n=>{if(this.divisionData=n?.body?.result||[],this.userData){let e=this.userData?.division;if(e){let i;if(e.includes(",")){let s=e.split(",").map(d=>d.trim());i=this.divisionData.filter(d=>s.includes(d?.value.toString()))}else i=this.divisionData?.find(s=>s?.value.toString()===e.toString());this.userForm.controls.division.setValue(i||null)}}else!this.userData&&this.divisionData.length>0&&this.divisionData.length===1?this.userForm.controls.division.setValue(this.divisionData[0]):this.userForm.controls.division.setValue(null)})}getSelectedValues(t){return Array.isArray(t)?t?.map(n=>n.value).join(","):t?.value}close(){this.bsModelService.hide()}onFileChange(t){let n=t.target.files[0];if(n){let e=new FileReader;e.onload=()=>{let i=e.result;this.photoBase64=i.split(",")[1]},e.onerror=i=>{console.error("Error reading file:",i),this.notificationSerivce.errorAlert("Failed to read file. Please try again.")},e.readAsDataURL(n)}}submit(t){let n=this.commonService.getUserDetails(),e={user_id:0,department_id:this.department?Number(this.department?.value):null,emp_id:0,full_name:t?.name,contact_no:t?.contactNo,email_id:t?.email,cur_address:t?.address,login_id:t?.loginId,login_pass:t?.loginPassword,designation_id:this.designation?Number(this.designation?.value):null,level_id:this.designation?Number(this.designation?.value):null,chief_eng_id:t?.chiefEngineer?Number(t?.chiefEngineer?.value):null,zone:this.designation?.value==="2"?t?.zone?this.getSelectedValues(t.zone):null:t?.zone?t.zone.value:null,sup_eng_id:t?.supritendingEngineer?Number(t?.supritendingEngineer?.value):null,circle:this.designation?.value==="3"?t?.circle?this.getSelectedValues(t?.circle):null:t?.circle?t?.circle.value:null,exec_eng_id:t?.executiveEngineer?Number(t?.executiveEngineer?.value):null,district:this.designation?.value==="4"?t?.city?this.getSelectedValues(t?.city):null:t?.city?t?.city.value:null,ass_eng_id:t?.assistantEngineer?Number(t?.assistantEngineer?.value):null,division:this.designation?.value==="5"?t?.division?this.getSelectedValues(t?.division):null:t?.division?t?.division.value:null,remarks:t?.remarks,img_path:this.photoBase64,is_active:t?.status,created_by:n?.user_id},i=this.UserMasterService.createUser(e);this.userData&&(e.user_id=this.userData?.user_id,i=this.UserMasterService.updateUser(e,this.userData?.user_id)),i.subscribe(s=>{s?.status==200?(this.bsModelService.hide(),this.mapdata.emit(),this.notificationSerivce.successAlert(s?.body?.actionResponse)):this.notificationSerivce.errorAlert(s?.title)})}getZoneBasedOnCE(t){this.commonService.getZoneByChiefEng(t).subscribe(n=>{if(this.zoneList=n?.body?.result||[],this.userData){let e=this.zoneList?.find(i=>i.value==this.userData?.zone);this.userForm.controls.zone.setValue(e)}else this.zoneList.length>0&&this.zoneList.length===1?this.userForm.controls.zone.setValue(this.zoneList[0]):(this.circleList=[],this.userForm.controls.zone.setValue(null),this.userForm.controls.circle.setValue(null))})}getCircleBasedOnSE(t){this.commonService.getCircleBySupEng(t).subscribe(n=>{if(this.circleList=n?.body?.result||[],this.userData){let e=this.circleList?.find(i=>i.value==this.userData?.circle);this.userForm.controls.circle.setValue(e)}else this.circleList.length>0&&this.circleList.length===1&&this.userForm.controls.circle.setValue(this.circleList[0])})}getDistrictByExecEng(t){this.commonService.getDistrictByExecEng(t).subscribe(n=>{if(this.cityList=n?.body?.result||[],this.userData){let e=this.cityList?.find(i=>i.value==this.userData?.district);this.userForm.controls.city.setValue(e),this.getDivisionList(e.value)}else if(this.cityList.length>0&&this.cityList.length===1){let e=this.cityList[0].value;this.userForm.controls.city.setValue(this.cityList[0]),this.getDivisionList(e)}else this.divisionData=[],this.userForm.controls.city.setValue(null),this.userForm.controls.division.setValue(null)})}static{this.\u0275fac=function(n){return new(n||o)(_(G),_(oe),_(k),_(Ie),_(V))}}static{this.\u0275cmp=D({type:o,selectors:[["app-crate-assitant-eng"]],outputs:{mapdata:"mapdata"},decls:114,vars:35,consts:[[1,"modal-header","text-center"],[1,"close-modal",3,"click"],[1,"fa","fa-close",2,"cursor","pointer"],[1,"modal-body"],[3,"formGroup"],[1,"row"],[1,"col-md-3","mb-2"],[1,"form-label"],[1,"text-danger"],["formControlName","chiefEngineer",3,"change","config","options"],[4,"ngIf"],["formControlName","zone",3,"config","options"],["formControlName","supritendingEngineer",3,"change","config","options"],["formControlName","circle",3,"config","options"],["formControlName","executiveEngineer",3,"change","config","options"],["formControlName","city",3,"change","config","options"],["formControlName","division",3,"config","options","multiple"],[1,"input-group","mb-2"],["type","text","placeholder","Enter Name","formControlName","name",1,"form-control"],["type","text","placeholder","Enter Contact No.","formControlName","contactNo",1,"form-control"],["type","email","placeholder","Enter Email","formControlName","email",1,"form-control"],["type","text","placeholder","Enter Address","formControlName","address",1,"form-control"],["type","text","placeholder","Enter Login Id","formControlName","loginId",1,"form-control"],[1,"input-group","mb-2","password-container"],["placeholder","Enter Login Password","formControlName","loginPassword",1,"form-control","password",3,"type"],["id","visiblePassword",1,"fa",2,"cursor","pointer",3,"click","ngClass"],["type","text","placeholder","Enter Remarks","formControlName","remarks",1,"form-control"],["formControlName","status",1,"form-control"],[3,"ngValue",4,"ngFor","ngForOf"],["type","file","formControlName","photo",1,"form-control",3,"change"],[1,"col-md-3","mb-2","mt-4"],[1,"btn","btn-success",3,"click","disabled"],[3,"ngValue"],["alt","Profile Photo",1,"w-10","h-10","rounded-full","profile-image","mb-2",3,"src"]],template:function(n,e){if(n&1&&(a(0,"div",0)(1,"h5"),l(2),r(),a(3,"div",1),f("click",function(){return e.close()}),u(4,"i",2),r()(),a(5,"div",3)(6,"form",4)(7,"div",5)(8,"div",6)(9,"label",7),l(10,"Chief Engineer "),a(11,"span",8),l(12,"*"),r()(),a(13,"ngx-select-dropdown",9),f("change",function(s){return e.onChiefEngineerChange(s)}),r(),h(14,En,3,0,"div",10),r(),a(15,"div",6)(16,"label",7),l(17,"Zone "),a(18,"span",8),l(19,"*"),r()(),u(20,"ngx-select-dropdown",11),h(21,wn,3,0,"div",10),r(),a(22,"div",6)(23,"label",7),l(24,"Supritending Engineer "),a(25,"span",8),l(26,"*"),r()(),a(27,"ngx-select-dropdown",12),f("change",function(s){return e.onSupritendingEngineerChange(s)}),r(),h(28,Dn,3,0,"div",10),r(),a(29,"div",6)(30,"label",7),l(31,"Circle "),a(32,"span",8),l(33,"*"),r()(),u(34,"ngx-select-dropdown",13),h(35,xn,3,0,"div",10),r(),a(36,"div",6)(37,"label",7),l(38,"Executive Engineer "),a(39,"span",8),l(40,"*"),r()(),a(41,"ngx-select-dropdown",14),f("change",function(s){return e.onExecutiveEngineerChange(s)}),r(),h(42,kn,3,0,"div",10),r(),a(43,"div",6)(44,"label",7),l(45,"City "),a(46,"span",8),l(47,"*"),r()(),a(48,"ngx-select-dropdown",15),f("change",function(s){return e.onCityChange(s)}),r(),h(49,Fn,3,0,"div",10),r(),a(50,"div",6)(51,"label",7),l(52,"Division "),a(53,"span",8),l(54,"*"),r()(),u(55,"ngx-select-dropdown",16),h(56,Mn,3,0,"div",10),r(),a(57,"div",6)(58,"label",7),l(59,"Name "),a(60,"span",8),l(61,"*"),r()(),a(62,"div",17),u(63,"input",18),r()(),a(64,"div",6)(65,"label",7),l(66,"Contact No."),r(),a(67,"div",17),u(68,"input",19),r(),h(69,In,3,0,"div",10),r(),a(70,"div",6)(71,"label",7),l(72,"Email"),r(),a(73,"div",17),u(74,"input",20),r(),h(75,zn,3,0,"div",10),r(),a(76,"div",6)(77,"label",7),l(78,"Address"),r(),u(79,"input",21),r(),a(80,"div",6)(81,"label",7),l(82,"Login Id "),a(83,"span",8),l(84,"*"),r()(),a(85,"div",17),u(86,"input",22),r()(),a(87,"div",6)(88,"label",7),l(89,"Login Password "),a(90,"span",8),l(91,"*"),r()(),a(92,"div",23),u(93,"input",24),a(94,"i",25),f("click",function(){return e.showPassword=!e.showPassword}),r()()(),a(95,"div",6)(96,"label",7),l(97,"Remarks"),r(),u(98,"input",26),r(),a(99,"div",6)(100,"label",7),l(101,"Status "),a(102,"span",8),l(103,"*"),r()(),a(104,"select",27),h(105,Vn,2,2,"option",28),r()(),a(106,"div",6)(107,"label",7),l(108,"Photo"),r(),h(109,Tn,2,1,"div",10),a(110,"input",29),f("change",function(s){return e.onFileChange(s)}),r()(),a(111,"div",30)(112,"button",31),f("click",function(){return e.submit(e.userForm.value)}),l(113,"Submit"),r()()()()()),n&2){let i,s,d,v,y,w,x,Z,xe;c(2),Pe("",e.label," ",e.designation==null?null:e.designation.text,""),c(4),m("formGroup",e.userForm),c(7),m("config",e.config)("options",e.chiefEngData),c(),m("ngIf",((i=e.userForm.get("chiefEngineer"))==null?null:i.invalid)&&((i=e.userForm.get("chiefEngineer"))==null?null:i.touched)),c(6),m("config",e.config)("options",e.zoneList),c(),m("ngIf",((s=e.userForm.get("zone"))==null?null:s.invalid)&&((s=e.userForm.get("zone"))==null?null:s.touched)),c(6),m("config",e.config)("options",e.supritendingEngList),c(),m("ngIf",((d=e.userForm.get("supritendingEngineer"))==null?null:d.invalid)&&((d=e.userForm.get("supritendingEngineer"))==null?null:d.touched)),c(6),m("config",e.config)("options",e.circleList),c(),m("ngIf",((v=e.userForm.get("circle"))==null?null:v.invalid)&&((v=e.userForm.get("circle"))==null?null:v.touched)),c(6),m("config",e.config)("options",e.executiveEngList),c(),m("ngIf",((y=e.userForm.get("executiveEngineer"))==null?null:y.invalid)&&((y=e.userForm.get("executiveEngineer"))==null?null:y.touched)),c(6),m("config",e.config)("options",e.cityList),c(),m("ngIf",((w=e.userForm.get("city"))==null?null:w.invalid)&&((w=e.userForm.get("city"))==null?null:w.touched)),c(6),m("config",e.config)("options",e.divisionData)("multiple",!0),c(),m("ngIf",((x=e.userForm.get("division"))==null?null:x.invalid)&&((x=e.userForm.get("division"))==null?null:x.touched)),c(13),m("ngIf",((Z=e.userForm.get("contactNo"))==null?null:Z.invalid)&&((Z=e.userForm.get("contactNo"))==null?null:Z.touched)),c(6),m("ngIf",((xe=e.userForm.get("email"))==null?null:xe.invalid)&&((xe=e.userForm.get("email"))==null?null:xe.touched)),c(18),ze("type",e.showPassword?"text":"password"),c(),m("ngClass",Ae(32,Sn,!e.showPassword,e.showPassword)),c(11),m("ngForOf",e.status),c(4),m("ngIf",e.imagePath),c(3),m("disabled",e.userForm.invalid)}},dependencies:[Fe,I,z,se,te,A,O,T,P,N,ee,ie,ne],styles:[".profile-image[_ngcontent-%COMP%]{transition:transform .3s ease,box-shadow .3s ease}.profile-image[_ngcontent-%COMP%]:hover{-webkit-transform:scale(3.5);transform:scale(3.5)}.password-container[_ngcontent-%COMP%]{position:relative}.password-container[_ngcontent-%COMP%]   .password[_ngcontent-%COMP%]{width:100%}.password-container[_ngcontent-%COMP%]   .fa[_ngcontent-%COMP%]{position:absolute;top:50%;right:10px;transform:translateY(-50%);color:#666;font-size:16px;z-index:9}"]})}}return o})();var Nn=(o,p)=>({"fa-eye":o,"fa-eye-slash":p});function Pn(o,p){o&1&&(a(0,"div")(1,"span",8),l(2,"Chief Engineer is required."),r()())}function An(o,p){o&1&&(a(0,"div")(1,"span",8),l(2,"Zone is required."),r()())}function On(o,p){o&1&&(a(0,"div")(1,"span",8),l(2,"Supritending Engineer is required."),r()())}function Rn(o,p){o&1&&(a(0,"div")(1,"span",8),l(2,"Circle is required."),r()())}function Un(o,p){o&1&&(a(0,"div")(1,"span",8),l(2,"Executive Engineer is required."),r()())}function Bn(o,p){o&1&&(a(0,"div")(1,"span",8),l(2,"City is required."),r()())}function qn(o,p){o&1&&(a(0,"div")(1,"span",8),l(2,"Assistant Engineer is required."),r()())}function jn(o,p){if(o&1){let t=R();a(0,"div",6)(1,"label",7),l(2,"Assistant Engineer "),a(3,"span",8),l(4,"*"),r()(),a(5,"ngx-select-dropdown",33),f("change",function(e){S(t);let i=C();return E(i.onChangeAssitant(e))}),r(),h(6,qn,3,0,"div",10),r()}if(o&2){let t,n=C();c(5),m("config",n.config)("options",n.assistantEngList),c(),m("ngIf",((t=n.userForm.get("assistantEngineer"))==null?null:t.invalid)&&((t=n.userForm.get("assistantEngineer"))==null?null:t.touched))}}function Gn(o,p){o&1&&(a(0,"div")(1,"span",8),l(2,"Division is required."),r()())}function Wn(o,p){o&1&&(a(0,"div")(1,"span",8),l(2,"Contact No. must be a 10-digit number."),r()())}function Zn(o,p){o&1&&(a(0,"div")(1,"span",8),l(2,"Please enter a valid email address."),r()())}function Hn(o,p){if(o&1&&(a(0,"option",34),l(1),r()),o&2){let t=p.$implicit;m("ngValue",t.id),c(),b(t.value)}}function Kn(o,p){if(o&1&&(a(0,"div"),u(1,"img",35),r()),o&2){let t=C();c(),m("src",t.getImageUrl(t.imagePath),ke)}}var St=(()=>{class o{constructor(t,n,e,i,s){this.commonService=t,this.fb=n,this.bsModelService=e,this.UserMasterService=i,this.notificationSerivce=s,this.mapdata=new W,this.config={displayKey:"text",search:!0,height:"300px",placeholder:"Select",noResultsFound:"",selectAllLabel:"Select all",enableSelectAll:!0},this.status=[{id:1,value:"Active"},{id:0,value:"Inactive"}],this.label="Create",this.imgeUrl=Me,this.showPassword=!1,this.photoBase64=null}ngOnInit(){this.initializeForm()}initializeForm(){this.userForm=this.fb.group({chiefEngineer:[null],zone:[null],supritendingEngineer:[null],circle:[null],executiveEngineer:[null],city:[null],assistantEngineer:[null],division:[null],name:[null,[g.required]],contactNo:[null],email:[null],address:[null],loginId:[null,g.required],loginPassword:[null,g.required],remarks:[null],status:[1,g.required],photo:[null]}),this.updateValidators(),this.editData?(this.getChiefBasedOnId(this.editData?.user_id),this.label="Update"):this.getChiefEngList()}updateValidators(){this.userForm.controls.chiefEngineer.clearValidators(),this.userForm.controls.supritendingEngineer.clearValidators(),this.userForm.controls.executiveEngineer.clearValidators(),this.userForm.controls.assistantEngineer.clearValidators(),this.userForm.controls.zone.clearValidators(),this.userForm.controls.circle.clearValidators(),this.userForm.controls.city.clearValidators(),this.userForm.controls.division.clearValidators(),this.userForm.get("contactNo")?.valueChanges.subscribe(t=>{this.userForm.controls.contactNo.setValidators([g.pattern(/^\d{10}$/)])}),this.userForm.get("email")?.valueChanges.subscribe(t=>{this.userForm.controls.email.setValidators([g.email])}),this.designation?.value==="2"?this.userForm.controls.zone.setValidators(g.required):["3","4","5","6"].includes(this.designation?.value)&&(this.userForm.controls.chiefEngineer.setValidators(g.required),this.userForm.controls.zone.setValidators(g.required),this.userForm.controls.circle.setValidators(g.required)),["4","5","6"].includes(this.designation?.value)&&(this.userForm.controls.supritendingEngineer.setValidators(g.required),this.userForm.controls.city.setValidators(g.required)),["5","6"].includes(this.designation?.value)&&(this.userForm.controls.executiveEngineer.setValidators(g.required),this.userForm.controls.division.setValidators(g.required)),this.designation?.value==="6"&&this.userForm.controls.assistantEngineer.setValidators(g.required),this.userForm.updateValueAndValidity()}getChiefBasedOnId(t){this.UserMasterService.userById(t).subscribe(n=>{this.userData=n?.body?.result,this.userForm&&(this.userForm.patchValue({name:this.userData?.full_name,contactNo:this.userData?.contact_no,email:this.userData?.email_id,address:this.userData?.cur_address,loginId:this.userData?.login_id,loginPassword:this.userData?.login_pass,remarks:this.userData?.remarks,status:this.userData?.is_active}),this.imagePath=this.userData?.img_path,this.getChiefEngList())})}getImageUrl(t){return t?`${this.imgeUrl}${t.replace(/\\/g,"/")}`:""}getChiefEngList(){this.commonService.chiefEngList().subscribe(t=>{if(this.chiefEngData=t?.body?.result||[],this.chiefEngData=t?.body?.result||[],this.userData){let n=this.chiefEngData?.find(e=>e?.value==this.userData?.chief_eng_id);this.userForm.controls.chiefEngineer.setValue(n),this.getZoneBasedOnCE(n?.value),this.getSupritendingEngList(n?.value)}else if(this.chiefEngData.length>0&&this.chiefEngData.length===1){let n=this.chiefEngData[0].value;this.userForm.controls.chiefEngineer.setValue(this.chiefEngData[0]),this.getSupritendingEngList(n),this.getZoneBasedOnCE(n)}else this.supritendingEngList=[],this.zoneList=[],this.executiveEngList=[],this.circleList=[],this.cityList=[],this.divisionData=[],this.userForm.controls.zone.setValue(null),this.userForm.controls.chiefEngineer.setValue(null),this.userForm.controls.supritendingEngineer.setValue(null),this.userForm.controls.executiveEngineer.setValue(null),this.userForm.controls.circle.setValue(null),this.userForm.controls.city.setValue(null),this.userForm.controls.division.setValue(null)})}onChiefEngineerChange(t){t?.value?.value?(this.getZoneBasedOnCE(t.value.value),this.getSupritendingEngList(t.value.value)):(this.supritendingEngList=[],this.zoneList=[],this.executiveEngList=[],this.circleList=[],this.cityList=[],this.divisionData=[],this.userForm.controls.zone.setValue(null),this.userForm.controls.supritendingEngineer.setValue(null),this.userForm.controls.executiveEngineer.setValue(null),this.userForm.controls.circle.setValue(null),this.userForm.controls.city.setValue(null),this.userForm.controls.division.setValue(null))}getSupritendingEngList(t){this.commonService.supritendingEngList(t).subscribe(n=>{if(this.supritendingEngList=n?.body?.result||[],this.userData){let e=this.supritendingEngList?.find(i=>i.value==this.userData?.sup_eng_id);this.userForm.controls.supritendingEngineer.setValue(e),this.getCircleBasedOnSE(e.value),this.getExecutiveEngList(e.value)}else if(this.supritendingEngList.length>0&&this.supritendingEngList.length===1){let e=this.supritendingEngList[0].value;this.userForm.controls.supritendingEngineer.setValue(this.supritendingEngList[0]),this.getExecutiveEngList(e),this.getCircleBasedOnSE(e)}else this.executiveEngList=[],this.circleList=[],this.cityList=[],this.divisionData=[],this.userForm.controls.supritendingEngineer.setValue(null),this.userForm.controls.executiveEngineer.setValue(null),this.userForm.controls.circle.setValue(null),this.userForm.controls.city.setValue(null),this.userForm.controls.division.setValue(null)})}onSupritendingEngineerChange(t){t?.value?.value?(this.getExecutiveEngList(t.value.value),this.getCircleBasedOnSE(t.value.value)):(this.executiveEngList=[],this.circleList=[],this.cityList=[],this.divisionData=[],this.userForm.controls.executiveEngineer.setValue(null),this.userForm.controls.circle.setValue(null),this.userForm.controls.city.setValue(null),this.userForm.controls.division.setValue(null))}getExecutiveEngList(t){this.commonService.executiveEngList(t).subscribe(n=>{if(this.executiveEngList=n?.body?.result||[],this.userData){let e=this.executiveEngList?.find(i=>i.value==this.userData?.exec_eng_id);this.userForm.controls.executiveEngineer.setValue(e),this.getDistrictByExecEng(e.value),this.getAssistantEngList(e.value)}else if(this.executiveEngList.length>0&&this.executiveEngList.length===1){let e=this.executiveEngList[0].value;this.userForm.controls.executiveEngineer.setValue(this.executiveEngList[0]),this.getDistrictByExecEng(e),this.getAssistantEngList(e)}else this.cityList=[],this.divisionData=[],this.assistantEngList=[],this.userForm.controls.city.setValue(null),this.userForm.controls.division.setValue(null),this.userForm.controls.executiveEngineer.setValue(null),this.userForm.controls.assistantEngineer.setValue(null)})}onExecutiveEngineerChange(t){t?.value?.value?(this.getDistrictByExecEng(t.value.value),this.getAssistantEngList(t.value.value)):(this.cityList=[],this.divisionData=[],this.assistantEngList=[],this.userForm.controls.city.setValue(null),this.userForm.controls.division.setValue(null),this.userForm.controls.assistantEngineer.setValue(null))}getAssistantEngList(t){this.commonService.assistantEngList(t).subscribe(n=>{if(this.assistantEngList=n?.body?.result||[],this.userData){let e=this.assistantEngList?.find(i=>i.value==this.userData?.ass_eng_id);this.userForm.controls.assistantEngineer.setValue(e),this.getDivisionByAssEng(e.value)}else if(this.assistantEngList.length>0&&this.assistantEngList.length===1){let e=this.assistantEngList[0].value;this.userForm.controls.assistantEngineer.setValue(this.assistantEngList[0]),this.getDivisionByAssEng(e)}else this.userForm.controls.assistantEngineer.setValue(null)})}onChangeAssitant(t){t?.value?.value?this.getDivisionByAssEng(t.value.value):(this.divisionData=[],this.userForm.controls.division.setValue(null))}getSelectedValues(t){return t?.map(n=>n.value).join(",")}close(){this.bsModelService.hide()}onFileChange(t){let n=t.target.files[0];if(n){let e=new FileReader;e.onload=()=>{let i=e.result;this.photoBase64=i.split(",")[1]},e.onerror=i=>{console.error("Error reading file:",i),this.notificationSerivce.errorAlert("Failed to read file. Please try again.")},e.readAsDataURL(n)}}submit(t){let n=this.commonService.getUserDetails(),e={user_id:0,department_id:this.department?Number(this.department?.value):null,emp_id:0,full_name:t?.name,contact_no:t?.contactNo,email_id:t?.email,cur_address:t?.address,login_id:t?.loginId,login_pass:t?.loginPassword,designation_id:this.designation?Number(this.designation?.value):null,level_id:this.designation?Number(this.designation?.value):null,chief_eng_id:t?.chiefEngineer?Number(t?.chiefEngineer?.value):null,zone:this.designation?.value==="2"?t?.zone?this.getSelectedValues(t.zone):null:t?.zone?t.zone.value:null,sup_eng_id:t?.supritendingEngineer?Number(t?.supritendingEngineer?.value):null,circle:this.designation?.value==="3"?t?.circle?this.getSelectedValues(t?.circle):null:t?.circle?t?.circle.value:null,exec_eng_id:t?.executiveEngineer?Number(t?.executiveEngineer?.value):null,district:this.designation?.value==="4"?t?.city?this.getSelectedValues(t?.city):null:t?.city?t?.city.value:null,ass_eng_id:t?.assistantEngineer?Number(t?.assistantEngineer?.value):null,division:this.designation?.value==="5"?t?.division?this.getSelectedValues(t?.division):null:t?.division?t?.division.value:null,remarks:t?.remarks,img_path:this.photoBase64,is_active:t?.status,created_by:n?.user_id},i=this.UserMasterService.createUser(e);this.userData&&(e.user_id=this.userData?.user_id,i=this.UserMasterService.updateUser(e,this.userData?.user_id)),i.subscribe(s=>{s?.status==200?(this.bsModelService.hide(),this.mapdata.emit(),this.notificationSerivce.successAlert(s?.body?.actionResponse)):this.notificationSerivce.errorAlert(s?.title)})}getZoneBasedOnCE(t){this.commonService.getZoneByChiefEng(t).subscribe(n=>{if(this.zoneList=n?.body?.result||[],this.userData){let e=this.zoneList?.find(i=>i.value==this.userData?.zone);this.userForm.controls.zone.setValue(e)}else this.zoneList.length>0&&this.zoneList.length===1?this.userForm.controls.zone.setValue(this.zoneList[0]):this.userForm.controls.zone.setValue(null)})}getCircleBasedOnSE(t){this.commonService.getCircleBySupEng(t).subscribe(n=>{if(this.circleList=n?.body?.result||[],this.userData){let e=this.circleList?.find(i=>i.value==this.userData?.circle);this.userForm.controls.circle.setValue(e)}else this.circleList.length>0&&this.circleList.length===1&&this.userForm.controls.circle.setValue(this.circleList[0])})}getDistrictByExecEng(t){this.commonService.getDistrictByExecEng(t).subscribe(n=>{if(this.cityList=n?.body?.result||[],this.userData){let e=this.cityList?.find(i=>i.value==this.userData?.district);this.userForm.controls.city.setValue(e)}else this.cityList.length>0&&this.cityList.length===1?this.userForm.controls.city.setValue(this.cityList[0]):this.userForm.controls.city.setValue(null)})}getDivisionByAssEng(t){this.commonService.getDivisionByAssEng(t).subscribe(n=>{if(this.divisionData=n?.body?.result||[],this.userData){let e=this.divisionData?.find(i=>i.value==this.userData?.division);this.userForm.controls.division.setValue(e)}else this.divisionData.length>0&&this.divisionData.length===1?this.userForm.controls.division.setValue(this.divisionData[0]):this.userForm.controls.division.setValue(null)})}static{this.\u0275fac=function(n){return new(n||o)(_(G),_(oe),_(k),_(Ie),_(V))}}static{this.\u0275cmp=D({type:o,selectors:[["app-crate-junior-eng"]],outputs:{mapdata:"mapdata"},decls:115,vars:35,consts:[[1,"modal-header","text-center"],[1,"close-modal",3,"click"],[1,"fa","fa-close",2,"cursor","pointer"],[1,"modal-body"],[3,"formGroup"],[1,"row"],[1,"col-md-3","mb-2"],[1,"form-label"],[1,"text-danger"],["formControlName","chiefEngineer",3,"change","config","options"],[4,"ngIf"],["formControlName","zone",3,"config","options"],["formControlName","supritendingEngineer",3,"change","config","options"],["formControlName","circle",3,"config","options"],["formControlName","executiveEngineer",3,"change","config","options"],["formControlName","city",3,"config","options"],["class","col-md-3 mb-2",4,"ngIf"],["formControlName","division",3,"config","options"],[1,"input-group","mb-2"],["type","text","placeholder","Enter Name","formControlName","name",1,"form-control"],["type","text","placeholder","Enter Contact No.","formControlName","contactNo",1,"form-control"],["type","email","placeholder","Enter Email","formControlName","email",1,"form-control"],["type","text","placeholder","Enter Address","formControlName","address",1,"form-control"],["type","text","placeholder","Enter Login Id","formControlName","loginId",1,"form-control"],[1,"input-group","mb-2","password-container"],["placeholder","Enter Login Password","formControlName","loginPassword",1,"form-control","password",3,"type"],["id","visiblePassword",1,"fa",2,"cursor","pointer",3,"click","ngClass"],["type","text","placeholder","Enter Remarks","formControlName","remarks",1,"form-control"],["formControlName","status",1,"form-control"],[3,"ngValue",4,"ngFor","ngForOf"],["type","file","formControlName","photo",1,"form-control",3,"change"],[1,"col-md-3","mb-2","mt-4"],[1,"btn","btn-success",3,"click","disabled"],["formControlName","assistantEngineer",3,"change","config","options"],[3,"ngValue"],["alt","Profile Photo",1,"w-10","h-10","rounded-full","profile-image","mb-2",3,"src"]],template:function(n,e){if(n&1&&(a(0,"div",0)(1,"h5"),l(2),r(),a(3,"div",1),f("click",function(){return e.close()}),u(4,"i",2),r()(),a(5,"div",3)(6,"form",4)(7,"div",5)(8,"div",6)(9,"label",7),l(10,"Chief Engineer "),a(11,"span",8),l(12,"*"),r()(),a(13,"ngx-select-dropdown",9),f("change",function(s){return e.onChiefEngineerChange(s)}),r(),h(14,Pn,3,0,"div",10),r(),a(15,"div",6)(16,"label",7),l(17,"Zone "),a(18,"span",8),l(19,"*"),r()(),u(20,"ngx-select-dropdown",11),h(21,An,3,0,"div",10),r(),a(22,"div",6)(23,"label",7),l(24,"Supritending Engineer "),a(25,"span",8),l(26,"*"),r()(),a(27,"ngx-select-dropdown",12),f("change",function(s){return e.onSupritendingEngineerChange(s)}),r(),h(28,On,3,0,"div",10),r(),a(29,"div",6)(30,"label",7),l(31,"Circle "),a(32,"span",8),l(33,"*"),r()(),u(34,"ngx-select-dropdown",13),h(35,Rn,3,0,"div",10),r(),a(36,"div",6)(37,"label",7),l(38,"Executive Engineer "),a(39,"span",8),l(40,"*"),r()(),a(41,"ngx-select-dropdown",14),f("change",function(s){return e.onExecutiveEngineerChange(s)}),r(),h(42,Un,3,0,"div",10),r(),a(43,"div",6)(44,"label",7),l(45,"City "),a(46,"span",8),l(47,"*"),r()(),u(48,"ngx-select-dropdown",15),h(49,Bn,3,0,"div",10),r(),h(50,jn,7,3,"div",16),a(51,"div",6)(52,"label",7),l(53,"Division "),a(54,"span",8),l(55,"*"),r()(),u(56,"ngx-select-dropdown",17),h(57,Gn,3,0,"div",10),r(),a(58,"div",6)(59,"label",7),l(60,"Name "),a(61,"span",8),l(62,"*"),r()(),a(63,"div",18),u(64,"input",19),r()(),a(65,"div",6)(66,"label",7),l(67,"Contact No."),r(),a(68,"div",18),u(69,"input",20),r(),h(70,Wn,3,0,"div",10),r(),a(71,"div",6)(72,"label",7),l(73,"Email"),r(),a(74,"div",18),u(75,"input",21),r(),h(76,Zn,3,0,"div",10),r(),a(77,"div",6)(78,"label",7),l(79,"Address"),r(),u(80,"input",22),r(),a(81,"div",6)(82,"label",7),l(83,"Login Id "),a(84,"span",8),l(85,"*"),r()(),a(86,"div",18),u(87,"input",23),r()(),a(88,"div",6)(89,"label",7),l(90,"Login Password "),a(91,"span",8),l(92,"*"),r()(),a(93,"div",24),u(94,"input",25),a(95,"i",26),f("click",function(){return e.showPassword=!e.showPassword}),r()()(),a(96,"div",6)(97,"label",7),l(98,"Remarks"),r(),u(99,"input",27),r(),a(100,"div",6)(101,"label",7),l(102,"Status "),a(103,"span",8),l(104,"*"),r()(),a(105,"select",28),h(106,Hn,2,2,"option",29),r()(),a(107,"div",6)(108,"label",7),l(109,"Photo"),r(),h(110,Kn,2,1,"div",10),a(111,"input",30),f("change",function(s){return e.onFileChange(s)}),r()(),a(112,"div",31)(113,"button",32),f("click",function(){return e.submit(e.userForm.value)}),l(114,"Submit"),r()()()()()),n&2){let i,s,d,v,y,w,x,Z,xe;c(2),Pe("",e.label," ",e.designation==null?null:e.designation.text,""),c(4),m("formGroup",e.userForm),c(7),m("config",e.config)("options",e.chiefEngData),c(),m("ngIf",((i=e.userForm.get("chiefEngineer"))==null?null:i.invalid)&&((i=e.userForm.get("chiefEngineer"))==null?null:i.touched)),c(6),m("config",e.config)("options",e.zoneList),c(),m("ngIf",((s=e.userForm.get("zone"))==null?null:s.invalid)&&((s=e.userForm.get("zone"))==null?null:s.touched)),c(6),m("config",e.config)("options",e.supritendingEngList),c(),m("ngIf",((d=e.userForm.get("supritendingEngineer"))==null?null:d.invalid)&&((d=e.userForm.get("supritendingEngineer"))==null?null:d.touched)),c(6),m("config",e.config)("options",e.circleList),c(),m("ngIf",((v=e.userForm.get("circle"))==null?null:v.invalid)&&((v=e.userForm.get("circle"))==null?null:v.touched)),c(6),m("config",e.config)("options",e.executiveEngList),c(),m("ngIf",((y=e.userForm.get("executiveEngineer"))==null?null:y.invalid)&&((y=e.userForm.get("executiveEngineer"))==null?null:y.touched)),c(6),m("config",e.config)("options",e.cityList),c(),m("ngIf",((w=e.userForm.get("city"))==null?null:w.invalid)&&((w=e.userForm.get("city"))==null?null:w.touched)),c(),m("ngIf",(e.designation==null?null:e.designation.value)!=="1"&&(e.designation==null?null:e.designation.value)==="6"),c(6),m("config",e.config)("options",e.divisionData),c(),m("ngIf",((x=e.userForm.get("division"))==null?null:x.invalid)&&((x=e.userForm.get("division"))==null?null:x.touched)),c(13),m("ngIf",((Z=e.userForm.get("contactNo"))==null?null:Z.invalid)&&((Z=e.userForm.get("contactNo"))==null?null:Z.touched)),c(6),m("ngIf",((xe=e.userForm.get("email"))==null?null:xe.invalid)&&((xe=e.userForm.get("email"))==null?null:xe.touched)),c(18),ze("type",e.showPassword?"text":"password"),c(),m("ngClass",Ae(32,Nn,!e.showPassword,e.showPassword)),c(11),m("ngForOf",e.status),c(4),m("ngIf",e.imagePath),c(3),m("disabled",e.userForm.invalid)}},dependencies:[Fe,I,z,se,te,A,O,T,P,N,ee,ie,ne],styles:[".profile-image[_ngcontent-%COMP%]{transition:transform .3s ease,box-shadow .3s ease}.profile-image[_ngcontent-%COMP%]:hover{-webkit-transform:scale(3.5);transform:scale(3.5)}.password-container[_ngcontent-%COMP%]{position:relative}.password-container[_ngcontent-%COMP%]   .password[_ngcontent-%COMP%]{width:100%}.password-container[_ngcontent-%COMP%]   .fa[_ngcontent-%COMP%]{position:absolute;top:50%;right:10px;transform:translateY(-50%);color:#666;font-size:16px;z-index:9}"]})}}return o})();var $n=()=>[25,50,100],Pt=(o,p,t)=>({id:"userID",itemsPerPage:o,currentPage:p,totalItems:t}),Yn=o=>({"w-zone":o}),Jn=o=>({"w-circle":o}),Qn=o=>({"w-name":o}),Xn=()=>({"w-name":!0}),eo=()=>({"w-circle":!0}),to=()=>({"w-zone":!0});function io(o,p){if(o&1){let t=R();a(0,"div",24)(1,"div",28)(2,"pagination-controls",29),f("pageChange",function(e){S(t);let i=C();return E(i.onTablePageChange(e))}),r()()()}o&2&&(c(2),m("maxSize",10)("responsive",!0)("nextLabel","")("previousLabel",""))}function no(o,p){if(o&1&&(a(0,"option",30),l(1),r()),o&2){let t=p.$implicit;m("value",t),c(),b(t)}}function oo(o,p){if(o&1&&(pe(0),u(1,"app-skeleton-loader",31),F(2,"searchFilter"),F(3,"paginate"),ue()),o&2){let t=C();c(),m("isLoading",t.isLoading)("columns",t.columns)("items",M(3,6,M(2,3,t.userList,t.searchKeyword),X(9,Pt,t.pagesize.limit,t.pagesize.offset,t.pagesize.count)))}}function ro(o,p){if(o&1&&(a(0,"th",38)(1,"span"),l(2),r()()),o&2){let t=p.$implicit;m("ngClass",it(4,Yn,t.key==="Zone"))("ngClass",it(6,Jn,t.key==="Circle"))("ngClass",it(8,Qn,t.key==="Name")),c(2),b(t==null?null:t.title)}}function ao(o,p){if(o&1&&(pe(0),u(1,"img",46),ue()),o&2){let t=C().$implicit,n=C(3);c(),m("src",n.imgeUrl+(t==null?null:t.img_path),ke)}}function so(o,p){o&1&&(a(0,"span",47),l(1,"NA"),r())}function lo(o,p){o&1&&(a(0,"span",48),l(1,"Active"),r())}function co(o,p){o&1&&(a(0,"span",49),l(1,"Inactive"),r())}function mo(o,p){if(o&1){let t=R();a(0,"tr")(1,"td"),l(2),r(),a(3,"td"),l(4),r(),a(5,"td"),l(6),r(),a(7,"td",38),l(8),r(),a(9,"td"),l(10),r(),a(11,"td"),l(12),r(),a(13,"td"),l(14),r(),a(15,"td"),l(16),r(),a(17,"td"),l(18),r(),a(19,"td"),l(20),r(),a(21,"td"),l(22),r(),a(23,"td",38),l(24),r(),a(25,"td"),l(26),r(),a(27,"td",38),l(28),r(),a(29,"td"),h(30,ao,2,1,"ng-container",27)(31,so,2,0,"ng-template",null,2,J),r(),a(33,"td"),h(34,lo,2,0,"span",40)(35,co,2,0,"ng-template",null,3,J),r(),a(37,"td")(38,"div",41)(39,"button",42),f("click",function(){let e=S(t).$implicit,i=C(3);return E(i.onCreateuser(e))}),u(40,"i",43),r(),a(41,"button",44),f("click",function(){let e=S(t).$implicit,i=C(3);return E(i.deleteUser(e))}),u(42,"i",45),r()()()()}if(o&2){let t=p.$implicit,n=p.index,e=Y(32),i=Y(36),s=C(3);c(2),Q(" ",(s.pagesize.offset-1)*s.pagesize.limit+n+1," "),c(2),b((t==null?null:t.department_name)||"NA"),c(2),b((t==null?null:t.designation_name)||"NA"),c(),m("ngClass",me(21,Xn)),c(),b((t==null?null:t.full_name)||"NA"),c(2),b((t==null?null:t.contact_no)||"NA"),c(2),b((t==null?null:t.email_id)||"NA"),c(2),b((t==null?null:t.division)||"NA"),c(2),b((t==null?null:t.ae_name)||"NA"),c(2),b((t==null?null:t.ee_name)||"NA"),c(2),b((t==null?null:t.district)||"NA"),c(2),b((t==null?null:t.se_name)||"NA"),c(),m("ngClass",me(22,eo)),c(),Q("",(t==null?null:t.circle)||"NA"," "),c(2),b((t==null?null:t.ce_name)||"NA"),c(),m("ngClass",me(23,to)),c(),Q("",(t==null?null:t.zone)||"NA"," "),c(2),m("ngIf",t==null?null:t.img_path)("ngIfElse",e),c(4),m("ngIf",t==null?null:t.is_active)("ngIfElse",i)}}function po(o,p){if(o&1&&(a(0,"tbody"),h(1,mo,43,24,"tr",39),F(2,"paginate"),r()),o&2){let t=C(2);c(),m("ngForOf",M(2,1,t.userList,X(4,Pt,t.pagesize.limit,t.pagesize.offset,t.pagesize.count)))}}function uo(o,p){o&1&&(a(0,"div",50),l(1," No User Available "),r())}function ho(o,p){if(o&1&&(a(0,"div",32)(1,"table",33,1)(3,"thead")(4,"tr",34),h(5,ro,3,10,"th",35),r()(),h(6,po,3,8,"tbody",36),r(),h(7,uo,2,0,"div",37),F(8,"searchFilter"),r()),o&2){let t,n=C();c(5),m("ngForOf",n.columns),c(),m("ngIf",n.userList),c(),m("ngIf",!(n.userList!=null&&n.userList.length)||!((t=M(8,3,n.userList,n.searchKeyword))!=null&&t.length))}}var At=(()=>{class o{get startValue(){return this.pagesize.offset*this.pagesize.limit-(this.pagesize.limit-1)}get lastValue(){let t=this.startValue+this.pagesize.limit-1;return Math.min(t,this.pagesize.count)}constructor(t,n,e,i){this.userService=t,this.modalService=n,this.commonservice=e,this.tosterService=i,this.breadcrumbs=[{label:"Home",path:"/admin/dashboard/home"},{label:"Master",path:"/admin/master/zone-master"},{label:"User Master",path:"/admin/master/user-master"}],this.isLoading=!1,this.pagesize={limit:25,offset:1,count:0},this.searchKeyword="",this.config={displayKey:"text",search:!0,height:"300px",placeholder:"Select Department"},this.config1={displayKey:"text",search:!0,height:"300px",placeholder:"Select Designation"},this.imgeUrl=Me}ngOnInit(){this.tableProperty(),this.setInitialtable(),this.getUserList(this.pagesize.offset,this.pagesize.limit,this.searchKeyword),this.getDepartmentList(),this.getDesignationList()}setInitialtable(){this.columns=[{key:"S No.",title:"S No"},{key:"Department",title:"Department"},{key:"Designation",title:"Designation"},{key:"Name",title:"Name"},{key:"Contact No.",title:"Contact No."},{key:"Email",title:"Email"},{key:"Division",title:"Division"},{key:"Assistant Engineer",title:"Assistant Engineer"},{key:"Ex Engineer",title:"Ex Engineer"},{key:"City",title:"City"},{key:"Supritending",title:"Supritending"},{key:"Circle",title:"Circle"},{key:"Chief Engineer",title:"Chief Engineer"},{key:"Zone",title:"Zone"},{key:"Image",title:"Image"},{key:"Status",title:"Status"},{key:"Action",title:"Action"}]}tableProperty(){this.configuration=Le({},De),this.configuration.checkboxes=!1,this.configuration.tableLayout.striped=!0,this.configuration.tableLayout.hover=!1,this.configuration.paginationRangeEnabled=!1,this.configuration.paginationEnabled=!1}getDepartmentList(){this.commonservice.departmentList().subscribe(t=>{this.deparmentList=t?.body?.result,this.selectedDepartment=this.deparmentList[0]})}getUserList(t,n,e){this.isLoading=!0;let i={pageNo:t,pageSize:n,searchText:e};this.userService.userList(i).subscribe(s=>{setTimeout(()=>{this.isLoading=!1},600),this.userList=s?.body?.result||[],this.pagesize.count=s?.body?.totalRow})}getDesignationList(){this.commonservice.designationList().subscribe(t=>{this.desigantionList=t?.body?.result})}onTablePageChange(t){this.pagesize.offset=t,this.getUserList(this.pagesize.offset,this.pagesize.limit,this.searchKeyword)}onPageSizeChange(t){let n=parseInt(t.target.value,10);this.pagesize.limit=n,this.getUserList(this.pagesize.offset,this.pagesize.limit,this.searchKeyword)}onCreateuser(t){if(t==="")if(this.selectedDepartment.length==0||this.selectedDesignation.length==0){this.tosterService.showWarning("Please select both Department and Designation before creating a user.");return}else{let n;this.selectedDesignation?.value==="1"?n=vt:this.selectedDesignation?.value==="2"?n=yt:this.selectedDesignation?.value==="3"?n=bt:this.selectedDesignation?.value==="4"?n=Ct:this.selectedDesignation?.value=="5"?n=Lt:this.selectedDesignation?.value=="6"&&(n=St);let e={initialState:{editData:t||"",department:this.selectedDepartment,designation:this.selectedDesignation}};this.bsModalRef=this.modalService.show(n,Object.assign(e,{class:"modal-lg modal-dialog-centered alert-popup"})),this.bsModalRef?.content?.mapdata?.subscribe(i=>{this.pagesize.offset=1,this.pagesize.limit=25,this.getUserList(this.pagesize.offset,this.pagesize.limit,this.searchKeyword)})}else{let n;t?.designation_id===1?n=vt:t?.designation_id===2?n=yt:t?.designation_id===3?n=bt:t?.designation_id===4?n=Ct:t?.designation_id==5?n=Lt:t?.designation_id==6&&(n=St);let e={value:t?.designation_id.toString()},i={value:t?.department_id.toString()},s={initialState:{editData:t||"",department:i,designation:e}};this.bsModalRef=this.modalService.show(n,Object.assign(s,{class:"modal-lg modal-dialog-centered alert-popup"})),this.bsModalRef?.content?.mapdata?.subscribe(d=>{this.pagesize.offset=1,this.pagesize.limit=25,this.getUserList(this.pagesize.offset,this.pagesize.limit,this.searchKeyword)})}}deleteUser(t){let n=this.userService.deleteUser(t?.user_id),e={initialState:{title:t?.full_name,content:"Are you sure you want to delete?",primaryActionLabel:"Delete",secondaryActionLabel:"Cancel",service:n}};this.bsModalRef=this.modalService.show(be,Object.assign(e,{id:"confirmation",class:"modal-md modal-dialog-centered"})),this.bsModalRef?.content.mapdata.subscribe(i=>{i?.status==200?(this.tosterService.successAlert(i?.body?.actionResponse),this.pagesize.offset=1,this.pagesize.limit=25,this.getUserList(this.pagesize.offset,this.pagesize.limit,this.searchKeyword)):this.tosterService.errorAlert(i?.title)})}onSearch(t){this.userList=[],this.pagesize.offset=1,this.pagesize.limit=25,this.getUserList(this.pagesize.offset,this.pagesize.limit,t.target.value)}static{this.\u0275fac=function(n){return new(n||o)(_(Ie),_(k),_(G),_(V))}}static{this.\u0275cmp=D({type:o,selectors:[["user-list"]],decls:35,vars:16,consts:[["content",""],["TABLE",""],["noImage",""],["inactive",""],[1,"card"],[1,"card-header"],[1,"header-part"],[1,"counting"],["class","row",4,"ngIf"],[1,"card-body"],[1,"row","mb-4"],[1,"col-md-3"],[3,"ngModelChange","config","ngModel","options"],[1,"search-form"],["placeholder","Search for...","type","text",1,"form-control","search-input",3,"ngModelChange","input","ngModel"],["type","button",1,"btn-search"],["aria-hidden","true",1,"fa","fa-search"],[1,"col-md-3","flex","justify-end","gap-x-2"],[1,"flex","items-center","space-x-2"],["for","itemsPerPage",1,"text-sm","text-gray-700"],["id","itemsPerPage",1,"block","w-20","p-2","bg-white","border","border-gray-300","rounded","shadow-sm","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:border-blue-500","text-gray-700",3,"ngModelChange","change","ngModel"],[3,"value",4,"ngFor","ngForOf"],[1,"btn","btn-primary",3,"click"],["aria-hidden","true",1,"fa","fa-plus"],[1,"row"],[1,"col-md-12"],[1,"overflow-auto"],[4,"ngIf","ngIfElse"],[1,"d-flex","justify-content-center"],["id","userID",3,"pageChange","maxSize","responsive","nextLabel","previousLabel"],[3,"value"],[3,"isLoading","columns","items"],["id","datatable_wrapper"],["id","datatable","role","grid","aria-describedby","datatable_info","width","100%",1,"table","table-striped","nowrap","dataTable","no-footer","dtr-inline",2,"width","100%"],["role","row"],[3,"ngClass",4,"ngFor","ngForOf"],[4,"ngIf"],["class","text-center py-4 text-gray-500",4,"ngIf"],[3,"ngClass"],[4,"ngFor","ngForOf"],["class","text-green-600 font-medium",4,"ngIf","ngIfElse"],[1,"btn-edit"],[1,"btn","btn-success",3,"click"],[1,"fa","fa-pencil"],[1,"btn","btn-danger",3,"click"],[1,"fa","fa-trash"],["alt","User Image",1,"w-10","h-10","rounded-full","user-image",3,"src"],[1,"text-gray-500"],[1,"text-green-600","font-medium"],[1,"text-red-600","font-medium"],[1,"text-center","py-4","text-gray-500"]],template:function(n,e){if(n&1){let i=R();a(0,"div",4)(1,"div",5)(2,"div",6)(3,"span"),l(4,"User Master"),r(),a(5,"div",7)(6,"span"),l(7),r()(),h(8,io,3,4,"div",8),r()(),a(9,"div",9)(10,"div",10)(11,"div",11)(12,"ngx-select-dropdown",12),$("ngModelChange",function(d){return S(i),K(e.selectedDepartment,d)||(e.selectedDepartment=d),E(d)}),r()(),a(13,"div",11)(14,"ngx-select-dropdown",12),$("ngModelChange",function(d){return S(i),K(e.selectedDesignation,d)||(e.selectedDesignation=d),E(d)}),r()(),a(15,"div",11)(16,"div",13)(17,"input",14),$("ngModelChange",function(d){return S(i),K(e.searchKeyword,d)||(e.searchKeyword=d),E(d)}),f("input",function(d){return S(i),E(e.onSearch(d))}),r(),a(18,"button",15),u(19,"i",16),r()()(),a(20,"div",17)(21,"div",18)(22,"label",19),l(23,"Items per page:"),r(),a(24,"select",20),$("ngModelChange",function(d){return S(i),K(e.pagesize.limit,d)||(e.pagesize.limit=d),E(d)}),f("change",function(d){return S(i),E(e.onPageSizeChange(d))}),h(25,no,2,2,"option",21),r()(),a(26,"button",22),f("click",function(){return S(i),E(e.onCreateuser(""))}),u(27,"i",23),l(28," Create User "),r()()(),a(29,"div",24)(30,"div",25)(31,"div",26),h(32,oo,4,13,"ng-container",27)(33,ho,9,6,"ng-template",null,0,J),r()()()()()}if(n&2){let i=Y(34);c(7),he(" ",e.pagesize.count>0?e.startValue:0," - ",e.pagesize.count>0?e.lastValue:0," OF ",e.pagesize.count>0?e.pagesize.count:0," Users "),c(),m("ngIf",e.pagesize.count&&e.pagesize.count>0),c(4),m("config",e.config),H("ngModel",e.selectedDepartment),m("options",e.deparmentList),c(2),m("config",e.config1),H("ngModel",e.selectedDesignation),m("options",e.desigantionList),c(3),H("ngModel",e.searchKeyword),c(7),H("ngModel",e.pagesize.limit),c(),m("ngForOf",me(15,$n)),c(7),m("ngIf",e.isLoading)("ngIfElse",i)}},dependencies:[Fe,I,z,ve,se,A,O,T,P,N,ge,ye,_e,fe],styles:[".header-container-user[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.header-container-user[_ngcontent-%COMP%]   .left-section-user[_ngcontent-%COMP%]{width:100%}img.user-image[_ngcontent-%COMP%]{max-width:100%}.user-image[_ngcontent-%COMP%]{transition:transform .3s ease,box-shadow .3s ease}.user-image[_ngcontent-%COMP%]:hover{-webkit-transform:scale(3.5);transform:scale(3.5)}.w-zone[_ngcontent-%COMP%]{min-width:86px;word-wrap:break-word}.w-circle[_ngcontent-%COMP%], .w-name[_ngcontent-%COMP%]{min-width:100px}.btn-edit[_ngcontent-%COMP%]{display:flex;gap:4px}"]})}}return o})();var Ot=(()=>{class o{static{this.\u0275fac=function(n){return new(n||o)}}static{this.\u0275cmp=D({type:o,selectors:[["app-manage-user-master"]],decls:2,vars:0,consts:[[1,"main-section"]],template:function(n,e){n&1&&(a(0,"div",0),u(1,"user-list"),r())},dependencies:[At]})}}return o})();var st=(()=>{class o{constructor(t){this.apiService=t}circleList(t){let n=q.circle.replace("{pageNo}",t.pageNo).replace("{pageSize}",t?.pageSize);return this.apiService.get(n).pipe(B(e=>U(e)))}createCircle(t){let n=q.addCircle;return this.apiService.post(n,t).pipe(B(e=>U(e)))}updateCircle(t,n){let e=q.deleteUpdateCircle.replace("{circleId}",n);return this.apiService.put(e,t).pipe(B(i=>U(i)))}deleteCircle(t){let n=q.deleteUpdateCircle.replace("{circleId}",t);return this.apiService.delete(n).pipe(B(e=>U(e)))}static{this.\u0275fac=function(n){return new(n||o)(Ee(we))}}static{this.\u0275prov=Ce({token:o,factory:o.\u0275fac,providedIn:"root"})}}return o})();function fo(o,p){o&1&&(a(0,"span",20),l(1," Circle Name is Required "),r())}function _o(o,p){o&1&&(a(0,"span",21),l(1," Zone is Required "),r())}function vo(o,p){if(o&1&&(a(0,"option",22),l(1),r()),o&2){let t=p.$implicit;m("ngValue",t.id),c(),b(t.value)}}function yo(o,p){o&1&&(a(0,"span",21),l(1," Status is Required "),r())}var Ut=(()=>{class o{constructor(t,n,e,i,s){this.fb=t,this.bsModelService=n,this.commonService=e,this.circleService=i,this.notificationSerivce=s,this.mapdata=new W,this.config={displayKey:"text",search:!0,height:"300px"},this.status=[{id:1,value:"Active"},{id:0,value:"Inactive"}],this.label="Create"}ngOnInit(){this.setInitialvalue(),this.getZoneList()}setInitialvalue(){this.editData?(this.label="Update",this.circleForm=this.fb.group({name:[this.editData?.circle_name,[g.required]],zone:[null,[g.required]],status:[this.editData?.is_active,[g.required]]})):this.circleForm=this.fb.group({name:["",[g.required]],zone:[null,[g.required]],status:[1,[g.required]]})}getZoneList(){this.commonService.zoneList(30).subscribe(t=>{if(this.zoneList=t?.body?.result,this.editData&&this.editData?.zone_id){let n=this.zoneList.find(e=>e.value==this.editData?.zone_id);this.circleForm.controls.zone.setValue(n)}})}close(){this.bsModelService.hide()}submit(t){if(this.circleForm.invalid){this.circleForm.markAllAsTouched();return}let n=this.commonService.getUserDetails(),e={circle_id:0,circle_name:t?.name,zone_id:t?.zone?Number(t?.zone?.value):null,zone_name:t?.zone?t?.zone?.text:null,is_active:t?.status,created_by:n?.user_id},i=this.circleService.createCircle(e);this.editData?.circle_id&&(e.circle_id=this.editData?.circle_id,i=this.circleService.updateCircle(e,this.editData?.circle_id)),i.subscribe(s=>{s?.status==200?(this.bsModelService.hide(),this.mapdata.emit(),this.notificationSerivce.successAlert(s?.body?.actionResponse)):this.notificationSerivce.errorAlert(s?.title)})}static{this.\u0275fac=function(n){return new(n||o)(_(oe),_(k),_(G),_(st),_(V))}}static{this.\u0275cmp=D({type:o,selectors:[["app-create-circle"]],outputs:{mapdata:"mapdata"},decls:33,vars:8,consts:[[1,"modal-header","text-center"],[1,"close-modal",3,"click"],[1,"fa","fa-close",2,"cursor","pointer"],[1,"modal-body"],[3,"formGroup"],[1,"_card","white-bg"],[1,"row"],[1,"col-md-6","mb-2"],[1,"form-label"],[1,"input-group","mb-2"],["type","text","formControlName","name","placeholder","Enter Circle Name","aria-describedby","button-addon2",1,"form-control"],["class","text-danger",4,"ngIf"],["formControlName","zone",3,"config","options"],["class","text-danger mt-2",4,"ngIf"],["formControlName","status",1,"form-control"],[3,"ngValue",4,"ngFor","ngForOf"],[1,"footer"],[1,"button-container"],["type","submit",1,"btn","btn-success",3,"click"],["type","button",1,"btn","btn-danger",3,"click"],[1,"text-danger"],[1,"text-danger","mt-2"],[3,"ngValue"]],template:function(n,e){if(n&1&&(a(0,"div",0)(1,"h5"),l(2),r(),a(3,"div",1),f("click",function(){return e.close()}),u(4,"i",2),r()(),a(5,"div",3)(6,"div")(7,"form",4)(8,"div",5)(9,"div",6)(10,"div",7)(11,"label",8),l(12,"Circle Name"),r(),a(13,"div",9),u(14,"input",10),r(),h(15,fo,2,0,"span",11),r(),a(16,"div",7)(17,"label",8),l(18,"Zone"),r(),u(19,"ngx-select-dropdown",12),h(20,_o,2,0,"span",13),r(),a(21,"div",7)(22,"label",8),l(23,"Status"),r(),a(24,"select",14),h(25,vo,2,2,"option",15),r(),h(26,yo,2,0,"span",13),r()()(),a(27,"div",16)(28,"div",17)(29,"button",18),f("click",function(){return e.submit(e.circleForm.value)}),l(30,"Submit"),r(),a(31,"button",19),f("click",function(){return e.close()}),l(32,"Cancel"),r()()()()()()),n&2){let i,s,d;c(2),Q("",e.label," Circle"),c(5),m("formGroup",e.circleForm),c(8),m("ngIf",(e.circleForm==null||(i=e.circleForm.get("name"))==null?null:i.invalid)&&((e.circleForm==null||(i=e.circleForm.get("name"))==null?null:i.dirty)||(e.circleForm==null||(i=e.circleForm.get("name"))==null?null:i.touched))),c(4),m("config",e.config)("options",e.zoneList),c(),m("ngIf",(e.circleForm==null||(s=e.circleForm.get("zone"))==null?null:s.invalid)&&((e.circleForm==null||(s=e.circleForm.get("zone"))==null?null:s.dirty)||(e.circleForm==null||(s=e.circleForm.get("zone"))==null?null:s.touched))),c(5),m("ngForOf",e.status),c(),m("ngIf",(e.circleForm==null||(d=e.circleForm.get("status"))==null?null:d.invalid)&&((e.circleForm==null||(d=e.circleForm.get("status"))==null?null:d.dirty)||(e.circleForm==null||(d=e.circleForm.get("status"))==null?null:d.touched)))}},dependencies:[I,z,se,te,A,O,T,P,N,ee,ie,ne]})}}return o})();var bo=()=>[25,50,100],Bt=(o,p,t)=>({id:"circleID",itemsPerPage:o,currentPage:p,totalItems:t});function Co(o,p){if(o&1){let t=R();a(0,"div",22)(1,"div",26)(2,"pagination-controls",27),f("pageChange",function(e){S(t);let i=C();return E(i.onTablePageChange(e))}),r()()()}o&2&&(c(2),m("maxSize",10)("responsive",!0)("nextLabel","")("previousLabel",""))}function Lo(o,p){if(o&1&&(a(0,"option",28),l(1),r()),o&2){let t=p.$implicit;m("value",t),c(),b(t)}}function So(o,p){if(o&1&&(pe(0),u(1,"app-skeleton-loader",29),F(2,"paginate"),ue()),o&2){let t=C();c(),m("isLoading",t.isLoading)("columns",t.columns)("items",M(2,3,t.circleList,X(6,Bt,t.pagesize.limit,t.pagesize.offset,t.pagesize.count)))}}function Eo(o,p){if(o&1&&(a(0,"th"),l(1),r()),o&2){let t=p.$implicit;c(),Q(" ",t==null?null:t.title," ")}}function wo(o,p){o&1&&(a(0,"span",41),l(1,"Active"),r())}function Do(o,p){o&1&&(a(0,"span",42),l(1,"Inactive"),r())}function xo(o,p){if(o&1){let t=R();a(0,"tr")(1,"td"),l(2),r(),a(3,"td"),l(4),r(),a(5,"td"),l(6),r(),a(7,"td"),h(8,wo,2,0,"span",35)(9,Do,2,0,"ng-template",null,2,J),r(),a(11,"td",36)(12,"button",37),f("click",function(){let e=S(t).$implicit,i=C(2);return E(i.onCreateCircle(e))}),u(13,"i",38),r(),a(14,"button",39),f("click",function(){let e=S(t).$implicit,i=C(2);return E(i.onDeleteCircle(e))}),u(15,"i",40),r()()()}if(o&2){let t=p.$implicit,n=p.index,e=Y(10),i=C(2);c(2),Q(" ",(i.pagesize.offset-1)*i.pagesize.limit+n+1," "),c(2),b((t==null?null:t.zone_name)||"NA"),c(2),b((t==null?null:t.circle_name)||"NA"),c(2),m("ngIf",t==null?null:t.is_active)("ngIfElse",e)}}function ko(o,p){o&1&&(a(0,"div",43),l(1," No Circle Available "),r())}function Fo(o,p){if(o&1&&(a(0,"div",30)(1,"table",31,1)(3,"thead")(4,"tr",32),h(5,Eo,2,1,"th",33),r()(),a(6,"tbody"),h(7,xo,16,5,"tr",33),F(8,"searchFilter"),F(9,"paginate"),r()(),h(10,ko,2,0,"div",34),F(11,"searchFilter"),r()),o&2){let t,n=C();c(5),m("ngForOf",n.columns),c(2),m("ngForOf",M(9,6,M(8,3,n.circleList,n.searchKeyword),X(12,Bt,n.pagesize.limit,n.pagesize.offset,n.pagesize.count))),c(3),m("ngIf",!(n.circleList!=null&&n.circleList.length)||!((t=M(11,9,n.circleList,n.searchKeyword))!=null&&t.length))}}var qt=(()=>{class o{get startValue(){return this.pagesize.offset*this.pagesize.limit-(this.pagesize.limit-1)}get lastValue(){let t=this.startValue+this.pagesize.limit-1;return Math.min(t,this.pagesize.count)}constructor(t,n,e){this.circleService=t,this.modalService=n,this.notificationSerivce=e,this.breadcrumbs=[{label:"Home",path:"/admin/dashboard/home"},{label:"Master",path:"/admin/master/zone-master"},{label:"Circle Master",path:"/admin/master/Circle-master"}],this.isLoading=!1,this.pagesize={limit:25,offset:1,count:0}}ngOnInit(){this.tableProperty(),this.setInitialtable(),this.getCircleList(this.pagesize.offset,this.pagesize.limit)}setInitialtable(){this.columns=[{key:"S No.",title:"S No."},{key:"Zone Name",title:"Zone Name"},{key:"Circle Name",title:"Circle Name"},{key:"Status",title:"Status",width:"5%"},{key:"Action",title:"Action",width:"10%"}]}tableProperty(){this.configuration=Le({},De),this.configuration.checkboxes=!1,this.configuration.tableLayout.striped=!0,this.configuration.tableLayout.hover=!1,this.configuration.paginationRangeEnabled=!1,this.configuration.paginationEnabled=!1}getCircleList(t,n){this.isLoading=!0;let e={pageNo:t,pageSize:n};this.circleService.circleList(e).subscribe(i=>{setTimeout(()=>{this.isLoading=!1},600),this.circleList=i?.body?.result||[],this.pagesize.count=i?.body?.totalRow})}onTablePageChange(t){this.pagesize.offset=t,this.getCircleList(this.pagesize.offset,this.pagesize.limit)}onCreateCircle(t){let n={initialState:{editData:t||""}};this.bsModalRef=this.modalService.show(Ut,Object.assign(n,{class:"modal-md modal-dialog-centered alert-popup"})),this.bsModalRef?.content?.mapdata?.subscribe(e=>{this.pagesize.offset=1,this.pagesize.limit=25,this.getCircleList(this.pagesize.offset,this.pagesize.limit)})}onDeleteCircle(t){let n=this.circleService.deleteCircle(t?.circle_id),e={initialState:{title:t?.circle_name,content:"Are you sure you want to delete?",primaryActionLabel:"Delete",secondaryActionLabel:"Cancel",service:n}};this.bsModalRef=this.modalService.show(be,Object.assign(e,{id:"confirmation",class:"modal-md modal-dialog-centered"})),this.bsModalRef?.content.mapdata.subscribe(i=>{i?.status==200?(this.notificationSerivce.successAlert(i?.body?.actionResponse),this.pagesize.offset=1,this.pagesize.limit=25,this.getCircleList(this.pagesize.offset,this.pagesize.limit)):this.notificationSerivce.errorAlert(i?.title)})}onPageSizeChange(t){let n=parseInt(t.target.value,10);this.pagesize.limit=n,this.getCircleList(this.pagesize.offset,this.pagesize.limit)}static{this.\u0275fac=function(n){return new(n||o)(_(st),_(k),_(V))}}static{this.\u0275cmp=D({type:o,selectors:[["circle-list"]],decls:31,vars:10,consts:[["content",""],["TABLE",""],["inactive",""],[1,"card"],[1,"card-header"],[1,"header-part"],[1,"counting"],["class","row",4,"ngIf"],[1,"card-body"],[1,"header-container"],[1,"left-section"],[1,"search-form"],["placeholder","Search for...","type","text",1,"form-control","search-input",3,"ngModelChange","ngModel"],["type","button",1,"btn-search"],["aria-hidden","true",1,"fa","fa-search"],[1,"right-section","flex","gap-x-2"],[1,"flex","items-center","space-x-2"],["for","itemsPerPage",1,"text-sm","text-gray-700"],["id","itemsPerPage",1,"block","w-20","p-2","bg-white","border","border-gray-300","rounded","shadow-sm","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:border-blue-500","text-gray-700",3,"ngModelChange","change","ngModel"],[3,"value",4,"ngFor","ngForOf"],[1,"btn","btn-primary",3,"click"],["aria-hidden","true",1,"fa","fa-plus"],[1,"row"],[1,"col-md-12"],[1,"overflow-auto"],[4,"ngIf","ngIfElse"],[1,"d-flex","justify-content-center"],["id","circleID",3,"pageChange","maxSize","responsive","nextLabel","previousLabel"],[3,"value"],[3,"isLoading","columns","items"],["id","datatable_wrapper"],["id","datatable","role","grid","aria-describedby","datatable_info","width","100%",1,"table","table-striped","nowrap","dataTable","no-footer","dtr-inline",2,"width","100%"],["role","row"],[4,"ngFor","ngForOf"],["class","text-center py-4 text-gray-500",4,"ngIf"],["class","text-green-600 font-medium",4,"ngIf","ngIfElse"],[1,"flex","space-x-2"],[1,"btn","btn-success",3,"click"],[1,"fa","fa-pencil"],[1,"btn","btn-danger",3,"click"],[1,"fa","fa-trash"],[1,"text-green-600","font-medium"],[1,"text-red-600","font-medium"],[1,"text-center","py-4","text-gray-500"]],template:function(n,e){if(n&1){let i=R();a(0,"div",3)(1,"div",4)(2,"div",5)(3,"span"),l(4,"Circle Master"),r(),a(5,"div",6)(6,"span"),l(7),r()(),h(8,Co,3,4,"div",7),r()(),a(9,"div",8)(10,"div",9)(11,"div",10)(12,"div",11)(13,"input",12),$("ngModelChange",function(d){return S(i),K(e.searchKeyword,d)||(e.searchKeyword=d),E(d)}),r(),a(14,"button",13),u(15,"i",14),r()()(),a(16,"div",15)(17,"div",16)(18,"label",17),l(19,"Items per page:"),r(),a(20,"select",18),$("ngModelChange",function(d){return S(i),K(e.pagesize.limit,d)||(e.pagesize.limit=d),E(d)}),f("change",function(d){return S(i),E(e.onPageSizeChange(d))}),h(21,Lo,2,2,"option",19),r()(),a(22,"button",20),f("click",function(){return S(i),E(e.onCreateCircle(""))}),u(23,"i",21),l(24," Create Circle "),r()()(),a(25,"div",22)(26,"div",23)(27,"div",24),h(28,So,3,10,"ng-container",25)(29,Fo,12,16,"ng-template",null,0,J),r()()()()()}if(n&2){let i=Y(30);c(7),he(" ",e.pagesize.count>0?e.startValue:0," - ",e.pagesize.count>0?e.lastValue:0," OF ",e.pagesize.count>0?e.pagesize.count:0," Circle "),c(),m("ngIf",e.pagesize.count&&e.pagesize.count>0),c(5),H("ngModel",e.searchKeyword),c(7),H("ngModel",e.pagesize.limit),c(),m("ngForOf",me(9,bo)),c(7),m("ngIf",e.isLoading)("ngIfElse",i)}},dependencies:[I,z,ve,A,O,T,P,N,ge,ye,_e,fe]})}}return o})();var jt=(()=>{class o{static{this.\u0275fac=function(n){return new(n||o)}}static{this.\u0275cmp=D({type:o,selectors:[["app-manage-circle-master"]],decls:2,vars:0,consts:[[1,"main-section"]],template:function(n,e){n&1&&(a(0,"div",0),u(1,"circle-list"),r())},dependencies:[qt]})}}return o})();var lt=(()=>{class o{constructor(t){this.apiService=t}districtList(t){let n=q.district.replace("{pageNo}",t.pageNo).replace("{pageSize}",t?.pageSize);return this.apiService.get(n).pipe(B(e=>U(e)))}createDistrict(t){let n=q.addDistrict;return this.apiService.post(n,t).pipe(B(e=>U(e)))}updateDistrict(t,n){let e=q.updateDeleteDist.replace("{distId}",t);return this.apiService.put(e,n).pipe(B(i=>U(i)))}deleteDistrict(t){let n=q.updateDeleteDist.replace("{distId}",t);return this.apiService.delete(n).pipe(B(e=>U(e)))}static{this.\u0275fac=function(n){return new(n||o)(Ee(we))}}static{this.\u0275prov=Ce({token:o,factory:o.\u0275fac,providedIn:"root"})}}return o})();function Io(o,p){o&1&&(a(0,"span",21),l(1," District Name is Required "),r())}function zo(o,p){o&1&&(a(0,"span",22),l(1," Zone is Required "),r())}function Vo(o,p){o&1&&(a(0,"span",22),l(1," Circle is Required "),r())}function To(o,p){if(o&1&&(a(0,"option",23),l(1),r()),o&2){let t=p.$implicit;m("ngValue",t.id),c(),b(t.value)}}function No(o,p){o&1&&(a(0,"span",22),l(1," Status is Required "),r())}var Wt=(()=>{class o{constructor(t,n,e,i,s){this.bsModelService=t,this.commonService=n,this.notificationSerivce=e,this.fb=i,this.districtService=s,this.mapdata=new W,this.config={displayKey:"text",search:!0,height:"300px"},this.status=[{id:1,value:"Active"},{id:0,value:"Inactive"}],this.label="Create"}ngOnInit(){this.setInitialvalue(),this.getZoneList()}setInitialvalue(){this.editData?(this.label="Update",this.districtForm=this.fb.group({name:[this.editData?.district_name,[g.required]],zone:[null,[g.required]],circle:[null,[g.required]],status:[this.editData?.is_active,[g.required]]})):this.districtForm=this.fb.group({name:["",[g.required]],zone:[null,[g.required]],circle:[null,[g.required]],status:[1,[g.required]]})}getZoneList(){this.commonService.zoneList(30).subscribe(t=>{if(this.zoneList=t?.body?.result,this.editData&&this.editData?.zone_id){let n=this.zoneList.find(e=>e.value==this.editData?.zone_id);this.districtForm.controls.zone.setValue(n),this.getCircleList(n.value)}})}getCircleList(t){this.commonService.circleList(t).subscribe(n=>{if(this.circleList=n?.body?.result,this.editData&&this.editData?.circle_id){let e=this.circleList.find(i=>i.value==this.editData?.circle_id);this.districtForm.controls.circle.setValue(e)}})}onChangeZone(t){t?.value?.value?this.getCircleList(t.value.value):this.circleList=[]}submit(t){if(this.districtForm.invalid){this.districtForm.markAllAsTouched();return}let n=this.commonService.getUserDetails(),e={district_id:0,district_name:t?.name,circle_id:t?.circle?Number(t.circle.value):null,is_active:t?.status,created_by:n?.user_id,zone_id:t?.zone?Number(t.zone.value):null,zone_name:t?.zone?t.zone.text:null,circle_name:t?.circle?t.circle.text:null},i=this.districtService.createDistrict(e);this.editData&&(e.district_id=this.editData?.district_id,i=this.districtService.updateDistrict(this.editData?.district_id,e)),i.subscribe(s=>{s?.status==200?(this.bsModelService.hide(),this.mapdata.emit(),this.notificationSerivce.successAlert(s?.body?.actionResponse)):this.notificationSerivce.errorAlert(s?.title)})}close(){this.bsModelService.hide()}static{this.\u0275fac=function(n){return new(n||o)(_(k),_(G),_(V),_(oe),_(lt))}}static{this.\u0275cmp=D({type:o,selectors:[["app-create-district"]],outputs:{mapdata:"mapdata"},decls:38,vars:11,consts:[[1,"modal-header","text-center"],[1,"close-modal",3,"click"],[1,"fa","fa-close",2,"cursor","pointer"],[1,"modal-body"],[3,"formGroup"],[1,"_card","white-bg"],[1,"row"],[1,"col-md-6","mb-2"],[1,"form-label"],[1,"input-group","mb-2"],["type","text","formControlName","name","placeholder","Enter District Name","aria-describedby","button-addon2",1,"form-control"],["class","text-danger",4,"ngIf"],["formControlName","zone",3,"change","config","options"],["class","text-danger mt-2",4,"ngIf"],["formControlName","circle",3,"config","options"],["formControlName","status",1,"form-control"],[3,"ngValue",4,"ngFor","ngForOf"],[1,"footer"],[1,"button-container"],["type","submit",1,"btn","btn-success",3,"click"],["type","button",1,"btn","btn-danger",3,"click"],[1,"text-danger"],[1,"text-danger","mt-2"],[3,"ngValue"]],template:function(n,e){if(n&1&&(a(0,"div",0)(1,"h5"),l(2),r(),a(3,"div",1),f("click",function(){return e.close()}),u(4,"i",2),r()(),a(5,"div",3)(6,"div")(7,"form",4)(8,"div",5)(9,"div",6)(10,"div",7)(11,"label",8),l(12,"District Name"),r(),a(13,"div",9),u(14,"input",10),r(),h(15,Io,2,0,"span",11),r(),a(16,"div",7)(17,"label",8),l(18,"Zone"),r(),a(19,"ngx-select-dropdown",12),f("change",function(s){return e.onChangeZone(s)}),r(),h(20,zo,2,0,"span",13),r(),a(21,"div",7)(22,"label",8),l(23,"Circle"),r(),u(24,"ngx-select-dropdown",14),h(25,Vo,2,0,"span",13),r(),a(26,"div",7)(27,"label",8),l(28,"Status"),r(),a(29,"select",15),h(30,To,2,2,"option",16),r(),h(31,No,2,0,"span",13),r()()(),a(32,"div",17)(33,"div",18)(34,"button",19),f("click",function(){return e.submit(e.districtForm.value)}),l(35,"Submit"),r(),a(36,"button",20),f("click",function(){return e.close()}),l(37,"Cancel"),r()()()()()()),n&2){let i,s,d,v;c(2),Q("",e.label," District"),c(5),m("formGroup",e.districtForm),c(8),m("ngIf",(e.districtForm==null||(i=e.districtForm.get("name"))==null?null:i.invalid)&&((e.districtForm==null||(i=e.districtForm.get("name"))==null?null:i.dirty)||(e.districtForm==null||(i=e.districtForm.get("name"))==null?null:i.touched))),c(4),m("config",e.config)("options",e.zoneList),c(),m("ngIf",(e.districtForm==null||(s=e.districtForm.get("zone"))==null?null:s.invalid)&&((e.districtForm==null||(s=e.districtForm.get("zone"))==null?null:s.dirty)||(e.districtForm==null||(s=e.districtForm.get("zone"))==null?null:s.touched))),c(4),m("config",e.config)("options",e.circleList),c(),m("ngIf",(e.districtForm==null||(d=e.districtForm.get("circle"))==null?null:d.invalid)&&((e.districtForm==null||(d=e.districtForm.get("circle"))==null?null:d.dirty)||(e.districtForm==null||(d=e.districtForm.get("circle"))==null?null:d.touched))),c(5),m("ngForOf",e.status),c(),m("ngIf",(e.districtForm==null||(v=e.districtForm.get("status"))==null?null:v.invalid)&&((e.districtForm==null||(v=e.districtForm.get("status"))==null?null:v.dirty)||(e.districtForm==null||(v=e.districtForm.get("status"))==null?null:v.touched)))}},dependencies:[I,z,se,te,A,O,T,P,N,ee,ie,ne]})}}return o})();var Po=()=>[25,50,100],Zt=(o,p,t)=>({id:"distID",itemsPerPage:o,currentPage:p,totalItems:t});function Ao(o,p){if(o&1){let t=R();a(0,"div",22)(1,"div",26)(2,"pagination-controls",27),f("pageChange",function(e){S(t);let i=C();return E(i.onTablePageChange(e))}),r()()()}o&2&&(c(2),m("maxSize",10)("responsive",!0)("nextLabel","")("previousLabel",""))}function Oo(o,p){if(o&1&&(a(0,"option",28),l(1),r()),o&2){let t=p.$implicit;m("value",t),c(),b(t)}}function Ro(o,p){if(o&1&&(pe(0),u(1,"app-skeleton-loader",29),F(2,"paginate"),ue()),o&2){let t=C();c(),m("isLoading",t.isLoading)("columns",t.columns)("items",M(2,3,t.districtList,X(6,Zt,t.pagesize.limit,t.pagesize.offset,t.pagesize.count)))}}function Uo(o,p){if(o&1&&(a(0,"th")(1,"span"),l(2),r()()),o&2){let t=p.$implicit;c(2),b(t==null?null:t.title)}}function Bo(o,p){o&1&&(a(0,"span",41),l(1,"Active"),r())}function qo(o,p){o&1&&(a(0,"span",42),l(1,"Inactive"),r())}function jo(o,p){if(o&1){let t=R();a(0,"tr")(1,"td"),l(2),r(),a(3,"td"),l(4),r(),a(5,"td"),l(6),r(),a(7,"td"),h(8,Bo,2,0,"span",35)(9,qo,2,0,"ng-template",null,2,J),r(),a(11,"td",36)(12,"button",37),f("click",function(){let e=S(t).$implicit,i=C(2);return E(i.onCreateDistrict(e))}),u(13,"i",38),r(),a(14,"button",39),f("click",function(){let e=S(t).$implicit,i=C(2);return E(i.onDeleteDistrict(e))}),u(15,"i",40),r()()()}if(o&2){let t=p.$implicit,n=p.index,e=Y(10),i=C(2);c(2),b((i.pagesize.offset-1)*i.pagesize.limit+n+1),c(2),b(t==null?null:t.circle_name),c(2),b(t==null?null:t.district_name),c(2),m("ngIf",t==null?null:t.is_active)("ngIfElse",e)}}function Go(o,p){o&1&&(a(0,"div",43),l(1," No district Available "),r())}function Wo(o,p){if(o&1&&(a(0,"div",30)(1,"table",31,1)(3,"thead")(4,"tr",32),h(5,Uo,3,1,"th",33),r()(),a(6,"tbody"),h(7,jo,16,5,"tr",33),F(8,"searchFilter"),F(9,"paginate"),r()(),h(10,Go,2,0,"div",34),F(11,"searchFilter"),r()),o&2){let t,n=C();c(5),m("ngForOf",n.columns),c(2),m("ngForOf",M(9,6,M(8,3,n.districtList,n.searchKeyword),X(12,Zt,n.pagesize.limit,n.pagesize.offset,n.pagesize.count))),c(3),m("ngIf",!(n.districtList!=null&&n.districtList.length)||!((t=M(11,9,n.districtList,n.searchKeyword))!=null&&t.length))}}var Ht=(()=>{class o{get startValue(){return this.pagesize.offset*this.pagesize.limit-(this.pagesize.limit-1)}get lastValue(){let t=this.startValue+this.pagesize.limit-1;return Math.min(t,this.pagesize.count)}constructor(t,n,e){this.districtService=t,this.modalService=n,this.notificationSerivce=e,this.breadcrumbs=[{label:"Home",path:"/admin/dashboard/home"},{label:"Master",path:"/admin/master/zone-master"},{label:"District Master",path:"/admin/master/disrict-master"}],this.isLoading=!1,this.pagesize={limit:25,offset:1,count:0}}ngOnInit(){this.tableProperty(),this.setInitialtable(),this.getDistrictList(this.pagesize.offset,this.pagesize.limit)}setInitialtable(){this.columns=[{key:"S No.",title:"S No."},{key:"Circle Name",title:"Circle Name"},{key:"District Name",title:"District Name"},{key:"Status",title:"Status",width:"5%"},{key:"Action",title:"Action",width:"10%"}]}tableProperty(){this.configuration=Le({},De),this.configuration.checkboxes=!1,this.configuration.tableLayout.striped=!0,this.configuration.tableLayout.hover=!1,this.configuration.paginationRangeEnabled=!1,this.configuration.paginationEnabled=!1}getDistrictList(t,n){this.isLoading=!0;let e={pageNo:t,pageSize:n};this.districtService.districtList(e).subscribe(i=>{setTimeout(()=>{this.isLoading=!1},600),this.districtList=i?.body?.result||[],this.pagesize.count=i?.body?.totalRow})}onTablePageChange(t){this.pagesize.offset=t,this.getDistrictList(this.pagesize.offset,this.pagesize.limit)}onCreateDistrict(t){let n={initialState:{editData:t||""}};this.bsModalRef=this.modalService.show(Wt,Object.assign(n,{class:"modal-md modal-dialog-centered alert-popup"})),this.bsModalRef?.content?.mapdata?.subscribe(e=>{this.pagesize.offset=1,this.pagesize.limit=25,this.getDistrictList(this.pagesize.offset,this.pagesize.limit)})}onDeleteDistrict(t){let n=this.districtService.deleteDistrict(t?.circle_id),e={initialState:{title:t?.district_name,content:"Are you sure you want to delete?",primaryActionLabel:"Delete",secondaryActionLabel:"Cancel",service:n}};this.bsModalRef=this.modalService.show(be,Object.assign(e,{id:"confirmation",class:"modal-md modal-dialog-centered"})),this.bsModalRef?.content.mapdata.subscribe(i=>{i?.status==200?(this.notificationSerivce.successAlert(i?.body?.actionResponse),this.pagesize.offset=1,this.pagesize.limit=25,this.getDistrictList(this.pagesize.offset,this.pagesize.limit)):this.notificationSerivce.errorAlert(i?.title)})}onPageSizeChange(t){let n=parseInt(t.target.value,10);this.pagesize.limit=n,this.getDistrictList(this.pagesize.offset,this.pagesize.limit)}static{this.\u0275fac=function(n){return new(n||o)(_(lt),_(k),_(V))}}static{this.\u0275cmp=D({type:o,selectors:[["district-list"]],decls:31,vars:10,consts:[["content",""],["TABLE",""],["inactive",""],[1,"card"],[1,"card-header"],[1,"header-part"],[1,"counting"],["class","row",4,"ngIf"],[1,"card-body"],[1,"header-container"],[1,"left-section"],[1,"search-form"],["placeholder","Search for...","type","text",1,"form-control","search-input",3,"ngModelChange","ngModel"],["type","button",1,"btn-search"],["aria-hidden","true",1,"fa","fa-search"],[1,"right-section","flex","gap-x-2"],[1,"flex","items-center","space-x-2"],["for","itemsPerPage",1,"text-sm","text-gray-700"],["id","itemsPerPage",1,"block","w-20","p-2","bg-white","border","border-gray-300","rounded","shadow-sm","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:border-blue-500","text-gray-700",3,"ngModelChange","change","ngModel"],[3,"value",4,"ngFor","ngForOf"],[1,"btn","btn-primary",3,"click"],["aria-hidden","true",1,"fa","fa-plus"],[1,"row"],[1,"col-md-12"],[1,"overflow-auto"],[4,"ngIf","ngIfElse"],[1,"d-flex","justify-content-center"],["id","distID",3,"pageChange","maxSize","responsive","nextLabel","previousLabel"],[3,"value"],[3,"isLoading","columns","items"],["id","datatable_wrapper"],["id","datatable","role","grid","aria-describedby","datatable_info","width","100%",1,"table","table-striped","nowrap","dataTable","no-footer","dtr-inline",2,"width","100%"],["role","row"],[4,"ngFor","ngForOf"],["class","text-center py-4 text-gray-500",4,"ngIf"],["class","text-green-600 font-medium",4,"ngIf","ngIfElse"],[1,"flex","space-x-2"],[1,"btn","btn-success",3,"click"],[1,"fa","fa-pencil"],[1,"btn","btn-danger",3,"click"],[1,"fa","fa-trash"],[1,"text-green-600","font-medium"],[1,"text-red-600","font-medium"],[1,"text-center","py-4","text-gray-500"]],template:function(n,e){if(n&1){let i=R();a(0,"div",3)(1,"div",4)(2,"div",5)(3,"span"),l(4,"District Master"),r(),a(5,"div",6)(6,"span"),l(7),r()(),h(8,Ao,3,4,"div",7),r()(),a(9,"div",8)(10,"div",9)(11,"div",10)(12,"div",11)(13,"input",12),$("ngModelChange",function(d){return S(i),K(e.searchKeyword,d)||(e.searchKeyword=d),E(d)}),r(),a(14,"button",13),u(15,"i",14),r()()(),a(16,"div",15)(17,"div",16)(18,"label",17),l(19,"Items per page:"),r(),a(20,"select",18),$("ngModelChange",function(d){return S(i),K(e.pagesize.limit,d)||(e.pagesize.limit=d),E(d)}),f("change",function(d){return S(i),E(e.onPageSizeChange(d))}),h(21,Oo,2,2,"option",19),r()(),a(22,"button",20),f("click",function(){return S(i),E(e.onCreateDistrict(""))}),u(23,"i",21),l(24," Create District "),r()()(),a(25,"div",22)(26,"div",23)(27,"div",24),h(28,Ro,3,10,"ng-container",25)(29,Wo,12,16,"ng-template",null,0,J),r()()()()()}if(n&2){let i=Y(30);c(7),he(" ",e.pagesize.count>0?e.startValue:0," - ",e.pagesize.count>0?e.lastValue:0," OF ",e.pagesize.count>0?e.pagesize.count:0," District "),c(),m("ngIf",e.pagesize.count&&e.pagesize.count>0),c(5),H("ngModel",e.searchKeyword),c(7),H("ngModel",e.pagesize.limit),c(),m("ngForOf",me(9,Po)),c(7),m("ngIf",e.isLoading)("ngIfElse",i)}},dependencies:[I,z,ve,A,O,T,P,N,ge,ye,_e,fe]})}}return o})();var Kt=(()=>{class o{static{this.\u0275fac=function(n){return new(n||o)}}static{this.\u0275cmp=D({type:o,selectors:[["app-manage-district-master"]],decls:2,vars:0,consts:[[1,"main-section"]],template:function(n,e){n&1&&(a(0,"div",0),u(1,"district-list"),r())},dependencies:[Ht]})}}return o})();var ct=(()=>{class o{constructor(t){this.apiService=t}divisionList(t){let n=q.getDivisionDetails.replace("{pageNo}",t.pageNo).replace("{pageSize}",t?.pageSize);return this.apiService.get(n).pipe(B(e=>U(e)))}createDivision(t){let n=q.createDivision;return this.apiService.post(n,t).pipe(B(e=>U(e)))}updateDivision(t,n){let e=q.updateDivision.replace("{divisionId}",n);return this.apiService.put(e,t).pipe(B(i=>U(i)))}deleteDivision(t){let n=q.updateDivision.replace("{divisionId}",t);return this.apiService.delete(n).pipe(B(e=>U(e)))}static{this.\u0275fac=function(n){return new(n||o)(Ee(we))}}static{this.\u0275prov=Ce({token:o,factory:o.\u0275fac,providedIn:"root"})}}return o})();function Ho(o,p){o&1&&(a(0,"span",21),l(1," Division Name is required. "),r())}function Ko(o,p){o&1&&(a(0,"span",21),l(1," Zone is required. "),r())}function $o(o,p){o&1&&(a(0,"span",21),l(1," Circle is required. "),r())}function Yo(o,p){o&1&&(a(0,"span",21),l(1," City is required. "),r())}function Jo(o,p){if(o&1&&(a(0,"option",22),l(1),r()),o&2){let t=p.$implicit;m("ngValue",t.id),c(),b(t.value)}}function Qo(o,p){o&1&&(a(0,"span",21),l(1," Status is required. "),r())}var Yt=(()=>{class o{constructor(t,n,e,i,s){this.commonService=t,this.fb=n,this.bsModelService=e,this.divisionService=i,this.notificationSerivce=s,this.mapdata=new W,this.config={displayKey:"text",search:!0,height:"300px"},this.status=[{id:1,value:"Active"},{id:0,value:"Inactive"}]}ngOnInit(){this.setInitialValue(),this.getZoneList()}setInitialValue(){console.log("chekc edit",this.editData),this.editData?this.divisionForm=this.fb.group({divisionName:[this.editData?.division_name,[g.required]],zone:["",[g.required]],circle:["",[g.required]],city:["",[g.required]],status:[this.editData?.is_active,[g.required]]}):this.divisionForm=this.fb.group({divisionName:["",[g.required]],zone:["",[g.required]],circle:["",[g.required]],city:["",[g.required]],status:[1,[g.required]]})}getZoneList(){this.commonService.zoneList(30).subscribe(t=>{if(this.zoneList=t?.body?.result||[],this.editData){let n=this.zoneList.find(e=>this.editData?.zone_id==e.value);this.divisionForm.controls.zone.patchValue(n),this.getCircleList(this.editData?.zone_id)}else this.zoneList.length>0?(this.divisionForm.controls.zone.patchValue(this.zoneList[0]),this.getCircleList(this.zoneList[0].value)):(this.zoneList=[],this.circleList=[],this.cityList=[],this.divisionForm.controls.zone.patchValue(""),this.divisionForm.controls.circle.patchValue(""),this.divisionForm.controls.city.patchValue(""))})}onChangeZone(t){t?.value?.value?(this.divisionForm.controls.circle.patchValue(""),this.getCircleList(t.value.value)):(this.circleList=[],this.cityList=[],this.divisionForm.controls.circle.patchValue(""),this.divisionForm.controls.city.patchValue(""))}getCircleList(t){this.commonService.circleList(t).subscribe(n=>{if(this.circleList=n?.body?.result,this.editData){let e=this.circleList.find(i=>this.editData?.circle_id==i.value);this.divisionForm.controls.circle.patchValue(e),this.getCityList(this.editData?.circle_id)}else this.circleList.length>0?(this.divisionForm.controls.circle.patchValue(this.circleList[0]),this.getCityList(this.circleList[0].value)):(this.circleList=[],this.cityList=[],this.divisionForm.controls.circle.patchValue(""),this.divisionForm.controls.city.patchValue(""))})}onChangeCircle(t){t?.value?.value?this.getCityList(t.value.value):(this.cityList=[],this.divisionForm.controls.city.patchValue(""))}getCityList(t){this.commonService.cityList(t).subscribe(n=>{if(this.cityList=n?.body?.result,this.divisionForm.controls.city.patchValue(null),this.editData){let e=this.cityList.find(i=>this.editData?.district_id==i.value);this.divisionForm.controls.city.patchValue(e)}})}submit(t){if(this.divisionForm.invalid){this.divisionForm.markAllAsTouched();return}let n=this.commonService.getUserDetails(),e={division_id:0,division_name:t?.divisionName,district_id:t?.city?Number(t?.city?.value):null,is_active:t?.status,created_by:n?.user_id,zone_id:t?.zone?Number(t?.zone?.value):null,zone_name:t?.zone?t?.zone?.text:null,circle_id:t?.circle?Number(t?.circle?.value):null,circle_name:t?.circle?t?.circle?.text:null,district_name:t?.city?t?.city?.text:null},i=this.divisionService.createDivision(e);this.editData&&(e.division_id=this.editData?.division_id,i=this.divisionService.updateDivision(e,this.editData?.division_id)),i.subscribe(s=>{s?.status==200?(this.bsModelService.hide(),this.mapdata.emit(),this.notificationSerivce.successAlert(s?.body?.actionResponse)):this.notificationSerivce.errorAlert(s?.title)})}close(){this.bsModelService.hide()}static{this.\u0275fac=function(n){return new(n||o)(_(G),_(oe),_(k),_(ct),_(V))}}static{this.\u0275cmp=D({type:o,selectors:[["app-create-division"]],outputs:{mapdata:"mapdata"},decls:43,vars:13,consts:[[1,"modal-header","text-center"],[1,"close-modal",3,"click"],[1,"fa","fa-close",2,"cursor","pointer"],[1,"modal-body"],[3,"formGroup"],[1,"_card","white-bg"],[1,"row"],[1,"col-md-4","mb-2"],[1,"form-label"],[1,"input-group","mb-2"],["type","text","placeholder","Enter Division Name","formControlName","divisionName",1,"form-control"],["class","text-danger",4,"ngIf"],["formControlName","zone",3,"change","config","options"],["formControlName","circle",3,"change","config","options"],["formControlName","city",3,"config","options"],["formControlName","status",1,"form-control"],[3,"ngValue",4,"ngFor","ngForOf"],[1,"footer"],[1,"button-container"],["type","submit",1,"btn","btn-success",3,"click"],["type","button",1,"btn","btn-danger",3,"click"],[1,"text-danger"],[3,"ngValue"]],template:function(n,e){if(n&1&&(a(0,"div",0)(1,"h5"),l(2,"Division Zone"),r(),a(3,"div",1),f("click",function(){return e.close()}),u(4,"i",2),r()(),a(5,"div",3)(6,"div")(7,"form",4)(8,"div",5)(9,"div",6)(10,"div",7)(11,"label",8),l(12,"Division Name"),r(),a(13,"div",9),u(14,"input",10),r(),h(15,Ho,2,0,"span",11),r(),a(16,"div",7)(17,"label",8),l(18,"Zone"),r(),a(19,"ngx-select-dropdown",12),f("change",function(s){return e.onChangeZone(s)}),r(),h(20,Ko,2,0,"span",11),r(),a(21,"div",7)(22,"label",8),l(23,"Circle"),r(),a(24,"ngx-select-dropdown",13),f("change",function(s){return e.onChangeCircle(s)}),r(),h(25,$o,2,0,"span",11),r(),a(26,"div",7)(27,"label",8),l(28,"City"),r(),u(29,"ngx-select-dropdown",14),h(30,Yo,2,0,"span",11),r(),a(31,"div",7)(32,"label",8),l(33,"Status"),r(),a(34,"select",15),h(35,Jo,2,2,"option",16),r(),h(36,Qo,2,0,"span",11),r()()(),a(37,"div",17)(38,"div",18)(39,"button",19),f("click",function(){return e.submit(e.divisionForm.value)}),l(40,"Submit"),r(),a(41,"button",20),f("click",function(){return e.close()}),l(42,"Cancel"),r()()()()()()),n&2){let i,s,d,v,y;c(7),m("formGroup",e.divisionForm),c(8),m("ngIf",((i=e.divisionForm.get("divisionName"))==null?null:i.invalid)&&(((i=e.divisionForm.get("divisionName"))==null?null:i.dirty)||((i=e.divisionForm.get("divisionName"))==null?null:i.touched))),c(4),m("config",e.config)("options",e.zoneList),c(),m("ngIf",((s=e.divisionForm.get("zone"))==null?null:s.invalid)&&(((s=e.divisionForm.get("zone"))==null?null:s.dirty)||((s=e.divisionForm.get("zone"))==null?null:s.touched))),c(4),m("config",e.config)("options",e.circleList),c(),m("ngIf",((d=e.divisionForm.get("circle"))==null?null:d.invalid)&&(((d=e.divisionForm.get("circle"))==null?null:d.dirty)||((d=e.divisionForm.get("circle"))==null?null:d.touched))),c(4),m("config",e.config)("options",e.cityList),c(),m("ngIf",((v=e.divisionForm.get("city"))==null?null:v.invalid)&&(((v=e.divisionForm.get("city"))==null?null:v.dirty)||((v=e.divisionForm.get("city"))==null?null:v.touched))),c(5),m("ngForOf",e.status),c(),m("ngIf",((y=e.divisionForm.get("status"))==null?null:y.invalid)&&(((y=e.divisionForm.get("status"))==null?null:y.dirty)||((y=e.divisionForm.get("status"))==null?null:y.touched)))}},dependencies:[I,z,se,te,A,O,T,P,N,ee,ie,ne]})}}return o})();var Xo=()=>[25,50,100],Jt=(o,p,t)=>({id:"divisionID",itemsPerPage:o,currentPage:p,totalItems:t});function er(o,p){if(o&1){let t=R();a(0,"div",22)(1,"div",26)(2,"pagination-controls",27),f("pageChange",function(e){S(t);let i=C();return E(i.onTablePageChange(e))}),r()()()}o&2&&(c(2),m("maxSize",10)("responsive",!0)("nextLabel","")("previousLabel",""))}function tr(o,p){if(o&1&&(a(0,"option",28),l(1),r()),o&2){let t=p.$implicit;m("value",t),c(),b(t)}}function ir(o,p){if(o&1&&(pe(0),u(1,"app-skeleton-loader",29),F(2,"paginate"),ue()),o&2){let t=C();c(),m("isLoading",t.isLoading)("columns",t.columns)("items",M(2,3,t.divisionListData,X(6,Jt,t.pagesize.limit,t.pagesize.offset,t.pagesize.count)))}}function nr(o,p){if(o&1&&(a(0,"th")(1,"span"),l(2),r()()),o&2){let t=p.$implicit;c(2),b(t==null?null:t.title)}}function or(o,p){o&1&&(a(0,"span",41),l(1,"Active"),r())}function rr(o,p){o&1&&(a(0,"span",42),l(1,"Inactive"),r())}function ar(o,p){if(o&1){let t=R();a(0,"tr")(1,"td"),l(2),r(),a(3,"td"),l(4),r(),a(5,"td"),l(6),r(),a(7,"td"),l(8),r(),a(9,"td"),l(10),r(),a(11,"td"),h(12,or,2,0,"span",35)(13,rr,2,0,"ng-template",null,2,J),r(),a(15,"td",36)(16,"button",37),f("click",function(){let e=S(t).$implicit,i=C(2);return E(i.onCreateDivision(e))}),u(17,"i",38),r(),a(18,"button",39),f("click",function(){let e=S(t).$implicit,i=C(2);return E(i.onDeleteZone(e))}),u(19,"i",40),r()()()}if(o&2){let t=p.$implicit,n=p.index,e=Y(14),i=C(2);c(2),b((i.pagesize.offset-1)*i.pagesize.limit+n+1),c(2),b(t==null?null:t.zone_name),c(2),b(t==null?null:t.circle_name),c(2),b(t==null?null:t.district_name),c(2),b(t==null?null:t.division_name),c(2),m("ngIf",t==null?null:t.is_active)("ngIfElse",e)}}function sr(o,p){o&1&&(a(0,"div",43),l(1," No division Available "),r())}function lr(o,p){if(o&1&&(a(0,"div",30)(1,"table",31,1)(3,"thead")(4,"tr",32),h(5,nr,3,1,"th",33),r()(),a(6,"tbody"),h(7,ar,20,7,"tr",33),F(8,"searchFilter"),F(9,"paginate"),r()(),h(10,sr,2,0,"div",34),F(11,"searchFilter"),r()),o&2){let t,n=C();c(5),m("ngForOf",n.columns),c(2),m("ngForOf",M(9,6,M(8,3,n.divisionListData,n.searchKeyword),X(12,Jt,n.pagesize.limit,n.pagesize.offset,n.pagesize.count))),c(3),m("ngIf",!(n.divisionListData!=null&&n.divisionListData.length)||!((t=M(11,9,n.divisionListData,n.searchKeyword))!=null&&t.length))}}var Qt=(()=>{class o{get startValue(){return this.pagesize.offset*this.pagesize.limit-(this.pagesize.limit-1)}get lastValue(){let t=this.startValue+this.pagesize.limit-1;return Math.min(t,this.pagesize.count)}constructor(t,n,e,i){this.modalService=t,this.divisionService=n,this.notificationSerivce=e,this.zone=i,this.breadcrumbs=[{label:"Home",path:"/admin/dashboard/home"},{label:"Master",path:"/admin/master/zone-master"},{label:"Division Master",path:"/admin/master/division-master"}],this.isLoading=!1,this.pagesize={limit:25,offset:1,count:0}}ngOnInit(){this.tableProperty(),this.setInitialtable(),this.getDivisionList(this.pagesize.offset,this.pagesize.limit)}setInitialtable(){this.columns=[{key:"S No.",title:"S No."},{key:"Zone Name",title:"Zone Name"},{key:"Circle Name",title:"Circle Name"},{key:"City Name",title:"City Name"},{key:"Division Name",title:"Division Name"},{key:"Status",title:"Status",width:"5%"},{key:"Action",title:"Action",width:"10%"}]}tableProperty(){this.configuration=Le({},De),this.configuration.checkboxes=!1,this.configuration.tableLayout.striped=!0,this.configuration.tableLayout.hover=!1,this.configuration.paginationRangeEnabled=!1,this.configuration.paginationEnabled=!1}getDivisionList(t,n){this.isLoading=!0;let e={pageNo:t,pageSize:n};this.divisionService.divisionList(e).subscribe(i=>{this.isLoading=!1,this.divisionListData=i?.body?.result||[],this.pagesize.count=i?.body?.totalRow},i=>{console.error("Error fetching division list",i),this.zone.run(()=>{this.isLoading=!1})})}onTablePageChange(t){this.pagesize.offset=t,this.getDivisionList(this.pagesize.offset,this.pagesize.limit)}onCreateDivision(t){let n={initialState:{editData:t||""}};this.bsModalRef=this.modalService.show(Yt,Object.assign(n,{class:"modal-md modal-dialog-centered alert-popup"})),this.bsModalRef?.content?.mapdata?.subscribe(e=>{this.pagesize.offset=1,this.pagesize.limit=25,this.getDivisionList(this.pagesize.offset,this.pagesize.limit)})}onDeleteZone(t){let n=this.divisionService.deleteDivision(t?.division_id),e={initialState:{title:t?.division_name,content:"Are you sure you want to delete?",primaryActionLabel:"Delete",secondaryActionLabel:"Cancel",service:n}};this.bsModalRef=this.modalService.show(be,Object.assign(e,{id:"confirmation",class:"modal-md modal-dialog-centered"})),this.bsModalRef?.content.mapdata.subscribe(i=>{i?.status==200?(this.notificationSerivce.successAlert(i?.body?.actionResponse),this.pagesize.offset=1,this.pagesize.limit=25,this.getDivisionList(this.pagesize.offset,this.pagesize.limit)):this.notificationSerivce.errorAlert(i?.title)})}onPageSizeChange(t){let n=parseInt(t.target.value,10);this.pagesize.limit=n,this.getDivisionList(this.pagesize.offset,this.pagesize.limit)}static{this.\u0275fac=function(n){return new(n||o)(_(k),_(ct),_(V),_(tt))}}static{this.\u0275cmp=D({type:o,selectors:[["division-list"]],decls:31,vars:10,consts:[["content",""],["TABLE",""],["inactive",""],[1,"card"],[1,"card-header"],[1,"header-part"],[1,"counting"],["class","row",4,"ngIf"],[1,"card-body"],[1,"header-container"],[1,"left-section"],[1,"search-form"],["placeholder","Search for...","type","text",1,"form-control","search-input",3,"ngModelChange","ngModel"],["type","button",1,"btn-search"],["aria-hidden","true",1,"fa","fa-search"],[1,"right-section","flex","gap-x-2"],[1,"flex","items-center","space-x-2"],["for","itemsPerPage",1,"text-sm","text-gray-700"],["id","itemsPerPage",1,"block","w-20","p-2","bg-white","border","border-gray-300","rounded","shadow-sm","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:border-blue-500","text-gray-700",3,"ngModelChange","change","ngModel"],[3,"value",4,"ngFor","ngForOf"],[1,"btn","btn-primary",3,"click"],["aria-hidden","true",1,"fa","fa-plus"],[1,"row"],[1,"col-md-12"],[1,"overflow-auto"],[4,"ngIf","ngIfElse"],[1,"d-flex","justify-content-center"],["id","divisionID",3,"pageChange","maxSize","responsive","nextLabel","previousLabel"],[3,"value"],[3,"isLoading","columns","items"],["id","datatable_wrapper"],["id","datatable","role","grid","aria-describedby","datatable_info","width","100%",1,"table","table-striped","nowrap","dataTable","no-footer","dtr-inline",2,"width","100%"],["role","row"],[4,"ngFor","ngForOf"],["class","text-center py-4 text-gray-500",4,"ngIf"],["class","text-green-600 font-medium",4,"ngIf","ngIfElse"],[1,"flex","space-x-2"],[1,"btn","btn-success",3,"click"],[1,"fa","fa-pencil"],[1,"btn","btn-danger",3,"click"],[1,"fa","fa-trash"],[1,"text-green-600","font-medium"],[1,"text-red-600","font-medium"],[1,"text-center","py-4","text-gray-500"]],template:function(n,e){if(n&1){let i=R();a(0,"div",3)(1,"div",4)(2,"div",5)(3,"span"),l(4,"Division Master"),r(),a(5,"div",6)(6,"span"),l(7),r()(),h(8,er,3,4,"div",7),r()(),a(9,"div",8)(10,"div",9)(11,"div",10)(12,"div",11)(13,"input",12),$("ngModelChange",function(d){return S(i),K(e.searchKeyword,d)||(e.searchKeyword=d),E(d)}),r(),a(14,"button",13),u(15,"i",14),r()()(),a(16,"div",15)(17,"div",16)(18,"label",17),l(19,"Items per page:"),r(),a(20,"select",18),$("ngModelChange",function(d){return S(i),K(e.pagesize.limit,d)||(e.pagesize.limit=d),E(d)}),f("change",function(d){return S(i),E(e.onPageSizeChange(d))}),h(21,tr,2,2,"option",19),r()(),a(22,"button",20),f("click",function(){return S(i),E(e.onCreateDivision(""))}),u(23,"i",21),l(24," Create Division "),r()()(),a(25,"div",22)(26,"div",23)(27,"div",24),h(28,ir,3,10,"ng-container",25)(29,lr,12,16,"ng-template",null,0,J),r()()()()()}if(n&2){let i=Y(30);c(7),he(" ",e.pagesize.count>0?e.startValue:0," - ",e.pagesize.count>0?e.lastValue:0," OF ",e.pagesize.count>0?e.pagesize.count:0," Division "),c(),m("ngIf",e.pagesize.count&&e.pagesize.count>0),c(5),H("ngModel",e.searchKeyword),c(7),H("ngModel",e.pagesize.limit),c(),m("ngForOf",me(9,Xo)),c(7),m("ngIf",e.isLoading)("ngIfElse",i)}},dependencies:[I,z,ve,A,O,T,P,N,ge,ye,_e,fe]})}}return o})();var Xt=(()=>{class o{static{this.\u0275fac=function(n){return new(n||o)}}static{this.\u0275cmp=D({type:o,selectors:[["app-manage-division-master"]],decls:2,vars:0,consts:[[1,"main-section"]],template:function(n,e){n&1&&(a(0,"div",0),u(1,"division-list"),r())},dependencies:[Qt]})}}return o})();function dr(o,p){o&1&&(a(0,"span",19),l(1," Name is Required "),r())}function mr(o,p){if(o&1&&(a(0,"option",20),l(1),r()),o&2){let t=p.$implicit;m("ngValue",t.id),c(),b(t.value)}}function pr(o,p){o&1&&(a(0,"span",21),l(1," Status is Required "),r())}var ti=(()=>{class o{constructor(t,n,e,i,s){this.bsModelService=t,this.fb=n,this.notificationSerivce=e,this.categoryService=i,this.commonService=s,this.mapdata=new W,this.status=[{id:1,value:"Active"},{id:0,value:"Inactive"}],this.label="Add"}ngOnInit(){this.setInitialValue()}setInitialValue(){this.editData?(this.label="Update",this.cateForm=this.fb.group({name:[this.editData?.category_name,[g.required]],status:[this.editData?.is_active,[g.required]]})):this.cateForm=this.fb.group({name:["",[g.required]],status:[1,[g.required]]})}submit(t){if(this.cateForm.invalid){this.cateForm.markAllAsTouched();return}let n=this.commonService.getUserDetails(),e={category_id:0,category_name:t?.name,is_active:t?.status,created_by:n?.user_id},i=this.categoryService.createCategory(e);this.editData&&(e.category_id=this.editData?.category_id,i=this.categoryService.updateCategory(e,this.editData?.category_id)),i.subscribe(s=>{s?.status==200?(this.bsModelService.hide(),this.mapdata.emit(),this.notificationSerivce.successAlert(s?.body?.actionResponse)):this.notificationSerivce.errorAlert(s?.title)})}close(){this.bsModelService.hide()}static{this.\u0275fac=function(n){return new(n||o)(_(k),_(oe),_(V),_(Ke),_(G))}}static{this.\u0275cmp=D({type:o,selectors:[["app-add-category"]],outputs:{mapdata:"mapdata"},decls:28,vars:5,consts:[[1,"modal-header","text-center"],[1,"close-modal",3,"click"],[1,"fa","fa-close",2,"cursor","pointer"],[1,"modal-body"],[3,"formGroup"],[1,"_card","white-bg"],[1,"row"],[1,"col-md-6","mb-2"],[1,"form-label"],[1,"input-group","mb-2"],["type","text","formControlName","name","placeholder","Enter Category Name","aria-describedby","button-addon2",1,"form-control"],["class","text-danger",4,"ngIf"],["formControlName","status",1,"form-control"],[3,"ngValue",4,"ngFor","ngForOf"],["class","text-danger mt-2",4,"ngIf"],[1,"footer"],[1,"button-container"],["type","submit",1,"btn","btn-success",3,"click"],["type","button",1,"btn","btn-danger",3,"click"],[1,"text-danger"],[3,"ngValue"],[1,"text-danger","mt-2"]],template:function(n,e){if(n&1&&(a(0,"div",0)(1,"h5"),l(2),r(),a(3,"div",1),f("click",function(){return e.close()}),u(4,"i",2),r()(),a(5,"div",3)(6,"div")(7,"form",4)(8,"div",5)(9,"div",6)(10,"div",7)(11,"label",8),l(12,"Category Name"),r(),a(13,"div",9),u(14,"input",10),r(),h(15,dr,2,0,"span",11),r(),a(16,"div",7)(17,"label",8),l(18,"Status"),r(),a(19,"select",12),h(20,mr,2,2,"option",13),r(),h(21,pr,2,0,"span",14),r()()(),a(22,"div",15)(23,"div",16)(24,"button",17),f("click",function(){return e.submit(e.cateForm.value)}),l(25,"Submit"),r(),a(26,"button",18),f("click",function(){return e.close()}),l(27,"Cancel"),r()()()()()()),n&2){let i,s;c(2),Q("",e.label," Category"),c(5),m("formGroup",e.cateForm),c(8),m("ngIf",(e.cateForm==null||(i=e.cateForm.get("name"))==null?null:i.invalid)&&((e.cateForm==null||(i=e.cateForm.get("name"))==null?null:i.dirty)||(e.cateForm==null||(i=e.cateForm.get("name"))==null?null:i.touched))),c(5),m("ngForOf",e.status),c(),m("ngIf",(e.cateForm==null||(s=e.cateForm.get("status"))==null?null:s.invalid)&&((e.cateForm==null||(s=e.cateForm.get("status"))==null?null:s.dirty)||(e.cateForm==null||(s=e.cateForm.get("status"))==null?null:s.touched)))}},dependencies:[I,z,te,A,O,T,P,N,ee,ie,ne]})}}return o})();var ur=["table"],hr=()=>[25,50,100],ii=(o,p,t)=>({id:"catID",itemsPerPage:o,currentPage:p,totalItems:t});function gr(o,p){if(o&1){let t=R();a(0,"div",22)(1,"div",26)(2,"pagination-controls",27),f("pageChange",function(e){S(t);let i=C();return E(i.onTablePageChange(e))}),r()()()}o&2&&(c(2),m("maxSize",10)("responsive",!0)("nextLabel","")("previousLabel",""))}function fr(o,p){if(o&1&&(a(0,"option",28),l(1),r()),o&2){let t=p.$implicit;m("value",t),c(),b(t)}}function _r(o,p){if(o&1&&(pe(0),u(1,"app-skeleton-loader",29),F(2,"paginate"),ue()),o&2){let t=C();c(),m("isLoading",t.isLoading)("columns",t.columns)("items",M(2,3,t.categoryList,X(6,ii,t.pagesize.limit,t.pagesize.offset,t.pagesize.count)))}}function vr(o,p){if(o&1&&(a(0,"th")(1,"span"),l(2),r()()),o&2){let t=p.$implicit;c(2),b(t==null?null:t.title)}}function yr(o,p){o&1&&(a(0,"span",41),l(1,"Active"),r())}function br(o,p){o&1&&(a(0,"span",42),l(1,"Inactive"),r())}function Cr(o,p){if(o&1){let t=R();a(0,"tr")(1,"td"),l(2),r(),a(3,"td"),l(4),r(),a(5,"td"),h(6,yr,2,0,"span",35)(7,br,2,0,"ng-template",null,2,J),r(),a(9,"td",36)(10,"button",37),f("click",function(){let e=S(t).$implicit,i=C(2);return E(i.onCreateCategory(e))}),u(11,"i",38),r(),a(12,"button",39),f("click",function(){let e=S(t).$implicit,i=C(2);return E(i.onDeletecategory(e))}),u(13,"i",40),r()()()}if(o&2){let t=p.$implicit,n=p.index,e=Y(8),i=C(2);c(2),b((i.pagesize.offset-1)*i.pagesize.limit+n+1),c(2),b(t==null?null:t.category_name),c(2),m("ngIf",t==null?null:t.is_active)("ngIfElse",e)}}function Lr(o,p){o&1&&(a(0,"div",43),l(1," No Category Available "),r())}function Sr(o,p){if(o&1&&(a(0,"div",30)(1,"table",31,1)(3,"thead")(4,"tr",32),h(5,vr,3,1,"th",33),r()(),a(6,"tbody"),h(7,Cr,14,4,"tr",33),F(8,"searchFilter"),F(9,"paginate"),r()(),h(10,Lr,2,0,"div",34),F(11,"searchFilter"),r()),o&2){let t,n=C();c(5),m("ngForOf",n.columns),c(2),m("ngForOf",M(9,6,M(8,3,n.categoryList,n.searchKeyword),X(12,ii,n.pagesize.limit,n.pagesize.offset,n.pagesize.count))),c(3),m("ngIf",!(n.categoryList!=null&&n.categoryList.length)||!((t=M(11,9,n.categoryList,n.searchKeyword))!=null&&t.length))}}var ni=(()=>{class o{get startValue(){return this.pagesize.offset*this.pagesize.limit-(this.pagesize.limit-1)}get lastValue(){let t=this.startValue+this.pagesize.limit-1;return Math.min(t,this.pagesize.count)}constructor(t,n,e,i){this.commonService=t,this.modalService=n,this.CategoryService=e,this.notificationSerivce=i,this.breadcrumbs=[{label:"Home",path:"/admin/dashboard/home"},{label:"Master",path:"/admin/master/zone-master"},{label:"Category Master",path:"/admin/master/category-master"}],this.isLoading=!1,this.pagesize={limit:25,offset:1,count:0}}ngOnInit(){this.tableProperty(),this.setInitialtable(),this.getCategoryList(this.pagesize.offset,this.pagesize.limit)}setInitialtable(){this.columns=[{key:"S No.",title:"S No.",width:"5%"},{key:"Category Name",title:"Category Name"},{key:"Status",title:"Status",width:"5%"},{key:"Action",title:"Action",width:"10%"}]}tableProperty(){this.configuration=Le({},De),this.configuration.checkboxes=!1,this.configuration.tableLayout.striped=!0,this.configuration.tableLayout.hover=!1,this.configuration.paginationRangeEnabled=!1,this.configuration.paginationEnabled=!1}getCategoryList(t,n){this.isLoading=!0;let e={pageNo:t,pageSize:n};this.CategoryService.categoryList(e).subscribe(i=>{setTimeout(()=>{this.isLoading=!1},600),this.categoryList=i?.body?.result||[],this.pagesize.count=i?.body?.totalRow},i=>{setTimeout(()=>{this.isLoading=!1},600),console.error("Error fetching zone list",i)})}onTablePageChange(t){this.pagesize.offset=t,this.getCategoryList(this.pagesize.offset,this.pagesize.limit)}onCreateCategory(t){let n={initialState:{editData:t||""}};this.bsModalRef=this.modalService.show(ti,Object.assign(n,{class:"modal-md modal-dialog-centered alert-popup"})),this.bsModalRef?.content?.mapdata?.subscribe(e=>{this.pagesize.offset=1,this.pagesize.limit=25,this.getCategoryList(this.pagesize.offset,this.pagesize.limit)})}onDeletecategory(t){let n=this.CategoryService.deleteCategory(t?.category_id),e={initialState:{title:t?.category_name,content:"Are you sure you want to delete?",primaryActionLabel:"Delete",secondaryActionLabel:"Cancel",service:n}};this.bsModalRef=this.modalService.show(be,Object.assign(e,{id:"confirmation",class:"modal-md modal-dialog-centered"})),this.bsModalRef?.content.mapdata.subscribe(i=>{i?.status==200?(this.notificationSerivce.successAlert(i?.body?.actionResponse),this.pagesize.offset=1,this.pagesize.limit=25,this.getCategoryList(this.pagesize.offset,this.pagesize.limit)):this.notificationSerivce.errorAlert(i?.title)})}onPageSizeChange(t){let n=parseInt(t.target.value,10);this.pagesize.limit=n,this.getCategoryList(this.pagesize.offset,this.pagesize.limit)}static{this.\u0275fac=function(n){return new(n||o)(_(G),_(k),_(Ke),_(V))}}static{this.\u0275cmp=D({type:o,selectors:[["category-list"]],viewQuery:function(n,e){if(n&1&&Ve(ur,7),n&2){let i;Te(i=Ne())&&(e.table=i.first)}},decls:31,vars:10,consts:[["content",""],["TABLE",""],["inactive",""],[1,"card"],[1,"card-header"],[1,"header-part"],[1,"counting"],["class","row",4,"ngIf"],[1,"card-body"],[1,"header-container"],[1,"left-section"],[1,"search-form"],["placeholder","Search for...","type","text",1,"form-control","search-input",3,"ngModelChange","ngModel"],["type","button",1,"btn-search"],["aria-hidden","true",1,"fa","fa-search"],[1,"right-section","flex","gap-x-2"],[1,"flex","items-center","space-x-2"],["for","itemsPerPage",1,"text-sm","text-gray-700"],["id","itemsPerPage",1,"block","w-20","p-2","bg-white","border","border-gray-300","rounded","shadow-sm","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:border-blue-500","text-gray-700",3,"ngModelChange","change","ngModel"],[3,"value",4,"ngFor","ngForOf"],[1,"btn","btn-primary",3,"click"],["aria-hidden","true",1,"fa","fa-plus"],[1,"row"],[1,"col-md-12"],[1,"overflow-auto"],[4,"ngIf","ngIfElse"],[1,"d-flex","justify-content-center"],["id","catID",3,"pageChange","maxSize","responsive","nextLabel","previousLabel"],[3,"value"],[3,"isLoading","columns","items"],["id","datatable_wrapper"],["id","datatable","role","grid","aria-describedby","datatable_info","width","100%",1,"table","table-striped","nowrap","dataTable","no-footer","dtr-inline",2,"width","100%"],["role","row"],[4,"ngFor","ngForOf"],["class","text-center py-4 text-gray-500",4,"ngIf"],["class","text-green-600 font-medium",4,"ngIf","ngIfElse"],[1,"flex","space-x-2"],[1,"btn","btn-success",3,"click"],[1,"fa","fa-pencil"],[1,"btn","btn-danger",3,"click"],[1,"fa","fa-trash"],[1,"text-green-600","font-medium"],[1,"text-red-600","font-medium"],[1,"text-center","py-4","text-gray-500"]],template:function(n,e){if(n&1){let i=R();a(0,"div",3)(1,"div",4)(2,"div",5)(3,"span"),l(4,"Category Master"),r(),a(5,"div",6)(6,"span"),l(7),r()(),h(8,gr,3,4,"div",7),r()(),a(9,"div",8)(10,"div",9)(11,"div",10)(12,"div",11)(13,"input",12),$("ngModelChange",function(d){return S(i),K(e.searchKeyword,d)||(e.searchKeyword=d),E(d)}),r(),a(14,"button",13),u(15,"i",14),r()()(),a(16,"div",15)(17,"div",16)(18,"label",17),l(19,"Items per page:"),r(),a(20,"select",18),$("ngModelChange",function(d){return S(i),K(e.pagesize.limit,d)||(e.pagesize.limit=d),E(d)}),f("change",function(d){return S(i),E(e.onPageSizeChange(d))}),h(21,fr,2,2,"option",19),r()(),a(22,"button",20),f("click",function(){return S(i),E(e.onCreateCategory(""))}),u(23,"i",21),l(24," Create Category "),r()()(),a(25,"div",22)(26,"div",23)(27,"div",24),h(28,_r,3,10,"ng-container",25)(29,Sr,12,16,"ng-template",null,0,J),r()()()()()}if(n&2){let i=Y(30);c(7),he(" ",e.pagesize.count>0?e.startValue:0," - ",e.pagesize.count>0?e.lastValue:0," OF ",e.pagesize.count>0?e.pagesize.count:0," Category "),c(),m("ngIf",e.pagesize.count&&e.pagesize.count>0),c(5),H("ngModel",e.searchKeyword),c(7),H("ngModel",e.pagesize.limit),c(),m("ngForOf",me(9,hr)),c(7),m("ngIf",e.isLoading)("ngIfElse",i)}},dependencies:[I,z,ve,A,O,T,P,N,ge,ye,_e,fe]})}}return o})();var oi=(()=>{class o{static{this.\u0275fac=function(n){return new(n||o)}}static{this.\u0275cmp=D({type:o,selectors:[["app-manage-category"]],decls:2,vars:0,consts:[[1,"main-section"]],template:function(n,e){n&1&&(a(0,"div",0),u(1,"category-list"),r())},dependencies:[ni]})}}return o})();var dt=(()=>{class o{constructor(t){this.apiService=t}subcategoryList(t){let n=q.SubCategory.replace("{pageNo}",t.pageNo).replace("{pageSize}",t?.pageSize);return this.apiService.get(n).pipe(B(e=>U(e)))}formCodeList(){let t=q.formCodeList;return this.apiService.get(t).pipe(B(n=>U(n)))}createsubCategory(t){let n=q.addSubcategory;return this.apiService.post(n,t).pipe(B(e=>U(e)))}getsubCatById(t){let n=q.updateDelgetSubCat.replace("{id}",t);return this.apiService.get(n).pipe(B(e=>U(e)))}updateSubCategory(t,n){let e=q.updateDelgetSubCat.replace("{id}",n);return this.apiService.put(e,t).pipe(B(i=>U(i)))}deleteSubCategory(t){let n=q.updateDelgetSubCat.replace("{id}",t);return this.apiService.delete(n).pipe(B(e=>U(e)))}static{this.\u0275fac=function(n){return new(n||o)(Ee(we))}}static{this.\u0275prov=Ce({token:o,factory:o.\u0275fac,providedIn:"root"})}}return o})();function wr(o,p){o&1&&(a(0,"span",21),l(1," Category is Required "),r())}function Dr(o,p){o&1&&(a(0,"span",22),l(1," Subcategory Name is Required "),r())}function xr(o,p){o&1&&(a(0,"span",22),l(1," Form Code is Required "),r())}function kr(o,p){if(o&1&&(a(0,"option",23),l(1),r()),o&2){let t=p.$implicit;m("ngValue",t.id),c(),b(t.value)}}function Fr(o,p){o&1&&(a(0,"span",21),l(1," Status is Required "),r())}var ai=(()=>{class o{constructor(t,n,e,i,s,d){this.bsModelService=t,this.fb=n,this.CategoryService=e,this.SubcategoryService=i,this.notificationSerivce=s,this.commonService=d,this.mapdata=new W,this.config={displayKey:"category_name",search:!0,height:"300px"},this.config1={displayKey:"text",search:!0,height:"300px"},this.label="Create",this.status=[{id:1,value:"Active"},{id:0,value:"Inactive"}]}ngOnInit(){this.setInintivalue()}getCateGory(){let t={pageNo:1,pageSize:5e3};this.CategoryService.categoryList(t).subscribe(n=>{if(this.categoryList=n?.body?.result,this.editData){let e=this.categoryList.find(i=>i?.category_id==this.selectedSub?.category_id);this.subcateForm.controls.catId.setValue(e)}})}setInintivalue(){this.subcateForm=this.fb.group({catId:[null,[g.required]],subcateName:["",[g.required]],formCode:["",[g.required]],status:[1,[g.required]]}),this.editData?(this.label="Update",this.getSubBasedOnId(this.editData?.sub_category_id)):(this.getCateGory(),this.getFormCodeList())}getSubBasedOnId(t){this.SubcategoryService.getsubCatById(t).subscribe(n=>{this.selectedSub=n?.body?.result,this.subcateForm.patchValue({subcateName:this.selectedSub?.sub_category_name,status:this.editData?.is_active}),this.getCateGory(),this.getFormCodeList()})}getFormCodeList(){this.SubcategoryService.formCodeList().subscribe(t=>{if(this.formCodeList=t?.body?.result,console.log(this.formCodeList),this.selectedSub){let n=this.formCodeList?.find(e=>e?.value==this.selectedSub?.form_code);this.subcateForm.controls.formCode.setValue(n)}})}submit(t){if(this.subcateForm.invalid){this.subcateForm.markAllAsTouched();return}let n=this.commonService.getUserDetails(),e={sub_category_id:0,sub_category_name:t?.subcateName,category_id:t?.catId?.category_id,category_name:t?.catId?.category_name,form_code:t?.formCode?Number(t?.formCode?.value):null,form_code_text:t?.formCode?t?.formCode?.text:null,is_active:t?.status,created_by:n?.user_id},i=this.SubcategoryService.createsubCategory(e);this.editData&&(e.sub_category_id=this.editData?.sub_category_id,i=this.SubcategoryService.updateSubCategory(e,this.editData?.sub_category_id)),i.subscribe(s=>{s?.status==200?(this.bsModelService.hide(),this.mapdata.emit(),this.notificationSerivce.successAlert(s?.body?.actionResponse)):this.notificationSerivce.errorAlert(s?.title)})}close(){this.bsModelService.hide()}static{this.\u0275fac=function(n){return new(n||o)(_(k),_(oe),_(Ke),_(dt),_(V),_(G))}}static{this.\u0275cmp=D({type:o,selectors:[["app-create-subcategory"]],outputs:{mapdata:"mapdata"},decls:38,vars:11,consts:[[1,"modal-header","text-center"],[1,"close-modal",3,"click"],[1,"fa","fa-close",2,"cursor","pointer"],[1,"modal-body"],[3,"formGroup"],[1,"_card","white-bg"],[1,"row"],[1,"col-md-6","mb-2"],[1,"form-label"],["formControlName","catId",3,"config","options"],["class","text-danger mt-2",4,"ngIf"],[1,"input-group","mb-2"],["type","text","formControlName","subcateName","placeholder","Enter Subcategory Name","aria-describedby","button-addon2",1,"form-control"],["class","text-danger",4,"ngIf"],["formControlName","formCode",3,"config","options"],["formControlName","status",1,"form-control"],[3,"ngValue",4,"ngFor","ngForOf"],[1,"footer"],[1,"button-container"],["type","submit",1,"btn","btn-success",3,"click"],["type","button",1,"btn","btn-danger",3,"click"],[1,"text-danger","mt-2"],[1,"text-danger"],[3,"ngValue"]],template:function(n,e){if(n&1&&(a(0,"div",0)(1,"h5"),l(2),r(),a(3,"div",1),f("click",function(){return e.close()}),u(4,"i",2),r()(),a(5,"div",3)(6,"div")(7,"form",4)(8,"div",5)(9,"div",6)(10,"div",7)(11,"label",8),l(12,"Category"),r(),u(13,"ngx-select-dropdown",9),h(14,wr,2,0,"span",10),r(),a(15,"div",7)(16,"label",8),l(17,"Subcategory Name"),r(),a(18,"div",11),u(19,"input",12),r(),h(20,Dr,2,0,"span",13),r(),a(21,"div",7)(22,"label",8),l(23,"Form Code"),r(),u(24,"ngx-select-dropdown",14),h(25,xr,2,0,"span",13),r(),a(26,"div",7)(27,"label",8),l(28,"Status"),r(),a(29,"select",15),h(30,kr,2,2,"option",16),r(),h(31,Fr,2,0,"span",10),r()()(),a(32,"div",17)(33,"div",18)(34,"button",19),f("click",function(){return e.submit(e.subcateForm.value)}),l(35,"Submit"),r(),a(36,"button",20),f("click",function(){return e.close()}),l(37,"Cancel"),r()()()()()()),n&2){let i,s,d,v;c(2),Q("",e.label," Subcategory"),c(5),m("formGroup",e.subcateForm),c(6),m("config",e.config)("options",e.categoryList),c(),m("ngIf",(e.subcateForm==null||(i=e.subcateForm.get("catId"))==null?null:i.invalid)&&((e.subcateForm==null||(i=e.subcateForm.get("catId"))==null?null:i.dirty)||(e.subcateForm==null||(i=e.subcateForm.get("catId"))==null?null:i.touched))),c(6),m("ngIf",(e.subcateForm==null||(s=e.subcateForm.get("subcateName"))==null?null:s.invalid)&&((e.subcateForm==null||(s=e.subcateForm.get("subcateName"))==null?null:s.dirty)||(e.subcateForm==null||(s=e.subcateForm.get("subcateName"))==null?null:s.touched))),c(4),m("config",e.config1)("options",e.formCodeList),c(),m("ngIf",(e.subcateForm==null||(d=e.subcateForm.get("formCode"))==null?null:d.invalid)&&((e.subcateForm==null||(d=e.subcateForm.get("formCode"))==null?null:d.dirty)||(e.subcateForm==null||(d=e.subcateForm.get("formCode"))==null?null:d.touched))),c(5),m("ngForOf",e.status),c(),m("ngIf",(e.subcateForm==null||(v=e.subcateForm.get("status"))==null?null:v.invalid)&&((e.subcateForm==null||(v=e.subcateForm.get("status"))==null?null:v.dirty)||(e.subcateForm==null||(v=e.subcateForm.get("status"))==null?null:v.touched)))}},dependencies:[I,z,se,te,A,O,T,P,N,ee,ie,ne]})}}return o})();var Mr=()=>[25,50,100],si=(o,p,t)=>({id:"subcatID",itemsPerPage:o,currentPage:p,totalItems:t});function Ir(o,p){if(o&1){let t=R();a(0,"div",22)(1,"div",26)(2,"pagination-controls",27),f("pageChange",function(e){S(t);let i=C();return E(i.onTablePageChange(e))}),r()()()}o&2&&(c(2),m("maxSize",10)("responsive",!0)("nextLabel","")("previousLabel",""))}function zr(o,p){if(o&1&&(a(0,"option",28),l(1),r()),o&2){let t=p.$implicit;m("value",t),c(),b(t)}}function Vr(o,p){if(o&1&&(pe(0),u(1,"app-skeleton-loader",29),F(2,"paginate"),ue()),o&2){let t=C();c(),m("isLoading",t.isLoading)("columns",t.columns)("items",M(2,3,t.categoryList,X(6,si,t.pagesize.limit,t.pagesize.offset,t.pagesize.count)))}}function Tr(o,p){if(o&1&&(a(0,"th")(1,"span"),l(2),r()()),o&2){let t=p.$implicit;c(2),b(t==null?null:t.title)}}function Nr(o,p){o&1&&(a(0,"span",41),l(1,"Active"),r())}function Pr(o,p){o&1&&(a(0,"span",42),l(1,"Inactive"),r())}function Ar(o,p){if(o&1){let t=R();a(0,"tr")(1,"td"),l(2),r(),a(3,"td"),l(4),r(),a(5,"td"),l(6),r(),a(7,"td"),l(8),r(),a(9,"td"),h(10,Nr,2,0,"span",35)(11,Pr,2,0,"ng-template",null,2,J),r(),a(13,"td",36)(14,"button",37),f("click",function(){let e=S(t).$implicit,i=C(2);return E(i.onCreateCate(e))}),u(15,"i",38),r(),a(16,"button",39),f("click",function(){let e=S(t).$implicit,i=C(2);return E(i.onDeletesub(e))}),u(17,"i",40),r()()()}if(o&2){let t=p.$implicit,n=p.index,e=Y(12),i=C(2);c(2),b((i.pagesize.offset-1)*i.pagesize.limit+n+1),c(2),b(t==null?null:t.category_name),c(2),b(t==null?null:t.sub_category_name),c(2),b(t==null?null:t.form_code_text),c(2),m("ngIf",t==null?null:t.is_active)("ngIfElse",e)}}function Or(o,p){o&1&&(a(0,"div",43),l(1," No Subcategory Available "),r())}function Rr(o,p){if(o&1&&(a(0,"div",30)(1,"table",31,1)(3,"thead")(4,"tr",32),h(5,Tr,3,1,"th",33),r()(),a(6,"tbody"),h(7,Ar,18,6,"tr",33),F(8,"searchFilter"),F(9,"paginate"),r()(),h(10,Or,2,0,"div",34),F(11,"searchFilter"),r()),o&2){let t,n=C();c(5),m("ngForOf",n.columns),c(2),m("ngForOf",M(9,6,M(8,3,n.categoryList,n.searchKeyword),X(12,si,n.pagesize.limit,n.pagesize.offset,n.pagesize.count))),c(3),m("ngIf",!(n.categoryList!=null&&n.categoryList.length)||!((t=M(11,9,n.categoryList,n.searchKeyword))!=null&&t.length))}}var li=(()=>{class o{get startValue(){return this.pagesize.offset*this.pagesize.limit-(this.pagesize.limit-1)}get lastValue(){let t=this.startValue+this.pagesize.limit-1;return Math.min(t,this.pagesize.count)}constructor(t,n,e,i){this.modalService=t,this.subcategoryService=n,this.notificationSerivce=e,this.zone=i,this.breadcrumbs=[{label:"Home",path:"/admin/dashboard/home"},{label:"Master",path:"/admin/master/zone-master"},{label:"Subcategory Master",path:"/admin/master/subcategory-master"}],this.isLoading=!1,this.pagesize={limit:25,offset:1,count:0}}ngOnInit(){this.tableProperty(),this.setInitialtable(),this.getSubategoryList(this.pagesize.offset,this.pagesize.limit)}setInitialtable(){this.columns=[{key:"S No.",title:"S No.",width:"5%"},{key:"Category Name",title:"Category Name"},{key:"Category Name",title:"Subcategory Name"},{key:"Form Code",title:"Form Code"},{key:"Status",title:"Status",width:"5%"},{key:"Action",title:"Action",width:"10%"}]}tableProperty(){this.configuration=Le({},De),this.configuration.checkboxes=!1,this.configuration.tableLayout.striped=!0,this.configuration.tableLayout.hover=!1,this.configuration.paginationRangeEnabled=!1,this.configuration.paginationEnabled=!1}getSubategoryList(t,n){this.isLoading=!0;let e={pageNo:t,pageSize:n};this.subcategoryService.subcategoryList(e).subscribe(i=>{this.isLoading=!1,this.categoryList=i?.body?.result||[],this.pagesize.count=i?.body?.totalRow},i=>{console.error("Error fetching division list",i),this.zone.run(()=>{this.isLoading=!1})})}onTablePageChange(t){this.pagesize.offset=t,this.getSubategoryList(this.pagesize.offset,this.pagesize.limit)}paginationEvent(t){this.pagesize=wt(Le({},this.pagesize),{limit:t.pageSize,offset:t.pageIndex+1}),this.getSubategoryList(this.pagesize.offset,this.pagesize.limit)}onCreateCate(t){let n={initialState:{editData:t||""}};this.bsModalRef=this.modalService.show(ai,Object.assign(n,{class:"modal-md modal-dialog-centered alert-popup"})),this.bsModalRef?.content?.mapdata?.subscribe(e=>{this.pagesize.offset=1,this.pagesize.limit=25,this.getSubategoryList(this.pagesize.offset,this.pagesize.limit)})}onDeletesub(t){let n=this.subcategoryService.deleteSubCategory(t?.sub_category_id),e={initialState:{title:t?.sub_category_name,content:"Are you sure you want to delete?",primaryActionLabel:"Delete",secondaryActionLabel:"Cancel",service:n}};this.bsModalRef=this.modalService.show(be,Object.assign(e,{id:"confirmation",class:"modal-md modal-dialog-centered"})),this.bsModalRef?.content.mapdata.subscribe(i=>{i?.status==200?(this.notificationSerivce.successAlert(i?.body?.actionResponse),this.pagesize.offset=1,this.pagesize.limit=25,this.getSubategoryList(this.pagesize.offset,this.pagesize.limit)):this.notificationSerivce.errorAlert(i?.title)})}onPageSizeChange(t){let n=parseInt(t.target.value,10);this.pagesize.limit=n,this.getSubategoryList(this.pagesize.offset,this.pagesize.limit)}static{this.\u0275fac=function(n){return new(n||o)(_(k),_(dt),_(V),_(tt))}}static{this.\u0275cmp=D({type:o,selectors:[["subcategory-list"]],decls:31,vars:10,consts:[["content",""],["TABLE",""],["inactive",""],[1,"card"],[1,"card-header"],[1,"header-part"],[1,"counting"],["class","row",4,"ngIf"],[1,"card-body"],[1,"header-container"],[1,"left-section"],[1,"search-form"],["placeholder","Search for...","type","text",1,"form-control","search-input",3,"ngModelChange","ngModel"],["type","button",1,"btn-search"],["aria-hidden","true",1,"fa","fa-search"],[1,"right-section","flex","gap-x-2"],[1,"flex","items-center","space-x-2"],["for","itemsPerPage",1,"text-sm","text-gray-700"],["id","itemsPerPage",1,"block","w-20","p-2","bg-white","border","border-gray-300","rounded","shadow-sm","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:border-blue-500","text-gray-700",3,"ngModelChange","change","ngModel"],[3,"value",4,"ngFor","ngForOf"],[1,"btn","btn-primary",3,"click"],["aria-hidden","true",1,"fa","fa-plus"],[1,"row"],[1,"col-md-12"],[1,"overflow-auto"],[4,"ngIf","ngIfElse"],[1,"d-flex","justify-content-center"],["id","subcatID",3,"pageChange","maxSize","responsive","nextLabel","previousLabel"],[3,"value"],[3,"isLoading","columns","items"],["id","datatable_wrapper"],["id","datatable","role","grid","aria-describedby","datatable_info","width","100%",1,"table","table-striped","nowrap","dataTable","no-footer","dtr-inline",2,"width","100%"],["role","row"],[4,"ngFor","ngForOf"],["class","text-center py-4 text-gray-500",4,"ngIf"],["class","text-green-600 font-medium",4,"ngIf","ngIfElse"],[1,"flex","space-x-2"],[1,"btn","btn-success",3,"click"],[1,"fa","fa-pencil"],[1,"btn","btn-danger",3,"click"],[1,"fa","fa-trash"],[1,"text-green-600","font-medium"],[1,"text-red-600","font-medium"],[1,"text-center","py-4","text-gray-500"]],template:function(n,e){if(n&1){let i=R();a(0,"div",3)(1,"div",4)(2,"div",5)(3,"span"),l(4,"Subcategory Master"),r(),a(5,"div",6)(6,"span"),l(7),r()(),h(8,Ir,3,4,"div",7),r()(),a(9,"div",8)(10,"div",9)(11,"div",10)(12,"div",11)(13,"input",12),$("ngModelChange",function(d){return S(i),K(e.searchKeyword,d)||(e.searchKeyword=d),E(d)}),r(),a(14,"button",13),u(15,"i",14),r()()(),a(16,"div",15)(17,"div",16)(18,"label",17),l(19,"Items per page:"),r(),a(20,"select",18),$("ngModelChange",function(d){return S(i),K(e.pagesize.limit,d)||(e.pagesize.limit=d),E(d)}),f("change",function(d){return S(i),E(e.onPageSizeChange(d))}),h(21,zr,2,2,"option",19),r()(),a(22,"button",20),f("click",function(){return S(i),E(e.onCreateCate(""))}),u(23,"i",21),l(24," Create Subcategory "),r()()(),a(25,"div",22)(26,"div",23)(27,"div",24),h(28,Vr,3,10,"ng-container",25)(29,Rr,12,16,"ng-template",null,0,J),r()()()()()}if(n&2){let i=Y(30);c(7),he(" ",e.pagesize.count>0?e.startValue:0," - ",e.pagesize.count>0?e.lastValue:0," OF ",e.pagesize.count>0?e.pagesize.count:0," Subcategory "),c(),m("ngIf",e.pagesize.count&&e.pagesize.count>0),c(5),H("ngModel",e.searchKeyword),c(7),H("ngModel",e.pagesize.limit),c(),m("ngForOf",me(9,Mr)),c(7),m("ngIf",e.isLoading)("ngIfElse",i)}},dependencies:[I,z,ve,A,O,T,P,N,ge,ye,_e,fe]})}}return o})();var ci=(()=>{class o{static{this.\u0275fac=function(n){return new(n||o)}}static{this.\u0275cmp=D({type:o,selectors:[["app-manage-subcategory"]],decls:2,vars:0,consts:[[1,"main-section"]],template:function(n,e){n&1&&(a(0,"div",0),u(1,"subcategory-list"),r())},dependencies:[li]})}}return o})();var mt=(()=>{class o{constructor(t){this.apiService=t}departmentList(t){let n=q.departmentData.replace("{pageNo}",t.pageNo).replace("{pageSize}",t?.pageSize);return this.apiService.get(n).pipe(B(e=>U(e)))}createDepartment(t){let n=q.createDepartment;return this.apiService.post(n,t).pipe(B(e=>U(e)))}getdepartmentById(t){let n=q.getUpdateDeleteDepartment.replace("{id}",t);return this.apiService.get(n).pipe(B(e=>U(e)))}updatedepartment(t,n){let e=q.getUpdateDeleteDepartment.replace("{id}",n);return this.apiService.put(e,t).pipe(B(i=>U(i)))}deletedepartment(t){let n=q.getUpdateDeleteDepartment.replace("{id}",t);return this.apiService.delete(n).pipe(B(e=>U(e)))}static{this.\u0275fac=function(n){return new(n||o)(Ee(we))}}static{this.\u0275prov=Ce({token:o,factory:o.\u0275fac,providedIn:"root"})}}return o})();function Br(o,p){o&1&&(a(0,"span",20),l(1," Department is Required "),r())}function qr(o,p){if(o&1&&(a(0,"option",21),l(1),r()),o&2){let t=p.$implicit;m("ngValue",t.id),c(),b(t.value)}}function jr(o,p){o&1&&(a(0,"span",22),l(1," Status is Required "),r())}var mi=(()=>{class o{constructor(t,n,e,i,s){this.commonService=t,this.fb=n,this.departmentService=e,this.notificationSerivce=i,this.bsModelService=s,this.mapdata=new W,this.config={displayKey:"text",search:!0,height:"300px"},this.stateList=[],this.status=[{id:1,value:"Active"},{id:0,value:"Inactive"}],this.label="Create"}ngOnInit(){this.setInitialvalue()}setInitialvalue(){this.editData?(this.label="Update",this.departmentForm=this.fb.group({name:[this.editData?.department_name,[g.required]],status:[this.editData?.is_active,[g.required]],remark:[this.editData?.department_desc]})):this.departmentForm=this.fb.group({name:["",[g.required]],status:[1,[g.required]],remark:[""]})}submit(t){if(this.departmentForm.invalid){this.departmentForm.markAllAsTouched();return}let n=this.commonService.getUserDetails(),e={department_id:0,department_name:t?.name,department_desc:t?.remark,is_active:t?.status,created_by:n?.user_id},i=this.departmentService.createDepartment(e);this.editData?.department_id&&(e.department_id=this.editData?.department_id,i=this.departmentService.updatedepartment(e,this.editData?.department_id)),i.subscribe(s=>{s?.status==200?(this.bsModelService.hide(),this.mapdata.emit(),this.notificationSerivce.successAlert(s?.body?.actionResponse)):this.notificationSerivce.errorAlert(s?.title)})}close(){this.bsModelService.hide()}static{this.\u0275fac=function(n){return new(n||o)(_(G),_(oe),_(mt),_(V),_(k))}}static{this.\u0275cmp=D({type:o,selectors:[["app-create-department"]],outputs:{mapdata:"mapdata"},decls:33,vars:5,consts:[[1,"modal-header","text-center"],[1,"close-modal",3,"click"],[1,"fa","fa-close",2,"cursor","pointer"],[1,"modal-body"],[3,"formGroup"],[1,"_card","white-bg"],[1,"row"],[1,"col-md-6","mb-2"],[1,"form-label"],[1,"input-group","mb-2"],["type","text","formControlName","name","placeholder","Enter Department Name","aria-describedby","button-addon2",1,"form-control"],["class","text-danger",4,"ngIf"],["formControlName","status",1,"form-control"],[3,"ngValue",4,"ngFor","ngForOf"],["class","text-danger mt-2",4,"ngIf"],["type","text","formControlName","remark","placeholder","Enter Remark","aria-describedby","button-addon2",1,"form-control"],[1,"footer"],[1,"button-container"],["type","submit",1,"btn","btn-success",3,"click"],["type","button",1,"btn","btn-danger",3,"click"],[1,"text-danger"],[3,"ngValue"],[1,"text-danger","mt-2"]],template:function(n,e){if(n&1&&(a(0,"div",0)(1,"h5"),l(2),r(),a(3,"div",1),f("click",function(){return e.close()}),u(4,"i",2),r()(),a(5,"div",3)(6,"div")(7,"form",4)(8,"div",5)(9,"div",6)(10,"div",7)(11,"label",8),l(12,"Department Name"),r(),a(13,"div",9),u(14,"input",10),r(),h(15,Br,2,0,"span",11),r(),a(16,"div",7)(17,"label",8),l(18,"Status"),r(),a(19,"select",12),h(20,qr,2,2,"option",13),r(),h(21,jr,2,0,"span",14),r(),a(22,"div",7)(23,"label",8),l(24,"Remark"),r(),a(25,"div",9),u(26,"input",15),r()()()(),a(27,"div",16)(28,"div",17)(29,"button",18),f("click",function(){return e.submit(e.departmentForm.value)}),l(30,"Submit"),r(),a(31,"button",19),f("click",function(){return e.close()}),l(32,"Cancel"),r()()()()()()),n&2){let i,s;c(2),Q("",e.label," Department"),c(5),m("formGroup",e.departmentForm),c(8),m("ngIf",(e.departmentForm==null||(i=e.departmentForm.get("name"))==null?null:i.invalid)&&((e.departmentForm==null||(i=e.departmentForm.get("name"))==null?null:i.dirty)||(e.departmentForm==null||(i=e.departmentForm.get("name"))==null?null:i.touched))),c(5),m("ngForOf",e.status),c(),m("ngIf",(e.departmentForm==null||(s=e.departmentForm.get("status"))==null?null:s.invalid)&&((e.departmentForm==null||(s=e.departmentForm.get("status"))==null?null:s.dirty)||(e.departmentForm==null||(s=e.departmentForm.get("status"))==null?null:s.touched)))}},dependencies:[I,z,te,A,O,T,P,N,ee,ie,ne]})}}return o})();var Gr=["table"],Wr=()=>[25,50,100],pi=(o,p,t)=>({id:"deptID",itemsPerPage:o,currentPage:p,totalItems:t});function Zr(o,p){if(o&1){let t=R();a(0,"div",22)(1,"div",26)(2,"pagination-controls",27),f("pageChange",function(e){S(t);let i=C();return E(i.onTablePageChange(e))}),r()()()}o&2&&(c(2),m("maxSize",10)("responsive",!0)("nextLabel","")("previousLabel",""))}function Hr(o,p){if(o&1&&(a(0,"option",28),l(1),r()),o&2){let t=p.$implicit;m("value",t),c(),b(t)}}function Kr(o,p){if(o&1&&(pe(0),u(1,"app-skeleton-loader",29),F(2,"paginate"),ue()),o&2){let t=C();c(),m("isLoading",t.isLoading)("columns",t.columns)("items",M(2,3,t.departmentList,X(6,pi,t.pagesize.limit,t.pagesize.offset,t.pagesize.count)))}}function $r(o,p){if(o&1&&(a(0,"th")(1,"span"),l(2),r()()),o&2){let t=p.$implicit;c(2),b(t==null?null:t.title)}}function Yr(o,p){o&1&&(a(0,"span",41),l(1,"Active"),r())}function Jr(o,p){o&1&&(a(0,"span",42),l(1,"Inactive"),r())}function Qr(o,p){if(o&1){let t=R();a(0,"tr")(1,"td"),l(2),r(),a(3,"td"),l(4),r(),a(5,"td"),l(6),r(),a(7,"td"),h(8,Yr,2,0,"span",35)(9,Jr,2,0,"ng-template",null,2,J),r(),a(11,"td",36)(12,"button",37),f("click",function(){let e=S(t).$implicit,i=C(2);return E(i.onCreateDepartment(e))}),u(13,"i",38),r(),a(14,"button",39),f("click",function(){let e=S(t).$implicit,i=C(2);return E(i.onDeleteDepartment(e))}),u(15,"i",40),r()()()}if(o&2){let t=p.$implicit,n=p.index,e=Y(10),i=C(2);c(2),b((i.pagesize.offset-1)*i.pagesize.limit+n+1),c(2),b(t==null?null:t.department_name),c(2),b(t==null?null:t.department_desc),c(2),m("ngIf",t==null?null:t.is_active)("ngIfElse",e)}}function Xr(o,p){o&1&&(a(0,"div",43),l(1," No Department Available "),r())}function ea(o,p){if(o&1&&(a(0,"div",30)(1,"table",31,1)(3,"thead")(4,"tr",32),h(5,$r,3,1,"th",33),r()(),a(6,"tbody"),h(7,Qr,16,5,"tr",33),F(8,"searchFilter"),F(9,"paginate"),r()(),h(10,Xr,2,0,"div",34),F(11,"searchFilter"),r()),o&2){let t,n=C();c(5),m("ngForOf",n.columns),c(2),m("ngForOf",M(9,6,M(8,3,n.departmentList,n.searchKeyword),X(12,pi,n.pagesize.limit,n.pagesize.offset,n.pagesize.count))),c(3),m("ngIf",!(n.departmentList!=null&&n.departmentList.length)||!((t=M(11,9,n.departmentList,n.searchKeyword))!=null&&t.length))}}var ui=(()=>{class o{get startValue(){return this.pagesize.offset*this.pagesize.limit-(this.pagesize.limit-1)}get lastValue(){let t=this.startValue+this.pagesize.limit-1;return Math.min(t,this.pagesize.count)}constructor(t,n,e){this.modalService=t,this.departmentService=n,this.notificationSerivce=e,this.departmentList=[],this.breadcrumbs=[{label:"Home",path:"/admin/dashboard/home"},{label:"Master",path:"/admin/master/zone-master"},{label:"Deparment Master",path:"/admin/master/department-master"}],this.isLoading=!1,this.pagesize={limit:25,offset:1,count:0}}ngOnInit(){this.tableProperty(),this.setInitialtable(),this.getDepartmentList(this.pagesize.offset,this.pagesize.limit)}setInitialtable(){this.columns=[{key:"S No.",title:"S No.",width:"5%"},{key:"Department Name",title:"Department Name"},{key:"Description",title:"Description"},{key:"Status",title:"Status",width:"5%"},{key:"Action",title:"Action",width:"10%"}]}tableProperty(){this.configuration=Le({},De),this.configuration.checkboxes=!1,this.configuration.tableLayout.striped=!0,this.configuration.tableLayout.hover=!1,this.configuration.paginationRangeEnabled=!1,this.configuration.paginationEnabled=!1}getDepartmentList(t,n){this.isLoading=!0;let e={pageNo:t,pageSize:n};this.departmentService.departmentList(e).subscribe(i=>{setTimeout(()=>{this.isLoading=!1},600),this.departmentList=i?.body?.result||[],this.pagesize.count=i?.body?.totalRow},i=>{setTimeout(()=>{this.isLoading=!1,this.departmentList=[]},600),console.error("Error fetching desigantion list",i)})}onTablePageChange(t){this.pagesize.offset=t,this.getDepartmentList(this.pagesize.offset,this.pagesize.limit)}onCreateDepartment(t){let n={initialState:{editData:t||""}};this.bsModalRef=this.modalService.show(mi,Object.assign(n,{class:"modal-md modal-dialog-centered alert-popup"})),this.bsModalRef?.content?.mapdata?.subscribe(e=>{this.pagesize.offset=1,this.pagesize.limit=25,this.getDepartmentList(this.pagesize.offset,this.pagesize.limit)})}onDeleteDepartment(t){let n=this.departmentService.deletedepartment(t?.department_id),e={initialState:{title:t?.department_name,content:"Are you sure you want to delete?",primaryActionLabel:"Delete",secondaryActionLabel:"Cancel",service:n}};this.bsModalRef=this.modalService.show(be,Object.assign(e,{id:"confirmation",class:"modal-md modal-dialog-centered"})),this.bsModalRef?.content.mapdata.subscribe(i=>{i?.status==200?(this.notificationSerivce.successAlert(i?.body?.actionResponse),this.pagesize.offset=1,this.pagesize.limit=25,this.getDepartmentList(this.pagesize.offset,this.pagesize.limit)):this.notificationSerivce.errorAlert(i?.title)})}onPageSizeChange(t){let n=parseInt(t.target.value,10);this.pagesize.limit=n,this.getDepartmentList(this.pagesize.offset,this.pagesize.limit)}static{this.\u0275fac=function(n){return new(n||o)(_(k),_(mt),_(V))}}static{this.\u0275cmp=D({type:o,selectors:[["department-list"]],viewQuery:function(n,e){if(n&1&&Ve(Gr,7),n&2){let i;Te(i=Ne())&&(e.table=i.first)}},decls:31,vars:10,consts:[["content",""],["TABLE",""],["inactive",""],[1,"card"],[1,"card-header"],[1,"header-part"],[1,"counting"],["class","row",4,"ngIf"],[1,"card-body"],[1,"header-container"],[1,"left-section"],[1,"search-form"],["placeholder","Search for...","type","text",1,"form-control","search-input",3,"ngModelChange","ngModel"],["type","button",1,"btn-search"],["aria-hidden","true",1,"fa","fa-search"],[1,"right-section","flex","gap-x-2"],[1,"flex","items-center","space-x-2"],["for","itemsPerPage",1,"text-sm","text-gray-700"],["id","itemsPerPage",1,"block","w-20","p-2","bg-white","border","border-gray-300","rounded","shadow-sm","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:border-blue-500","text-gray-700",3,"ngModelChange","change","ngModel"],[3,"value",4,"ngFor","ngForOf"],[1,"btn","btn-primary",3,"click"],["aria-hidden","true",1,"fa","fa-plus"],[1,"row"],[1,"col-md-12"],[1,"overflow-auto"],[4,"ngIf","ngIfElse"],[1,"d-flex","justify-content-center"],["id","deptID",3,"pageChange","maxSize","responsive","nextLabel","previousLabel"],[3,"value"],[3,"isLoading","columns","items"],["id","datatable_wrapper"],["id","datatable","role","grid","aria-describedby","datatable_info","width","100%",1,"table","table-striped","nowrap","dataTable","no-footer","dtr-inline",2,"width","100%"],["role","row"],[4,"ngFor","ngForOf"],["class","text-center py-4 text-gray-500",4,"ngIf"],["class","text-green-600 font-medium",4,"ngIf","ngIfElse"],[1,"flex","space-x-2"],[1,"btn","btn-success",3,"click"],[1,"fa","fa-pencil"],[1,"btn","btn-danger",3,"click"],[1,"fa","fa-trash"],[1,"text-green-600","font-medium"],[1,"text-red-600","font-medium"],[1,"text-center","py-4","text-gray-500"]],template:function(n,e){if(n&1){let i=R();a(0,"div",3)(1,"div",4)(2,"div",5)(3,"span"),l(4,"Department Master"),r(),a(5,"div",6)(6,"span"),l(7),r()(),h(8,Zr,3,4,"div",7),r()(),a(9,"div",8)(10,"div",9)(11,"div",10)(12,"div",11)(13,"input",12),$("ngModelChange",function(d){return S(i),K(e.searchKeyword,d)||(e.searchKeyword=d),E(d)}),r(),a(14,"button",13),u(15,"i",14),r()()(),a(16,"div",15)(17,"div",16)(18,"label",17),l(19,"Items per page:"),r(),a(20,"select",18),$("ngModelChange",function(d){return S(i),K(e.pagesize.limit,d)||(e.pagesize.limit=d),E(d)}),f("change",function(d){return S(i),E(e.onPageSizeChange(d))}),h(21,Hr,2,2,"option",19),r()(),a(22,"button",20),f("click",function(){return S(i),E(e.onCreateDepartment(""))}),u(23,"i",21),l(24," Create Department "),r()()(),a(25,"div",22)(26,"div",23)(27,"div",24),h(28,Kr,3,10,"ng-container",25)(29,ea,12,16,"ng-template",null,0,J),r()()()()()}if(n&2){let i=Y(30);c(7),he(" ",e.pagesize.count>0?e.startValue:0," - ",e.pagesize.count>0?e.lastValue:0," OF ",e.pagesize.count>0?e.pagesize.count:0," Department "),c(),m("ngIf",e.pagesize.count&&e.pagesize.count>0),c(5),H("ngModel",e.searchKeyword),c(7),H("ngModel",e.pagesize.limit),c(),m("ngForOf",me(9,Wr)),c(7),m("ngIf",e.isLoading)("ngIfElse",i)}},dependencies:[I,z,ve,A,O,T,P,N,ge,ye,_e,fe]})}}return o})();var hi=(()=>{class o{static{this.\u0275fac=function(n){return new(n||o)}}static{this.\u0275cmp=D({type:o,selectors:[["app-manage-department"]],decls:2,vars:0,consts:[[1,"main-section"]],template:function(n,e){n&1&&(a(0,"div",0),u(1,"department-list"),r())},dependencies:[ui]})}}return o})();var pt=(()=>{class o{constructor(t){this.apiService=t}desigantion(t){let n=q.desigantion.replace("{pageNo}",t.pageNo).replace("{pageSize}",t?.pageSize);return this.apiService.get(n).pipe(B(e=>U(e)))}createDesigantion(t){let n=q.createDesigantion;return this.apiService.post(n,t).pipe(B(e=>U(e)))}getDesigantionById(t){let n=q.getUpdateDeleteDes.replace("{id}",t);return this.apiService.get(n).pipe(B(e=>U(e)))}updateDesigantion(t,n){let e=q.getUpdateDeleteDes.replace("{id}",n);return this.apiService.put(e,t).pipe(B(i=>U(i)))}deleteDesigantion(t){let n=q.getUpdateDeleteDes.replace("{id}",t);return this.apiService.delete(n).pipe(B(e=>U(e)))}static{this.\u0275fac=function(n){return new(n||o)(Ee(we))}}static{this.\u0275prov=Ce({token:o,factory:o.\u0275fac,providedIn:"root"})}}return o})();function ia(o,p){o&1&&(a(0,"span",20),l(1," Desigantion is Required "),r())}function na(o,p){if(o&1&&(a(0,"option",21),l(1),r()),o&2){let t=p.$implicit;m("ngValue",t.id),c(),b(t.value)}}function oa(o,p){o&1&&(a(0,"span",22),l(1," Status is Required "),r())}var fi=(()=>{class o{constructor(t,n,e,i,s){this.commonService=t,this.fb=n,this.DesignationService=e,this.notificationSerivce=i,this.bsModelService=s,this.mapdata=new W,this.config={displayKey:"text",search:!0,height:"300px"},this.stateList=[],this.status=[{id:1,value:"Active"},{id:0,value:"Inactive"}],this.label="Create"}ngOnInit(){this.setInitialvalue()}setInitialvalue(){this.editData?(this.label="Update",this.departmentForm=this.fb.group({name:[this.editData?.designation_name,[g.required]],status:[this.editData?.is_active,[g.required]],remark:[this.editData?.designation_desc]})):this.departmentForm=this.fb.group({name:["",[g.required]],status:[1,[g.required]],remark:[""]})}submit(t){if(this.departmentForm.invalid){this.departmentForm.markAllAsTouched();return}let n=this.commonService.getUserDetails(),e={designation_id:0,designation_name:t?.name,designation_desc:t?.remark,is_active:t?.status,created_by:n?.user_id},i=this.DesignationService.createDesigantion(e);this.editData?.designation_id&&(e.designation_id=this.editData?.designation_id,i=this.DesignationService.updateDesigantion(e,this.editData?.designation_id)),i.subscribe(s=>{s?.status==200?(this.bsModelService.hide(),this.mapdata.emit(),this.notificationSerivce.successAlert(s?.body?.actionResponse)):this.notificationSerivce.errorAlert(s?.title)})}close(){this.bsModelService.hide()}static{this.\u0275fac=function(n){return new(n||o)(_(G),_(oe),_(pt),_(V),_(k))}}static{this.\u0275cmp=D({type:o,selectors:[["app-create-designation"]],outputs:{mapdata:"mapdata"},decls:33,vars:5,consts:[[1,"modal-header","text-center"],[1,"close-modal",3,"click"],[1,"fa","fa-close",2,"cursor","pointer"],[1,"modal-body"],[3,"formGroup"],[1,"_card","white-bg"],[1,"row"],[1,"col-md-6","mb-2"],[1,"form-label"],[1,"input-group","mb-2"],["type","text","formControlName","name","placeholder","Enter Desigantion Name","aria-describedby","button-addon2",1,"form-control"],["class","text-danger",4,"ngIf"],["formControlName","status",1,"form-control"],[3,"ngValue",4,"ngFor","ngForOf"],["class","text-danger mt-2",4,"ngIf"],["type","text","formControlName","remark","placeholder","Enter Remark","aria-describedby","button-addon2",1,"form-control"],[1,"footer"],[1,"button-container"],["type","submit",1,"btn","btn-success",3,"click"],["type","button",1,"btn","btn-danger",3,"click"],[1,"text-danger"],[3,"ngValue"],[1,"text-danger","mt-2"]],template:function(n,e){if(n&1&&(a(0,"div",0)(1,"h5"),l(2),r(),a(3,"div",1),f("click",function(){return e.close()}),u(4,"i",2),r()(),a(5,"div",3)(6,"div")(7,"form",4)(8,"div",5)(9,"div",6)(10,"div",7)(11,"label",8),l(12,"Desigantion Name"),r(),a(13,"div",9),u(14,"input",10),r(),h(15,ia,2,0,"span",11),r(),a(16,"div",7)(17,"label",8),l(18,"Status"),r(),a(19,"select",12),h(20,na,2,2,"option",13),r(),h(21,oa,2,0,"span",14),r(),a(22,"div",7)(23,"label",8),l(24,"Remark"),r(),a(25,"div",9),u(26,"input",15),r()()()(),a(27,"div",16)(28,"div",17)(29,"button",18),f("click",function(){return e.submit(e.departmentForm.value)}),l(30,"Submit"),r(),a(31,"button",19),f("click",function(){return e.close()}),l(32,"Cancel"),r()()()()()()),n&2){let i,s;c(2),Q("",e.label," Desigantion"),c(5),m("formGroup",e.departmentForm),c(8),m("ngIf",(e.departmentForm==null||(i=e.departmentForm.get("name"))==null?null:i.invalid)&&((e.departmentForm==null||(i=e.departmentForm.get("name"))==null?null:i.dirty)||(e.departmentForm==null||(i=e.departmentForm.get("name"))==null?null:i.touched))),c(5),m("ngForOf",e.status),c(),m("ngIf",(e.departmentForm==null||(s=e.departmentForm.get("status"))==null?null:s.invalid)&&((e.departmentForm==null||(s=e.departmentForm.get("status"))==null?null:s.dirty)||(e.departmentForm==null||(s=e.departmentForm.get("status"))==null?null:s.touched)))}},dependencies:[I,z,te,A,O,T,P,N,ee,ie,ne]})}}return o})();var ra=["table"],aa=()=>[25,50,100],_i=(o,p,t)=>({id:"desID",itemsPerPage:o,currentPage:p,totalItems:t});function sa(o,p){if(o&1){let t=R();a(0,"div",22)(1,"div",26)(2,"pagination-controls",27),f("pageChange",function(e){S(t);let i=C();return E(i.onTablePageChange(e))}),r()()()}o&2&&(c(2),m("maxSize",10)("responsive",!0)("nextLabel","")("previousLabel",""))}function la(o,p){if(o&1&&(a(0,"option",28),l(1),r()),o&2){let t=p.$implicit;m("value",t),c(),b(t)}}function ca(o,p){if(o&1&&(pe(0),u(1,"app-skeleton-loader",29),F(2,"paginate"),ue()),o&2){let t=C();c(),m("isLoading",t.isLoading)("columns",t.columns)("items",M(2,3,t.designationList,X(6,_i,t.pagesize.limit,t.pagesize.offset,t.pagesize.count)))}}function da(o,p){if(o&1&&(a(0,"th")(1,"span"),l(2),r()()),o&2){let t=p.$implicit;c(2),b(t==null?null:t.title)}}function ma(o,p){o&1&&(a(0,"span",41),l(1,"Active"),r())}function pa(o,p){o&1&&(a(0,"span",42),l(1,"Inactive"),r())}function ua(o,p){if(o&1){let t=R();a(0,"tr")(1,"td"),l(2),r(),a(3,"td"),l(4),r(),a(5,"td"),l(6),r(),a(7,"td"),h(8,ma,2,0,"span",35)(9,pa,2,0,"ng-template",null,2,J),r(),a(11,"td",36)(12,"button",37),f("click",function(){let e=S(t).$implicit,i=C(2);return E(i.onCreateDesignation(e))}),u(13,"i",38),r(),a(14,"button",39),f("click",function(){let e=S(t).$implicit,i=C(2);return E(i.onDeleteDesignation(e))}),u(15,"i",40),r()()()}if(o&2){let t=p.$implicit,n=p.index,e=Y(10),i=C(2);c(2),b((i.pagesize.offset-1)*i.pagesize.limit+n+1),c(2),b(t==null?null:t.designation_name),c(2),b(t==null?null:t.designation_desc),c(2),m("ngIf",t==null?null:t.is_active)("ngIfElse",e)}}function ha(o,p){o&1&&(a(0,"div",43),l(1," No Designation Available "),r())}function ga(o,p){if(o&1&&(a(0,"div",30)(1,"table",31,1)(3,"thead")(4,"tr",32),h(5,da,3,1,"th",33),r()(),a(6,"tbody"),h(7,ua,16,5,"tr",33),F(8,"searchFilter"),F(9,"paginate"),r()(),h(10,ha,2,0,"div",34),F(11,"searchFilter"),r()),o&2){let t,n=C();c(5),m("ngForOf",n.columns),c(2),m("ngForOf",M(9,6,M(8,3,n.designationList,n.searchKeyword),X(12,_i,n.pagesize.limit,n.pagesize.offset,n.pagesize.count))),c(3),m("ngIf",!(n.designationList!=null&&n.designationList.length)||!((t=M(11,9,n.designationList,n.searchKeyword))!=null&&t.length))}}var vi=(()=>{class o{get startValue(){return this.pagesize.offset*this.pagesize.limit-(this.pagesize.limit-1)}get lastValue(){let t=this.startValue+this.pagesize.limit-1;return Math.min(t,this.pagesize.count)}constructor(t,n,e){this.modalService=t,this.designationService=n,this.notificationSerivce=e,this.designationList=[],this.breadcrumbs=[{label:"Home",path:"/admin/dashboard/home"},{label:"Master",path:"/admin/master/zone-master"},{label:"Designation Master",path:"/admin/master/designation-master"}],this.isLoading=!1,this.pagesize={limit:25,offset:1,count:0}}ngOnInit(){this.tableProperty(),this.setInitialtable(),this.getDesignationList(this.pagesize.offset,this.pagesize.limit)}setInitialtable(){this.columns=[{key:"S No.",title:"S No.",width:"5%"},{key:"Designation Name",title:"Designation Name"},{key:"Description",title:"Description"},{key:"Status",title:"Status",width:"5%"},{key:"Action",title:"Action",width:"10%"}]}tableProperty(){this.configuration=Le({},De),this.configuration.checkboxes=!1,this.configuration.tableLayout.striped=!0,this.configuration.tableLayout.hover=!1,this.configuration.paginationRangeEnabled=!1,this.configuration.paginationEnabled=!1}getDesignationList(t,n){this.isLoading=!0;let e={pageNo:t,pageSize:n};this.designationService.desigantion(e).subscribe(i=>{setTimeout(()=>{this.isLoading=!1},600),this.designationList=i?.body?.result||[],this.pagesize.count=i?.body?.totalRow},i=>{setTimeout(()=>{this.isLoading=!1,this.designationList=[]},600),console.error("Error fetching Designation list",i)})}onTablePageChange(t){this.pagesize.offset=t,this.getDesignationList(this.pagesize.offset,this.pagesize.limit)}onCreateDesignation(t){let n={initialState:{editData:t||""}};this.bsModalRef=this.modalService.show(fi,Object.assign(n,{class:"modal-md modal-dialog-centered alert-popup"})),this.bsModalRef?.content?.mapdata?.subscribe(e=>{this.pagesize.offset=1,this.pagesize.limit=25,this.getDesignationList(this.pagesize.offset,this.pagesize.limit)})}onDeleteDesignation(t){let n=this.designationService.deleteDesigantion(t?.designation_id),e={initialState:{title:t?.designation_name,content:"Are you sure you want to delete?",primaryActionLabel:"Delete",secondaryActionLabel:"Cancel",service:n}};this.bsModalRef=this.modalService.show(be,Object.assign(e,{id:"confirmation",class:"modal-md modal-dialog-centered"})),this.bsModalRef?.content.mapdata.subscribe(i=>{i?.status==200?(this.notificationSerivce.successAlert(i?.body?.actionResponse),this.pagesize.offset=1,this.pagesize.limit=25,this.getDesignationList(this.pagesize.offset,this.pagesize.limit)):this.notificationSerivce.errorAlert(i?.title)})}onPageSizeChange(t){let n=parseInt(t.target.value,10);this.pagesize.limit=n,this.getDesignationList(this.pagesize.offset,this.pagesize.limit)}static{this.\u0275fac=function(n){return new(n||o)(_(k),_(pt),_(V))}}static{this.\u0275cmp=D({type:o,selectors:[["designation-list"]],viewQuery:function(n,e){if(n&1&&Ve(ra,7),n&2){let i;Te(i=Ne())&&(e.table=i.first)}},decls:31,vars:10,consts:[["content",""],["TABLE",""],["inactive",""],[1,"card"],[1,"card-header"],[1,"header-part"],[1,"counting"],["class","row",4,"ngIf"],[1,"card-body"],[1,"header-container"],[1,"left-section"],[1,"search-form"],["placeholder","Search for...","type","text",1,"form-control","search-input",3,"ngModelChange","ngModel"],["type","button",1,"btn-search"],["aria-hidden","true",1,"fa","fa-search"],[1,"right-section","flex","gap-x-2"],[1,"flex","items-center","space-x-2"],["for","itemsPerPage",1,"text-sm","text-gray-700"],["id","itemsPerPage",1,"block","w-20","p-2","bg-white","border","border-gray-300","rounded","shadow-sm","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:border-blue-500","text-gray-700",3,"ngModelChange","change","ngModel"],[3,"value",4,"ngFor","ngForOf"],[1,"btn","btn-primary",3,"click"],["aria-hidden","true",1,"fa","fa-plus"],[1,"row"],[1,"col-md-12"],[1,"overflow-auto"],[4,"ngIf","ngIfElse"],[1,"d-flex","justify-content-center"],["id","desID",3,"pageChange","maxSize","responsive","nextLabel","previousLabel"],[3,"value"],[3,"isLoading","columns","items"],["id","datatable_wrapper"],["id","datatable","role","grid","aria-describedby","datatable_info","width","100%",1,"table","table-striped","nowrap","dataTable","no-footer","dtr-inline",2,"width","100%"],["role","row"],[4,"ngFor","ngForOf"],["class","text-center py-4 text-gray-500",4,"ngIf"],["class","text-green-600 font-medium",4,"ngIf","ngIfElse"],[1,"flex","space-x-2"],[1,"btn","btn-success",3,"click"],[1,"fa","fa-pencil"],[1,"btn","btn-danger",3,"click"],[1,"fa","fa-trash"],[1,"text-green-600","font-medium"],[1,"text-red-600","font-medium"],[1,"text-center","py-4","text-gray-500"]],template:function(n,e){if(n&1){let i=R();a(0,"div",3)(1,"div",4)(2,"div",5)(3,"span"),l(4,"Designation Master"),r(),a(5,"div",6)(6,"span"),l(7),r()(),h(8,sa,3,4,"div",7),r()(),a(9,"div",8)(10,"div",9)(11,"div",10)(12,"div",11)(13,"input",12),$("ngModelChange",function(d){return S(i),K(e.searchKeyword,d)||(e.searchKeyword=d),E(d)}),r(),a(14,"button",13),u(15,"i",14),r()()(),a(16,"div",15)(17,"div",16)(18,"label",17),l(19,"Items per page:"),r(),a(20,"select",18),$("ngModelChange",function(d){return S(i),K(e.pagesize.limit,d)||(e.pagesize.limit=d),E(d)}),f("change",function(d){return S(i),E(e.onPageSizeChange(d))}),h(21,la,2,2,"option",19),r()(),a(22,"button",20),f("click",function(){return S(i),E(e.onCreateDesignation(""))}),u(23,"i",21),l(24," Create Designation "),r()()(),a(25,"div",22)(26,"div",23)(27,"div",24),h(28,ca,3,10,"ng-container",25)(29,ga,12,16,"ng-template",null,0,J),r()()()()()}if(n&2){let i=Y(30);c(7),he(" ",e.pagesize.count>0?e.startValue:0," - ",e.pagesize.count>0?e.lastValue:0," OF ",e.pagesize.count>0?e.pagesize.count:0," Designation "),c(),m("ngIf",e.pagesize.count&&e.pagesize.count>0),c(5),H("ngModel",e.searchKeyword),c(7),H("ngModel",e.pagesize.limit),c(),m("ngForOf",me(9,aa)),c(7),m("ngIf",e.isLoading)("ngIfElse",i)}},dependencies:[I,z,ve,A,O,T,P,N,ge,ye,_e,fe]})}}return o})();var yi=(()=>{class o{static{this.\u0275fac=function(n){return new(n||o)}}static{this.\u0275cmp=D({type:o,selectors:[["app-manage-designation"]],decls:2,vars:0,consts:[[1,"main-section"]],template:function(n,e){n&1&&(a(0,"div",0),u(1,"designation-list"),r())},dependencies:[vi]})}}return o})();var $e=(()=>{class o{constructor(t){this.apiService=t}workList(t){let n=q.workList.replace("{pageNo}",t.pageNo).replace("{pageSize}",t?.pageSize);return this.apiService.get(n).pipe(B(e=>U(e)))}natureWorkList(){let t=q.natureWorkList;return this.apiService.get(t).pipe(B(n=>U(n)))}addWork(t){let n=q.addWork;return this.apiService.post(n,t).pipe(B(e=>U(e)))}getWorkById(t){let n=q.getUpdateDeleteWork.replace("{id}",t);return this.apiService.get(n).pipe(B(e=>U(e)))}updateWork(t,n){let e=q.getUpdateDeleteWork.replace("{id}",n);return this.apiService.put(e,t).pipe(B(i=>U(i)))}deleteWork(t){let n=q.getUpdateDeleteWork.replace("{id}",t);return this.apiService.delete(n).pipe(B(e=>U(e)))}static{this.\u0275fac=function(n){return new(n||o)(Ee(we))}}static{this.\u0275prov=Ce({token:o,factory:o.\u0275fac,providedIn:"root"})}}return o})();function va(o,p){o&1&&(a(0,"span",36),l(1," City is Required "),r())}function ya(o,p){o&1&&(a(0,"span",36),l(1," Area Name is Required "),r())}function ba(o,p){if(o&1&&(a(0,"div",37),l(1),r()),o&2){let t=C();c(),Q(" ",t.errorMessages==null?null:t.errorMessages.shape," ")}}function Ca(o,p){o&1&&(a(0,"span",36),l(1," Shape is Required "),r())}function La(o,p){o&1&&(a(0,"span",36),l(1," Radius is Required "),r())}function Sa(o,p){if(o&1&&(a(0,"div",37),l(1),r()),o&2){let t=C();c(),Q(" ",t.errorMessages.sourceLat," ")}}function Ea(o,p){o&1&&(a(0,"span",36),l(1," Source Latitude is Required "),r())}function wa(o,p){if(o&1&&(a(0,"div",37),l(1),r()),o&2){let t=C();c(),Q(" ",t.errorMessages==null?null:t.errorMessages.sourceLon," ")}}function Da(o,p){o&1&&(a(0,"span",36),l(1," Source Longitude is Required "),r())}function xa(o,p){if(o&1&&(a(0,"div",37),l(1),r()),o&2){let t=C();c(),Q(" ",t.errorMessages==null?null:t.errorMessages.destinationLat," ")}}function ka(o,p){o&1&&(a(0,"span",36),l(1," Destination Latitude is Required "),r())}function Fa(o,p){if(o&1&&(a(0,"div",37),l(1),r()),o&2){let t=C();c(),Q(" ",t.errorMessages==null?null:t.errorMessages.destinationLon," ")}}function Ma(o,p){o&1&&(a(0,"span",36),l(1," Destination Longitude is Required "),r())}function Ia(o,p){o&1&&(a(0,"span",36),l(1," Colour is Required "),r())}function za(o,p){o&1&&(a(0,"span",36),l(1," Work Name is Required "),r())}function Va(o,p){if(o&1&&(a(0,"option",38),l(1),r()),o&2){let t=p.$implicit;m("ngValue",t.value),c(),Q("",t.text," ")}}function Ta(o,p){o&1&&(a(0,"span",36),l(1," Travel Mode is Required "),r())}function Na(o,p){if(o&1&&(a(0,"option",38),l(1),r()),o&2){let t=p.$implicit;m("ngValue",t.id),c(),b(t.value)}}function Pa(o,p){o&1&&(a(0,"span",36),l(1," Status is Required "),r())}function Aa(o,p){if(o&1){let t=R();a(0,"area-map",39),f("mapAddress",function(e){S(t);let i=C();return E(i.confirm(e))}),r()}if(o&2){let t=C();m("markerData",t.markerData)}}function Oa(o,p){if(o&1){let t=R();a(0,"app-area-google-map",39),f("mapAddress",function(e){S(t);let i=C();return E(i.confirm(e))}),r()}if(o&2){let t=C();m("markerData",t.markerData)}}var ut=(()=>{class o{constructor(t,n,e,i,s,d,v){this.modalService=t,this.workService=n,this.fb=e,this.notificationService=i,this.areaService=s,this.commonService=d,this.bsModelService=v,this.mapdata=new W,this.label="Create",this.config={displayKey:"text",search:!0,height:"300px"},this.cityList=[],this.workNameList=[],this.status=[{id:1,value:"Active"},{id:0,value:"Inactive"}],this.showLocateMarkerMessage=!1}ngOnInit(){this.userData=this.commonService.getUserDetails(),this.setInitialValue()}getTravelList(){this.areaService.travelMode().subscribe(t=>{this.travelModeList=t?.body?.result||[]})}setInitialValue(){this.getTravelList(),this.areaForm=this.fb.group({area_name:[null,[g.required]],shape_type:["",[g.required]],travel_mode:["Driving",[g.required]],color_code:["black",[g.required]],radius:[0],speed_limit:[0],source_lat:[null,[g.required]],source_lon:[null,[g.required]],destination_lat:[null,[g.required]],destination_lon:[null,[g.required]],geofence_text:[null],district_id:[null,[g.required]],work_id:[null,[g.required]],is_active:[1,[g.required]]}),this.areaForm.get("shape_type")?.valueChanges.subscribe(t=>this.onShapeChange(t)),this.areaForm.get("shape_type")?.valueChanges.subscribe(t=>{t=="1"?(this.updateDestinationCoordinates(),this.areaForm.get("radius")?.setValidators([g.required,g.min(1)])):this.areaForm.get("radius")?.clearValidators(),this.areaForm.get("radius")?.updateValueAndValidity()}),this.areaForm.get("source_lat")?.valueChanges.subscribe(()=>{this.areaForm.get("shape_type")?.value==="1"&&this.updateDestinationCoordinates()}),this.areaForm.get("source_lon")?.valueChanges.subscribe(()=>{this.areaForm.get("shape_type")?.value==="1"&&this.updateDestinationCoordinates()}),this.editData?(this.label="Update",this.getAreaById(this.editData?.area_id)):(this.getWorkList(),this.getCityList())}updateDestinationCoordinates(){let t=this.areaForm.get("source_lat")?.value,n=this.areaForm.get("source_lon")?.value;(t!==null||n!==null)&&this.areaForm.patchValue({destination_lat:t,destination_lon:n})}getAreaById(t){this.areaService.getAreaById(t).subscribe(n=>{this.areaById=n?.body?.result,console.log("area",this.areaById),this.areaById&&this.areaForm.patchValue({area_name:this.areaById?.area_name,shape_type:this.areaById?.shape_type.toString(),travel_mode:this.areaById?.travel_mode,color_code:this.areaById?.color_code,radius:this.areaById?.radius,speed_limit:this.areaById?.speed_limit,source_lat:this.areaById?.source_lat,source_lon:this.areaById?.source_lon,destination_lat:this.areaById?.destination_lat,destination_lon:this.areaById?.destination_lon,is_active:this.areaById?.is_active}),this.getWorkList(),this.getCityList(),this.onShapeChange(this.areaById?.shape_type.toString()),this.onCreateShape()})}getWorkList(){let t={pageNo:1,pageSize:5e3};this.workService.workList(t).subscribe(n=>{let e=n?.body?.result||[];if(this.workNameList=e?.map(i=>({value:i?.work_id,text:i?.work_unique_code})),this.areaById){let i=this.workNameList.find(s=>s.value==this.areaById?.work_id);this.areaForm.controls.work_id.setValue(i)}})}getCityList(){this.commonService.cityList(0).subscribe(t=>{this.cityList=t?.body?.result,console.log("check city",this.cityList),this.areaById&&setTimeout(()=>{let n=this.cityList.find(e=>e.value==this.areaById?.district_id);this.areaForm.controls.district_id.setValue(n)},1e3)})}onShapeChange(t){if(t==="1"){let n=this.areaForm.get("source_lat")?.value,e=this.areaForm.get("source_lon")?.value;n!==null&&e!==null&&this.areaForm.patchValue({destination_lat:n,destination_lon:e})}}onChangeSourceLon(t){let n=this.areaForm.get("source_lat")?.value,e=this.areaForm.get("source_lon")?.value;(!n||!e)&&this.notificationService.showInfo("Select Both Source Lat and Source Long for locate the marker on the map"),this.markerData={sourceLat:this.areaForm.get("source_lat")?.value,sourcelon:this.areaForm.get("source_lon")?.value,DestinationLat:this.areaForm.get("destination_lat")?.value,DestinationLon:this.areaForm.get("destination_lon")?.value,shape:this.areaForm.get("shape_type")?.value,colour:this.areaForm.get("color_code")?.value}}onChangeDestiantionLon(t){let n=this.areaForm.get("destination_lat")?.value,e=this.areaForm.get("destination_lon")?.value;(!n||!e)&&this.notificationService.showInfo("Select Both Destination Lat and Destination Long for locate the marker on the map"),this.markerData={sourceLat:this.areaForm.get("source_lat")?.value,sourcelon:this.areaForm.get("source_lon")?.value,DestinationLat:this.areaForm.get("destination_lat")?.value,DestinationLon:this.areaForm.get("destination_lon")?.value,shape:this.areaForm.get("shape_type")?.value,colour:this.areaForm.get("color_code")?.value}}onCreateShape(){let t=this.areaForm.get("source_lat")?.value,n=this.areaForm.get("source_lon")?.value,e=this.areaForm.get("destination_lat")?.value,i=this.areaForm.get("destination_lon")?.value,s=this.areaForm.get("shape_type")?.value,d=this.areaForm.get("color_code")?.value,v=this.areaForm.get("radius")?.value,y=this.areaById?.geofence_text;console.log(v),this.errorMessages={sourceLat:null,sourceLon:null,destinationLat:null,destinationLon:null,shape:null,radius:null};let w=!1;if(!t&&!n&&!e&&!i&&!s&&(this.notificationService.showError("Please provide the necessary details to create a shape."),this.errorMessages.sourceLat="Source Latitude is required.",this.errorMessages.sourceLon="Source Longitude is required.",this.errorMessages.destinationLat="Destination Latitude is required.",this.errorMessages.destinationLon="Destination Longitude is required.",this.errorMessages.shape="Please select a shape type to create the shape.",this.errorMessages.radius="Radius is required.",w=!0),t&&!n?(w=!0,this.errorMessages.sourceLon="Source Longitude is required."):!t&&n&&(this.errorMessages.sourceLat="Source Latitude is required.",w=!0),!e&&i?(this.errorMessages.destinationLat="Destination Latitude is required.",w=!0):e&&!i&&(this.errorMessages.destinationLon="Destination Longitude is required.",w=!0),s||(this.errorMessages.shape="Please select a shape type to create the shape.",w=!0),w)return;let x={sourceLat:t,sourceLon:n,destinationLat:e,destinationLon:i,shape:s,colour:d,radius:v,geofanceText:y};this.markerData=x,this.notificationService.showSuccess("Shape created successfully!")}onCreateRoute(t){if(this.areaForm.invalid){this.areaForm.markAllAsTouched();return}let n=this.commonService.getUserDetails(),e={area_id:0,area_name:t?.area_name,shape_type:Number(t?.shape_type),travel_mode:t?.travel_mode,color_code:t?.color_code,radius:t?.radius,speed_limit:t?.speed_limit,source_lat:t?.source_lat,source_lon:t?.source_lon,destination_lat:t?.destination_lat,destination_lon:t?.destination_lon,geofence_text:null,district_id:t?.district_id?Number(t?.district_id.value):null,district_name:t?.district_id?t?.district_id.text:null,work_id:t?.work_id?t?.work_id.value:null,work_name:t?.work_id?t?.work_id.text:null,is_active:t?.is_active,created_by:n?.user_id},i=this.areaService.addArea(e);this.areaById&&(e.area_id=this.areaById?.area_id,i=this.areaService.updateArea(e,this.areaById?.area_id)),i.subscribe(s=>{s?.status==200?(this.bsModelService.hide(),this.mapdata.emit(),this.notificationService.successAlert(s?.body?.actionResponse)):this.notificationService.errorAlert(s?.title)})}close(){this.modalService.hide()}confirm(t){let{circle:n,radius:e,shapeType:i}=t;if(i==1)this.areaForm.patchValue({source_lat:n.lat,source_lon:n.lng,destination_lat:n.lat,destination_lon:n.lng,radius:e,shape_type:i.toString()});else if(i==2){let s=n[0][0],d=n[0][1],v=n[n.length-2][0],y=n[n.length-2][1];this.areaForm.patchValue({source_lat:s,source_lon:d,destination_lat:v,destination_lon:y,radius:e,shape_type:i.toString()})}}static{this.\u0275fac=function(n){return new(n||o)(_(k),_($e),_(oe),_(V),_(rt),_(G),_(k))}}static{this.\u0275cmp=D({type:o,selectors:[["app-create-area"]],outputs:{mapdata:"mapdata"},decls:105,vars:26,consts:[[1,"modal-header","text-center"],[1,"close-modal",3,"click"],[1,"fa","fa-close",2,"cursor","pointer"],[1,"modal-body"],[1,"row"],[1,"col-md-5"],[3,"formGroup"],[1,"col-md-6","mb-2"],[1,"form-label"],["formControlName","district_id",3,"config","options"],["class","text-danger mt-2",4,"ngIf"],[1,"input-group","mb-2"],["type","text","formControlName","area_name","placeholder","Enter Location","aria-describedby","button-addon2",1,"form-control"],[1,"form-check"],["type","radio","formControlName","shape_type","value","1","id","flexRadioDefault1",1,"form-check-input"],["for","flexRadioDefault1",1,"form-check-label"],["type","radio","formControlName","shape_type","value","2","id","flexRadioDefault2",1,"form-check-input"],["for","flexRadioDefault2",1,"form-check-label"],["class","text-danger",4,"ngIf"],["type","number","placeholder","Enter Radius","aria-describedby","button-addon2","formControlName","radius",1,"form-control"],["type","number","placeholder","Enter Latitude","formControlName","source_lat","aria-describedby","button-addon2",1,"form-control"],["type","number","placeholder","Enter Longitude","formControlName","source_lon","aria-describedby","button-addon2",1,"form-control"],["type","number","placeholder","Enter Latitude","formControlName","destination_lat","aria-describedby","button-addon2",1,"form-control"],["type","number","placeholder","Enter Longitude","formControlName","destination_lon","aria-describedby","button-addon2",1,"form-control"],["type","color","formControlName","color_code","aria-describedby","button-addon2",1,"form-control"],["type","number","placeholder","Enter Speed","aria-describedby","button-addon2","formControlName","speed_limit",1,"form-control"],["formControlName","work_id",3,"config","options"],["formControlName","travel_mode",1,"form-control"],[3,"ngValue",4,"ngFor","ngForOf"],["formControlName","is_active",1,"form-control"],[1,"footer"],[1,"button-container"],["type","submit",1,"btn","btn-success",3,"click"],["type","button",1,"btn","btn-primary",3,"click"],[1,"col-md-7"],[3,"markerData"],[1,"text-danger","mt-2"],[1,"text-danger"],[3,"ngValue"],[3,"mapAddress","markerData"]],template:function(n,e){if(n&1&&(a(0,"div",0)(1,"h5"),l(2),r(),a(3,"div",1),f("click",function(){return e.close()}),u(4,"i",2),r()(),a(5,"div",3)(6,"div",4)(7,"div",5)(8,"form",6)(9,"div",4)(10,"div",7)(11,"label",8),l(12,"City"),r(),u(13,"ngx-select-dropdown",9),h(14,va,2,0,"span",10),r(),a(15,"div",7)(16,"label",8),l(17,"Area Name"),r(),a(18,"div",11),u(19,"input",12),r(),h(20,ya,2,0,"span",10),r(),a(21,"div",7)(22,"label",8),l(23,"Shape"),r(),a(24,"div",13),u(25,"input",14),a(26,"label",15),l(27," Circle "),r()(),a(28,"div",13),u(29,"input",16),a(30,"label",17),l(31," Polygon "),r()(),h(32,ba,2,1,"div",18)(33,Ca,2,0,"span",10),r(),a(34,"div",7)(35,"label",8),l(36,"Radius"),r(),a(37,"div",11),u(38,"input",19),r(),h(39,La,2,0,"span",10),r(),a(40,"div",7)(41,"label",8),l(42,"Source Latitude"),r(),a(43,"div",11),u(44,"input",20),r(),h(45,Sa,2,1,"div",18)(46,Ea,2,0,"span",10),r(),a(47,"div",7)(48,"label",8),l(49,"Source Longitude"),r(),a(50,"div",11),u(51,"input",21),r(),h(52,wa,2,1,"div",18)(53,Da,2,0,"span",10),r(),a(54,"div",7)(55,"label",8),l(56,"Destination Latitude"),r(),a(57,"div",11),u(58,"input",22),r(),h(59,xa,2,1,"div",18)(60,ka,2,0,"span",10),r(),a(61,"div",7)(62,"label",8),l(63,"Destination Longitude"),r(),a(64,"div",11),u(65,"input",23),r(),h(66,Fa,2,1,"div",18)(67,Ma,2,0,"span",10),r(),a(68,"div",7)(69,"label",8),l(70,"Route Colour"),r(),a(71,"div",11),u(72,"input",24),r(),h(73,Ia,2,0,"span",10),r(),a(74,"div",7)(75,"label",8),l(76,"Speed"),r(),a(77,"div",11),u(78,"input",25),r()(),a(79,"div",7)(80,"label",8),l(81,"Work Name"),r(),u(82,"ngx-select-dropdown",26),h(83,za,2,0,"span",10),r(),a(84,"div",7)(85,"label",8),l(86,"Travel Mode"),r(),a(87,"select",27),h(88,Va,2,2,"option",28),r(),h(89,Ta,2,0,"span",10),r(),a(90,"div",7)(91,"label",8),l(92,"Status"),r(),a(93,"select",29),h(94,Na,2,2,"option",28),r(),h(95,Pa,2,0,"span",10),r()(),a(96,"div",30)(97,"div",31)(98,"button",32),f("click",function(){return e.onCreateShape()}),l(99,"Create Shape"),r(),a(100,"button",33),f("click",function(){return e.onCreateRoute(e.areaForm.value)}),l(101,"Save Route"),r()()()()(),a(102,"div",34),h(103,Aa,1,1,"area-map",35)(104,Oa,1,1),r()()()),n&2){let i,s,d,v,y,w,x,Z,xe,Ge,We,Ze;c(2),Q("",e.label," Area"),c(6),m("formGroup",e.areaForm),c(5),m("config",e.config)("options",e.cityList),c(),m("ngIf",(e.areaForm==null||(i=e.areaForm.get("district_id"))==null?null:i.invalid)&&((e.areaForm==null||(i=e.areaForm.get("district_id"))==null?null:i.dirty)||(e.areaForm==null||(i=e.areaForm.get("district_id"))==null?null:i.touched))),c(6),m("ngIf",(e.areaForm==null||(s=e.areaForm.get("area_name"))==null?null:s.invalid)&&((e.areaForm==null||(s=e.areaForm.get("area_name"))==null?null:s.dirty)||(e.areaForm==null||(s=e.areaForm.get("area_name"))==null?null:s.touched))),c(12),m("ngIf",e.errorMessages==null?null:e.errorMessages.shape),c(),m("ngIf",(e.areaForm==null||(d=e.areaForm.get("shape_type"))==null?null:d.invalid)&&((e.areaForm==null||(d=e.areaForm.get("shape_type"))==null?null:d.dirty)||(e.areaForm==null||(d=e.areaForm.get("shape_type"))==null?null:d.touched))),c(6),m("ngIf",(e.areaForm==null||(v=e.areaForm.get("radius"))==null?null:v.invalid)&&((e.areaForm==null||(v=e.areaForm.get("radius"))==null?null:v.dirty)||(e.areaForm==null||(v=e.areaForm.get("radius"))==null?null:v.touched))),c(6),m("ngIf",e.errorMessages==null?null:e.errorMessages.sourceLat),c(),m("ngIf",(e.areaForm==null||(y=e.areaForm.get("source_lat"))==null?null:y.invalid)&&((e.areaForm==null||(y=e.areaForm.get("source_lat"))==null?null:y.dirty)||(e.areaForm==null||(y=e.areaForm.get("source_lat"))==null?null:y.touched))),c(6),m("ngIf",e.errorMessages==null?null:e.errorMessages.sourceLon),c(),m("ngIf",(e.areaForm==null||(w=e.areaForm.get("source_lon"))==null?null:w.invalid)&&((e.areaForm==null||(w=e.areaForm.get("source_lon"))==null?null:w.dirty)||(e.areaForm==null||(w=e.areaForm.get("source_lon"))==null?null:w.touched))),c(6),m("ngIf",e.errorMessages==null?null:e.errorMessages.destinationLat),c(),m("ngIf",(e.areaForm==null||(x=e.areaForm.get("destination_lat"))==null?null:x.invalid)&&((e.areaForm==null||(x=e.areaForm.get("destination_lat"))==null?null:x.dirty)||(e.areaForm==null||(x=e.areaForm.get("destination_lat"))==null?null:x.touched))),c(6),m("ngIf",e.errorMessages==null?null:e.errorMessages.destinationLon),c(),m("ngIf",(e.areaForm==null||(Z=e.areaForm.get("destination_lon"))==null?null:Z.invalid)&&((e.areaForm==null||(Z=e.areaForm.get("destination_lon"))==null?null:Z.dirty)||(e.areaForm==null||(Z=e.areaForm.get("destination_lon"))==null?null:Z.touched))),c(6),m("ngIf",(e.areaForm==null||(xe=e.areaForm.get("color_code"))==null?null:xe.invalid)&&((e.areaForm==null||(xe=e.areaForm.get("color_code"))==null?null:xe.dirty)||(e.areaForm==null||(xe=e.areaForm.get("color_code"))==null?null:xe.touched))),c(9),m("config",e.config)("options",e.workNameList),c(),m("ngIf",(e.areaForm==null||(Ge=e.areaForm.get("work_id"))==null?null:Ge.invalid)&&((e.areaForm==null||(Ge=e.areaForm.get("work_id"))==null?null:Ge.dirty)||(e.areaForm==null||(Ge=e.areaForm.get("work_id"))==null?null:Ge.touched))),c(5),m("ngForOf",e.travelModeList),c(),m("ngIf",(e.areaForm==null||(We=e.areaForm.get("travel_mode"))==null?null:We.invalid)&&((e.areaForm==null||(We=e.areaForm.get("travel_mode"))==null?null:We.dirty)||(e.areaForm==null||(We=e.areaForm.get("travel_mode"))==null?null:We.touched))),c(5),m("ngForOf",e.status),c(),m("ngIf",(e.areaForm==null||(Ze=e.areaForm.get("is_active"))==null?null:Ze.invalid)&&((e.areaForm==null||(Ze=e.areaForm.get("is_active"))==null?null:Ze.dirty)||(e.areaForm==null||(Ze=e.areaForm.get("is_active"))==null?null:Ze.touched))),c(8),He(103,(e.userData==null?null:e.userData.is_gmap_enabled)===0?103:(e.userData==null?null:e.userData.is_gmap_enabled)===1?104:-1)}}})}}return o})();var de=Fi(Mi());(function(o,p,t){function n(e,i){for(;(e=e.parentElement)&&!e.classList.contains(i););return e}L.drawVersion="1.0.4",L.Draw={},L.drawLocal={draw:{toolbar:{actions:{title:"Cancel drawing",text:"Cancel"},finish:{title:"Finish drawing",text:"Finish"},undo:{title:"Delete last point drawn",text:"Delete last point"},buttons:{polyline:"Draw a polyline",polygon:"Draw a polygon",rectangle:"Draw a rectangle",circle:"Draw a circle",marker:"Draw a marker",circlemarker:"Draw a circlemarker"}},handlers:{circle:{tooltip:{start:"Click and drag to draw circle."},radius:"Radius"},circlemarker:{tooltip:{start:"Click map to place circle marker."}},marker:{tooltip:{start:"Click map to place marker."}},polygon:{tooltip:{start:"Click to start drawing shape.",cont:"Click to continue drawing shape.",end:"Click first point to close this shape."}},polyline:{error:"<strong>Error:</strong> shape edges cannot cross!",tooltip:{start:"Click to start drawing line.",cont:"Click to continue drawing line.",end:"Click last point to finish line."}},rectangle:{tooltip:{start:"Click and drag to draw rectangle."}},simpleshape:{tooltip:{end:"Release mouse to finish drawing."}}}},edit:{toolbar:{actions:{save:{title:"Save changes",text:"Save"},cancel:{title:"Cancel editing, discards all changes",text:"Cancel"},clearAll:{title:"Clear all layers",text:"Clear All"}},buttons:{edit:"Edit layers",editDisabled:"No layers to edit",remove:"Delete layers",removeDisabled:"No layers to delete"}},handlers:{edit:{tooltip:{text:"Drag handles or markers to edit features.",subtext:"Click cancel to undo changes."}},remove:{tooltip:{text:"Click on a feature to remove."}}}}},L.Draw.Event={},L.Draw.Event.CREATED="draw:created",L.Draw.Event.EDITED="draw:edited",L.Draw.Event.DELETED="draw:deleted",L.Draw.Event.DRAWSTART="draw:drawstart",L.Draw.Event.DRAWSTOP="draw:drawstop",L.Draw.Event.DRAWVERTEX="draw:drawvertex",L.Draw.Event.EDITSTART="draw:editstart",L.Draw.Event.EDITMOVE="draw:editmove",L.Draw.Event.EDITRESIZE="draw:editresize",L.Draw.Event.EDITVERTEX="draw:editvertex",L.Draw.Event.EDITSTOP="draw:editstop",L.Draw.Event.DELETESTART="draw:deletestart",L.Draw.Event.DELETESTOP="draw:deletestop",L.Draw.Event.TOOLBAROPENED="draw:toolbaropened",L.Draw.Event.TOOLBARCLOSED="draw:toolbarclosed",L.Draw.Event.MARKERCONTEXT="draw:markercontext",L.Draw=L.Draw||{},L.Draw.Feature=L.Handler.extend({initialize:function(e,i){this._map=e,this._container=e._container,this._overlayPane=e._panes.overlayPane,this._popupPane=e._panes.popupPane,i&&i.shapeOptions&&(i.shapeOptions=L.Util.extend({},this.options.shapeOptions,i.shapeOptions)),L.setOptions(this,i);var s=L.version.split(".");parseInt(s[0],10)===1&&parseInt(s[1],10)>=2?L.Draw.Feature.include(L.Evented.prototype):L.Draw.Feature.include(L.Mixin.Events)},enable:function(){this._enabled||(L.Handler.prototype.enable.call(this),this.fire("enabled",{handler:this.type}),this._map.fire(L.Draw.Event.DRAWSTART,{layerType:this.type}))},disable:function(){this._enabled&&(L.Handler.prototype.disable.call(this),this._map.fire(L.Draw.Event.DRAWSTOP,{layerType:this.type}),this.fire("disabled",{handler:this.type}))},addHooks:function(){var e=this._map;e&&(L.DomUtil.disableTextSelection(),e.getContainer().focus(),this._tooltip=new L.Draw.Tooltip(this._map),L.DomEvent.on(this._container,"keyup",this._cancelDrawing,this))},removeHooks:function(){this._map&&(L.DomUtil.enableTextSelection(),this._tooltip.dispose(),this._tooltip=null,L.DomEvent.off(this._container,"keyup",this._cancelDrawing,this))},setOptions:function(e){L.setOptions(this,e)},_fireCreatedEvent:function(e){this._map.fire(L.Draw.Event.CREATED,{layer:e,layerType:this.type})},_cancelDrawing:function(e){e.keyCode===27&&(this._map.fire("draw:canceled",{layerType:this.type}),this.disable())}}),L.Draw.Polyline=L.Draw.Feature.extend({statics:{TYPE:"polyline"},Poly:L.Polyline,options:{allowIntersection:!0,repeatMode:!1,drawError:{color:"#b00b00",timeout:2500},icon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon"}),touchIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-touch-icon"}),guidelineDistance:20,maxGuideLineLength:4e3,shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!1,clickable:!0},metric:!0,feet:!0,nautic:!1,showLength:!0,zIndexOffset:2e3,factor:1,maxPoints:0},initialize:function(e,i){L.Browser.touch&&(this.options.icon=this.options.touchIcon),this.options.drawError.message=L.drawLocal.draw.handlers.polyline.error,i&&i.drawError&&(i.drawError=L.Util.extend({},this.options.drawError,i.drawError)),this.type=L.Draw.Polyline.TYPE,L.Draw.Feature.prototype.initialize.call(this,e,i)},addHooks:function(){L.Draw.Feature.prototype.addHooks.call(this),this._map&&(this._markers=[],this._markerGroup=new L.LayerGroup,this._map.addLayer(this._markerGroup),this._poly=new L.Polyline([],this.options.shapeOptions),this._tooltip.updateContent(this._getTooltipText()),this._mouseMarker||(this._mouseMarker=L.marker(this._map.getCenter(),{icon:L.divIcon({className:"leaflet-mouse-marker",iconAnchor:[20,20],iconSize:[40,40]}),opacity:0,zIndexOffset:this.options.zIndexOffset})),this._mouseMarker.on("mouseout",this._onMouseOut,this).on("mousemove",this._onMouseMove,this).on("mousedown",this._onMouseDown,this).on("mouseup",this._onMouseUp,this).addTo(this._map),this._map.on("mouseup",this._onMouseUp,this).on("mousemove",this._onMouseMove,this).on("zoomlevelschange",this._onZoomEnd,this).on("touchstart",this._onTouch,this).on("zoomend",this._onZoomEnd,this))},removeHooks:function(){L.Draw.Feature.prototype.removeHooks.call(this),this._clearHideErrorTimeout(),this._cleanUpShape(),this._map.removeLayer(this._markerGroup),delete this._markerGroup,delete this._markers,this._map.removeLayer(this._poly),delete this._poly,this._mouseMarker.off("mousedown",this._onMouseDown,this).off("mouseout",this._onMouseOut,this).off("mouseup",this._onMouseUp,this).off("mousemove",this._onMouseMove,this),this._map.removeLayer(this._mouseMarker),delete this._mouseMarker,this._clearGuides(),this._map.off("mouseup",this._onMouseUp,this).off("mousemove",this._onMouseMove,this).off("zoomlevelschange",this._onZoomEnd,this).off("zoomend",this._onZoomEnd,this).off("touchstart",this._onTouch,this).off("click",this._onTouch,this)},deleteLastVertex:function(){if(!(this._markers.length<=1)){var e=this._markers.pop(),i=this._poly,s=i.getLatLngs(),d=s.splice(-1,1)[0];this._poly.setLatLngs(s),this._markerGroup.removeLayer(e),i.getLatLngs().length<2&&this._map.removeLayer(i),this._vertexChanged(d,!1)}},addVertex:function(e){if(this._markers.length>=2&&!this.options.allowIntersection&&this._poly.newLatLngIntersects(e))return void this._showErrorTooltip();this._errorShown&&this._hideErrorTooltip(),this._markers.push(this._createMarker(e)),this._poly.addLatLng(e),this._poly.getLatLngs().length===2&&this._map.addLayer(this._poly),this._vertexChanged(e,!0)},completeShape:function(){this._markers.length<=1||!this._shapeIsValid()||(this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable())},_finishShape:function(){var e=this._poly._defaultShape?this._poly._defaultShape():this._poly.getLatLngs(),i=this._poly.newLatLngIntersects(e[e.length-1]);if(!this.options.allowIntersection&&i||!this._shapeIsValid())return void this._showErrorTooltip();this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable()},_shapeIsValid:function(){return!0},_onZoomEnd:function(){this._markers!==null&&this._updateGuide()},_onMouseMove:function(e){var i=this._map.mouseEventToLayerPoint(e.originalEvent),s=this._map.layerPointToLatLng(i);this._currentLatLng=s,this._updateTooltip(s),this._updateGuide(i),this._mouseMarker.setLatLng(s),L.DomEvent.preventDefault(e.originalEvent)},_vertexChanged:function(e,i){this._map.fire(L.Draw.Event.DRAWVERTEX,{layers:this._markerGroup}),this._updateFinishHandler(),this._updateRunningMeasure(e,i),this._clearGuides(),this._updateTooltip()},_onMouseDown:function(e){if(!this._clickHandled&&!this._touchHandled&&!this._disableMarkers){this._onMouseMove(e),this._clickHandled=!0,this._disableNewMarkers();var i=e.originalEvent,s=i.clientX,d=i.clientY;this._startPoint.call(this,s,d)}},_startPoint:function(e,i){this._mouseDownOrigin=L.point(e,i)},_onMouseUp:function(e){var i=e.originalEvent,s=i.clientX,d=i.clientY;this._endPoint.call(this,s,d,e),this._clickHandled=null},_endPoint:function(e,i,s){if(this._mouseDownOrigin){var d=L.point(e,i).distanceTo(this._mouseDownOrigin),v=this._calculateFinishDistance(s.latlng);this.options.maxPoints>1&&this.options.maxPoints==this._markers.length+1?(this.addVertex(s.latlng),this._finishShape()):v<10&&L.Browser.touch?this._finishShape():Math.abs(d)<9*(o.devicePixelRatio||1)&&this.addVertex(s.latlng),this._enableNewMarkers()}this._mouseDownOrigin=null},_onTouch:function(e){var i,s,d=e.originalEvent;!d.touches||!d.touches[0]||this._clickHandled||this._touchHandled||this._disableMarkers||(i=d.touches[0].clientX,s=d.touches[0].clientY,this._disableNewMarkers(),this._touchHandled=!0,this._startPoint.call(this,i,s),this._endPoint.call(this,i,s,e),this._touchHandled=null),this._clickHandled=null},_onMouseOut:function(){this._tooltip&&this._tooltip._onMouseOut.call(this._tooltip)},_calculateFinishDistance:function(e){var i;if(this._markers.length>0){var s;if(this.type===L.Draw.Polyline.TYPE)s=this._markers[this._markers.length-1];else{if(this.type!==L.Draw.Polygon.TYPE)return 1/0;s=this._markers[0]}var d=this._map.latLngToContainerPoint(s.getLatLng()),v=new L.Marker(e,{icon:this.options.icon,zIndexOffset:2*this.options.zIndexOffset}),y=this._map.latLngToContainerPoint(v.getLatLng());i=d.distanceTo(y)}else i=1/0;return i},_updateFinishHandler:function(){var e=this._markers.length;e>1&&this._markers[e-1].on("click",this._finishShape,this),e>2&&this._markers[e-2].off("click",this._finishShape,this)},_createMarker:function(e){var i=new L.Marker(e,{icon:this.options.icon,zIndexOffset:2*this.options.zIndexOffset});return this._markerGroup.addLayer(i),i},_updateGuide:function(e){var i=this._markers?this._markers.length:0;i>0&&(e=e||this._map.latLngToLayerPoint(this._currentLatLng),this._clearGuides(),this._drawGuide(this._map.latLngToLayerPoint(this._markers[i-1].getLatLng()),e))},_updateTooltip:function(e){var i=this._getTooltipText();e&&this._tooltip.updatePosition(e),this._errorShown||this._tooltip.updateContent(i)},_drawGuide:function(e,i){var s,d,v,y=Math.floor(Math.sqrt(Math.pow(i.x-e.x,2)+Math.pow(i.y-e.y,2))),w=this.options.guidelineDistance,x=this.options.maxGuideLineLength,Z=y>x?y-x:w;for(this._guidesContainer||(this._guidesContainer=L.DomUtil.create("div","leaflet-draw-guides",this._overlayPane));Z<y;Z+=this.options.guidelineDistance)s=Z/y,d={x:Math.floor(e.x*(1-s)+s*i.x),y:Math.floor(e.y*(1-s)+s*i.y)},v=L.DomUtil.create("div","leaflet-draw-guide-dash",this._guidesContainer),v.style.backgroundColor=this._errorShown?this.options.drawError.color:this.options.shapeOptions.color,L.DomUtil.setPosition(v,d)},_updateGuideColor:function(e){if(this._guidesContainer)for(var i=0,s=this._guidesContainer.childNodes.length;i<s;i++)this._guidesContainer.childNodes[i].style.backgroundColor=e},_clearGuides:function(){if(this._guidesContainer)for(;this._guidesContainer.firstChild;)this._guidesContainer.removeChild(this._guidesContainer.firstChild)},_getTooltipText:function(){var e,i,s=this.options.showLength;return this._markers.length===0?e={text:L.drawLocal.draw.handlers.polyline.tooltip.start}:(i=s?this._getMeasurementString():"",e=this._markers.length===1?{text:L.drawLocal.draw.handlers.polyline.tooltip.cont,subtext:i}:{text:L.drawLocal.draw.handlers.polyline.tooltip.end,subtext:i}),e},_updateRunningMeasure:function(e,i){var s,d,v=this._markers.length;this._markers.length===1?this._measurementRunningTotal=0:(s=v-(i?2:1),d=L.GeometryUtil.isVersion07x()?e.distanceTo(this._markers[s].getLatLng())*(this.options.factor||1):this._map.distance(e,this._markers[s].getLatLng())*(this.options.factor||1),this._measurementRunningTotal+=d*(i?1:-1))},_getMeasurementString:function(){var e,i=this._currentLatLng,s=this._markers[this._markers.length-1].getLatLng();return e=L.GeometryUtil.isVersion07x()?s&&i&&i.distanceTo?this._measurementRunningTotal+i.distanceTo(s)*(this.options.factor||1):this._measurementRunningTotal||0:s&&i?this._measurementRunningTotal+this._map.distance(i,s)*(this.options.factor||1):this._measurementRunningTotal||0,L.GeometryUtil.readableDistance(e,this.options.metric,this.options.feet,this.options.nautic,this.options.precision)},_showErrorTooltip:function(){this._errorShown=!0,this._tooltip.showAsError().updateContent({text:this.options.drawError.message}),this._updateGuideColor(this.options.drawError.color),this._poly.setStyle({color:this.options.drawError.color}),this._clearHideErrorTimeout(),this._hideErrorTimeout=setTimeout(L.Util.bind(this._hideErrorTooltip,this),this.options.drawError.timeout)},_hideErrorTooltip:function(){this._errorShown=!1,this._clearHideErrorTimeout(),this._tooltip.removeError().updateContent(this._getTooltipText()),this._updateGuideColor(this.options.shapeOptions.color),this._poly.setStyle({color:this.options.shapeOptions.color})},_clearHideErrorTimeout:function(){this._hideErrorTimeout&&(clearTimeout(this._hideErrorTimeout),this._hideErrorTimeout=null)},_disableNewMarkers:function(){this._disableMarkers=!0},_enableNewMarkers:function(){setTimeout(function(){this._disableMarkers=!1}.bind(this),50)},_cleanUpShape:function(){this._markers.length>1&&this._markers[this._markers.length-1].off("click",this._finishShape,this)},_fireCreatedEvent:function(){var e=new this.Poly(this._poly.getLatLngs(),this.options.shapeOptions);L.Draw.Feature.prototype._fireCreatedEvent.call(this,e)}}),L.Draw.Polygon=L.Draw.Polyline.extend({statics:{TYPE:"polygon"},Poly:L.Polygon,options:{showArea:!1,showLength:!1,shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0},metric:!0,feet:!0,nautic:!1,precision:{}},initialize:function(e,i){L.Draw.Polyline.prototype.initialize.call(this,e,i),this.type=L.Draw.Polygon.TYPE},_updateFinishHandler:function(){var e=this._markers.length;e===1&&this._markers[0].on("click",this._finishShape,this),e>2&&(this._markers[e-1].on("dblclick",this._finishShape,this),e>3&&this._markers[e-2].off("dblclick",this._finishShape,this))},_getTooltipText:function(){var e,i;return this._markers.length===0?e=L.drawLocal.draw.handlers.polygon.tooltip.start:this._markers.length<3?(e=L.drawLocal.draw.handlers.polygon.tooltip.cont,i=this._getMeasurementString()):(e=L.drawLocal.draw.handlers.polygon.tooltip.end,i=this._getMeasurementString()),{text:e,subtext:i}},_getMeasurementString:function(){var e=this._area,i="";return e||this.options.showLength?(this.options.showLength&&(i=L.Draw.Polyline.prototype._getMeasurementString.call(this)),e&&(i+="<br>"+L.GeometryUtil.readableArea(e,this.options.metric,this.options.precision)),i):null},_shapeIsValid:function(){return this._markers.length>=3},_vertexChanged:function(e,i){var s;!this.options.allowIntersection&&this.options.showArea&&(s=this._poly.getLatLngs(),this._area=L.GeometryUtil.geodesicArea(s)),L.Draw.Polyline.prototype._vertexChanged.call(this,e,i)},_cleanUpShape:function(){var e=this._markers.length;e>0&&(this._markers[0].off("click",this._finishShape,this),e>2&&this._markers[e-1].off("dblclick",this._finishShape,this))}}),L.SimpleShape={},L.Draw.SimpleShape=L.Draw.Feature.extend({options:{repeatMode:!1},initialize:function(e,i){this._endLabelText=L.drawLocal.draw.handlers.simpleshape.tooltip.end,L.Draw.Feature.prototype.initialize.call(this,e,i)},addHooks:function(){L.Draw.Feature.prototype.addHooks.call(this),this._map&&(this._mapDraggable=this._map.dragging.enabled(),this._mapDraggable&&this._map.dragging.disable(),this._container.style.cursor="crosshair",this._tooltip.updateContent({text:this._initialLabelText}),this._map.on("mousedown",this._onMouseDown,this).on("mousemove",this._onMouseMove,this).on("touchstart",this._onMouseDown,this).on("touchmove",this._onMouseMove,this),p.addEventListener("touchstart",L.DomEvent.preventDefault,{passive:!1}))},removeHooks:function(){L.Draw.Feature.prototype.removeHooks.call(this),this._map&&(this._mapDraggable&&this._map.dragging.enable(),this._container.style.cursor="",this._map.off("mousedown",this._onMouseDown,this).off("mousemove",this._onMouseMove,this).off("touchstart",this._onMouseDown,this).off("touchmove",this._onMouseMove,this),L.DomEvent.off(p,"mouseup",this._onMouseUp,this),L.DomEvent.off(p,"touchend",this._onMouseUp,this),p.removeEventListener("touchstart",L.DomEvent.preventDefault),this._shape&&(this._map.removeLayer(this._shape),delete this._shape)),this._isDrawing=!1},_getTooltipText:function(){return{text:this._endLabelText}},_onMouseDown:function(e){this._isDrawing=!0,this._startLatLng=e.latlng,L.DomEvent.on(p,"mouseup",this._onMouseUp,this).on(p,"touchend",this._onMouseUp,this).preventDefault(e.originalEvent)},_onMouseMove:function(e){var i=e.latlng;this._tooltip.updatePosition(i),this._isDrawing&&(this._tooltip.updateContent(this._getTooltipText()),this._drawShape(i))},_onMouseUp:function(){this._shape&&this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable()}}),L.Draw.Rectangle=L.Draw.SimpleShape.extend({statics:{TYPE:"rectangle"},options:{shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0},showArea:!0,metric:!0},initialize:function(e,i){this.type=L.Draw.Rectangle.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.rectangle.tooltip.start,L.Draw.SimpleShape.prototype.initialize.call(this,e,i)},disable:function(){this._enabled&&(this._isCurrentlyTwoClickDrawing=!1,L.Draw.SimpleShape.prototype.disable.call(this))},_onMouseUp:function(e){if(!this._shape&&!this._isCurrentlyTwoClickDrawing)return void(this._isCurrentlyTwoClickDrawing=!0);this._isCurrentlyTwoClickDrawing&&!n(e.target,"leaflet-pane")||L.Draw.SimpleShape.prototype._onMouseUp.call(this)},_drawShape:function(e){this._shape?this._shape.setBounds(new L.LatLngBounds(this._startLatLng,e)):(this._shape=new L.Rectangle(new L.LatLngBounds(this._startLatLng,e),this.options.shapeOptions),this._map.addLayer(this._shape))},_fireCreatedEvent:function(){var e=new L.Rectangle(this._shape.getBounds(),this.options.shapeOptions);L.Draw.SimpleShape.prototype._fireCreatedEvent.call(this,e)},_getTooltipText:function(){var e,i,s,d=L.Draw.SimpleShape.prototype._getTooltipText.call(this),v=this._shape,y=this.options.showArea;return v&&(e=this._shape._defaultShape?this._shape._defaultShape():this._shape.getLatLngs(),i=L.GeometryUtil.geodesicArea(e),s=y?L.GeometryUtil.readableArea(i,this.options.metric):""),{text:d.text,subtext:s}}}),L.Draw.Marker=L.Draw.Feature.extend({statics:{TYPE:"marker"},options:{icon:new L.Icon.Default,repeatMode:!1,zIndexOffset:2e3},initialize:function(e,i){this.type=L.Draw.Marker.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.marker.tooltip.start,L.Draw.Feature.prototype.initialize.call(this,e,i)},addHooks:function(){L.Draw.Feature.prototype.addHooks.call(this),this._map&&(this._tooltip.updateContent({text:this._initialLabelText}),this._mouseMarker||(this._mouseMarker=L.marker(this._map.getCenter(),{icon:L.divIcon({className:"leaflet-mouse-marker",iconAnchor:[20,20],iconSize:[40,40]}),opacity:0,zIndexOffset:this.options.zIndexOffset})),this._mouseMarker.on("click",this._onClick,this).addTo(this._map),this._map.on("mousemove",this._onMouseMove,this),this._map.on("click",this._onTouch,this))},removeHooks:function(){L.Draw.Feature.prototype.removeHooks.call(this),this._map&&(this._map.off("click",this._onClick,this).off("click",this._onTouch,this),this._marker&&(this._marker.off("click",this._onClick,this),this._map.removeLayer(this._marker),delete this._marker),this._mouseMarker.off("click",this._onClick,this),this._map.removeLayer(this._mouseMarker),delete this._mouseMarker,this._map.off("mousemove",this._onMouseMove,this))},_onMouseMove:function(e){var i=e.latlng;this._tooltip.updatePosition(i),this._mouseMarker.setLatLng(i),this._marker?(i=this._mouseMarker.getLatLng(),this._marker.setLatLng(i)):(this._marker=this._createMarker(i),this._marker.on("click",this._onClick,this),this._map.on("click",this._onClick,this).addLayer(this._marker))},_createMarker:function(e){return new L.Marker(e,{icon:this.options.icon,zIndexOffset:this.options.zIndexOffset})},_onClick:function(){this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable()},_onTouch:function(e){this._onMouseMove(e),this._onClick()},_fireCreatedEvent:function(){var e=new L.Marker.Touch(this._marker.getLatLng(),{icon:this.options.icon});L.Draw.Feature.prototype._fireCreatedEvent.call(this,e)}}),L.Draw.CircleMarker=L.Draw.Marker.extend({statics:{TYPE:"circlemarker"},options:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0,zIndexOffset:2e3},initialize:function(e,i){this.type=L.Draw.CircleMarker.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.circlemarker.tooltip.start,L.Draw.Feature.prototype.initialize.call(this,e,i)},_fireCreatedEvent:function(){var e=new L.CircleMarker(this._marker.getLatLng(),this.options);L.Draw.Feature.prototype._fireCreatedEvent.call(this,e)},_createMarker:function(e){return new L.CircleMarker(e,this.options)}}),L.Draw.Circle=L.Draw.SimpleShape.extend({statics:{TYPE:"circle"},options:{shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0},showRadius:!0,metric:!0,feet:!0,nautic:!1},initialize:function(e,i){this.type=L.Draw.Circle.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.circle.tooltip.start,L.Draw.SimpleShape.prototype.initialize.call(this,e,i)},_drawShape:function(e){if(L.GeometryUtil.isVersion07x())var i=this._startLatLng.distanceTo(e);else var i=this._map.distance(this._startLatLng,e);this._shape?this._shape.setRadius(i):(this._shape=new L.Circle(this._startLatLng,i,this.options.shapeOptions),this._map.addLayer(this._shape))},_fireCreatedEvent:function(){var e=new L.Circle(this._startLatLng,this._shape.getRadius(),this.options.shapeOptions);L.Draw.SimpleShape.prototype._fireCreatedEvent.call(this,e)},_onMouseMove:function(e){var i,s=e.latlng,d=this.options.showRadius,v=this.options.metric;if(this._tooltip.updatePosition(s),this._isDrawing){this._drawShape(s),i=this._shape.getRadius().toFixed(1);var y="";d&&(y=L.drawLocal.draw.handlers.circle.radius+": "+L.GeometryUtil.readableDistance(i,v,this.options.feet,this.options.nautic)),this._tooltip.updateContent({text:this._endLabelText,subtext:y})}}}),L.Edit=L.Edit||{},L.Edit.Marker=L.Handler.extend({initialize:function(e,i){this._marker=e,L.setOptions(this,i)},addHooks:function(){var e=this._marker;e.dragging.enable(),e.on("dragend",this._onDragEnd,e),this._toggleMarkerHighlight()},removeHooks:function(){var e=this._marker;e.dragging.disable(),e.off("dragend",this._onDragEnd,e),this._toggleMarkerHighlight()},_onDragEnd:function(e){var i=e.target;i.edited=!0,this._map.fire(L.Draw.Event.EDITMOVE,{layer:i})},_toggleMarkerHighlight:function(){var e=this._marker._icon;e&&(e.style.display="none",L.DomUtil.hasClass(e,"leaflet-edit-marker-selected")?(L.DomUtil.removeClass(e,"leaflet-edit-marker-selected"),this._offsetMarker(e,-4)):(L.DomUtil.addClass(e,"leaflet-edit-marker-selected"),this._offsetMarker(e,4)),e.style.display="")},_offsetMarker:function(e,i){var s=parseInt(e.style.marginTop,10)-i,d=parseInt(e.style.marginLeft,10)-i;e.style.marginTop=s+"px",e.style.marginLeft=d+"px"}}),L.Marker.addInitHook(function(){L.Edit.Marker&&(this.editing=new L.Edit.Marker(this),this.options.editable&&this.editing.enable())}),L.Edit=L.Edit||{},L.Edit.Poly=L.Handler.extend({initialize:function(e){this.latlngs=[e._latlngs],e._holes&&(this.latlngs=this.latlngs.concat(e._holes)),this._poly=e,this._poly.on("revert-edited",this._updateLatLngs,this)},_defaultShape:function(){return L.Polyline._flat?L.Polyline._flat(this._poly._latlngs)?this._poly._latlngs:this._poly._latlngs[0]:this._poly._latlngs},_eachVertexHandler:function(e){for(var i=0;i<this._verticesHandlers.length;i++)e(this._verticesHandlers[i])},addHooks:function(){this._initHandlers(),this._eachVertexHandler(function(e){e.addHooks()})},removeHooks:function(){this._eachVertexHandler(function(e){e.removeHooks()})},updateMarkers:function(){this._eachVertexHandler(function(e){e.updateMarkers()})},_initHandlers:function(){this._verticesHandlers=[];for(var e=0;e<this.latlngs.length;e++)this._verticesHandlers.push(new L.Edit.PolyVerticesEdit(this._poly,this.latlngs[e],this._poly.options.poly))},_updateLatLngs:function(e){this.latlngs=[e.layer._latlngs],e.layer._holes&&(this.latlngs=this.latlngs.concat(e.layer._holes))}}),L.Edit.PolyVerticesEdit=L.Handler.extend({options:{icon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon"}),touchIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-touch-icon"}),drawError:{color:"#b00b00",timeout:1e3}},initialize:function(e,i,s){L.Browser.touch&&(this.options.icon=this.options.touchIcon),this._poly=e,s&&s.drawError&&(s.drawError=L.Util.extend({},this.options.drawError,s.drawError)),this._latlngs=i,L.setOptions(this,s)},_defaultShape:function(){return L.Polyline._flat?L.Polyline._flat(this._latlngs)?this._latlngs:this._latlngs[0]:this._latlngs},addHooks:function(){var e=this._poly,i=e._path;e instanceof L.Polygon||(e.options.fill=!1,e.options.editing&&(e.options.editing.fill=!1)),i&&e.options.editing&&e.options.editing.className&&(e.options.original.className&&e.options.original.className.split(" ").forEach(function(s){L.DomUtil.removeClass(i,s)}),e.options.editing.className.split(" ").forEach(function(s){L.DomUtil.addClass(i,s)})),e.setStyle(e.options.editing),this._poly._map&&(this._map=this._poly._map,this._markerGroup||this._initMarkers(),this._poly._map.addLayer(this._markerGroup))},removeHooks:function(){var e=this._poly,i=e._path;i&&e.options.editing&&e.options.editing.className&&(e.options.editing.className.split(" ").forEach(function(s){L.DomUtil.removeClass(i,s)}),e.options.original.className&&e.options.original.className.split(" ").forEach(function(s){L.DomUtil.addClass(i,s)})),e.setStyle(e.options.original),e._map&&(e._map.removeLayer(this._markerGroup),delete this._markerGroup,delete this._markers)},updateMarkers:function(){this._markerGroup.clearLayers(),this._initMarkers()},_initMarkers:function(){this._markerGroup||(this._markerGroup=new L.LayerGroup),this._markers=[];var e,i,s,d,v=this._defaultShape();for(e=0,s=v.length;e<s;e++)d=this._createMarker(v[e],e),d.on("click",this._onMarkerClick,this),d.on("contextmenu",this._onContextMenu,this),this._markers.push(d);var y,w;for(e=0,i=s-1;e<s;i=e++)(e!==0||L.Polygon&&this._poly instanceof L.Polygon)&&(y=this._markers[i],w=this._markers[e],this._createMiddleMarker(y,w),this._updatePrevNext(y,w))},_createMarker:function(e,i){var s=new L.Marker.Touch(e,{draggable:!0,icon:this.options.icon});return s._origLatLng=e,s._index=i,s.on("dragstart",this._onMarkerDragStart,this).on("drag",this._onMarkerDrag,this).on("dragend",this._fireEdit,this).on("touchmove",this._onTouchMove,this).on("touchend",this._fireEdit,this).on("MSPointerMove",this._onTouchMove,this).on("MSPointerUp",this._fireEdit,this),this._markerGroup.addLayer(s),s},_onMarkerDragStart:function(){this._poly.fire("editstart")},_spliceLatLngs:function(){var e=this._defaultShape(),i=[].splice.apply(e,arguments);return this._poly._convertLatLngs(e,!0),this._poly.redraw(),i},_removeMarker:function(e){var i=e._index;this._markerGroup.removeLayer(e),this._markers.splice(i,1),this._spliceLatLngs(i,1),this._updateIndexes(i,-1),e.off("dragstart",this._onMarkerDragStart,this).off("drag",this._onMarkerDrag,this).off("dragend",this._fireEdit,this).off("touchmove",this._onMarkerDrag,this).off("touchend",this._fireEdit,this).off("click",this._onMarkerClick,this).off("MSPointerMove",this._onTouchMove,this).off("MSPointerUp",this._fireEdit,this)},_fireEdit:function(){this._poly.edited=!0,this._poly.fire("edit"),this._poly._map.fire(L.Draw.Event.EDITVERTEX,{layers:this._markerGroup,poly:this._poly})},_onMarkerDrag:function(e){var i=e.target,s=this._poly,d=L.LatLngUtil.cloneLatLng(i._origLatLng);if(L.extend(i._origLatLng,i._latlng),s.options.poly){var v=s._map._editTooltip;if(!s.options.poly.allowIntersection&&s.intersects()){L.extend(i._origLatLng,d),i.setLatLng(d);var y=s.options.color;s.setStyle({color:this.options.drawError.color}),v&&v.updateContent({text:L.drawLocal.draw.handlers.polyline.error}),setTimeout(function(){s.setStyle({color:y}),v&&v.updateContent({text:L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.edit.handlers.edit.tooltip.subtext})},1e3)}}i._middleLeft&&i._middleLeft.setLatLng(this._getMiddleLatLng(i._prev,i)),i._middleRight&&i._middleRight.setLatLng(this._getMiddleLatLng(i,i._next)),this._poly._bounds._southWest=L.latLng(1/0,1/0),this._poly._bounds._northEast=L.latLng(-1/0,-1/0);var w=this._poly.getLatLngs();this._poly._convertLatLngs(w,!0),this._poly.redraw(),this._poly.fire("editdrag")},_onMarkerClick:function(e){var i=L.Polygon&&this._poly instanceof L.Polygon?4:3,s=e.target;this._defaultShape().length<i||(this._removeMarker(s),this._updatePrevNext(s._prev,s._next),s._middleLeft&&this._markerGroup.removeLayer(s._middleLeft),s._middleRight&&this._markerGroup.removeLayer(s._middleRight),s._prev&&s._next?this._createMiddleMarker(s._prev,s._next):s._prev?s._next||(s._prev._middleRight=null):s._next._middleLeft=null,this._fireEdit())},_onContextMenu:function(e){var i=e.target;this._poly,this._poly._map.fire(L.Draw.Event.MARKERCONTEXT,{marker:i,layers:this._markerGroup,poly:this._poly}),L.DomEvent.stopPropagation},_onTouchMove:function(e){var i=this._map.mouseEventToLayerPoint(e.originalEvent.touches[0]),s=this._map.layerPointToLatLng(i),d=e.target;L.extend(d._origLatLng,s),d._middleLeft&&d._middleLeft.setLatLng(this._getMiddleLatLng(d._prev,d)),d._middleRight&&d._middleRight.setLatLng(this._getMiddleLatLng(d,d._next)),this._poly.redraw(),this.updateMarkers()},_updateIndexes:function(e,i){this._markerGroup.eachLayer(function(s){s._index>e&&(s._index+=i)})},_createMiddleMarker:function(e,i){var s,d,v,y=this._getMiddleLatLng(e,i),w=this._createMarker(y);w.setOpacity(.6),e._middleRight=i._middleLeft=w,d=function(){w.off("touchmove",d,this);var x=i._index;w._index=x,w.off("click",s,this).on("click",this._onMarkerClick,this),y.lat=w.getLatLng().lat,y.lng=w.getLatLng().lng,this._spliceLatLngs(x,0,y),this._markers.splice(x,0,w),w.setOpacity(1),this._updateIndexes(x,1),i._index++,this._updatePrevNext(e,w),this._updatePrevNext(w,i),this._poly.fire("editstart")},v=function(){w.off("dragstart",d,this),w.off("dragend",v,this),w.off("touchmove",d,this),this._createMiddleMarker(e,w),this._createMiddleMarker(w,i)},s=function(){d.call(this),v.call(this),this._fireEdit()},w.on("click",s,this).on("dragstart",d,this).on("dragend",v,this).on("touchmove",d,this),this._markerGroup.addLayer(w)},_updatePrevNext:function(e,i){e&&(e._next=i),i&&(i._prev=e)},_getMiddleLatLng:function(e,i){var s=this._poly._map,d=s.project(e.getLatLng()),v=s.project(i.getLatLng());return s.unproject(d._add(v)._divideBy(2))}}),L.Polyline.addInitHook(function(){this.editing||(L.Edit.Poly&&(this.editing=new L.Edit.Poly(this),this.options.editable&&this.editing.enable()),this.on("add",function(){this.editing&&this.editing.enabled()&&this.editing.addHooks()}),this.on("remove",function(){this.editing&&this.editing.enabled()&&this.editing.removeHooks()}))}),L.Edit=L.Edit||{},L.Edit.SimpleShape=L.Handler.extend({options:{moveIcon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-move"}),resizeIcon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-resize"}),touchMoveIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-move leaflet-touch-icon"}),touchResizeIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-resize leaflet-touch-icon"})},initialize:function(e,i){L.Browser.touch&&(this.options.moveIcon=this.options.touchMoveIcon,this.options.resizeIcon=this.options.touchResizeIcon),this._shape=e,L.Util.setOptions(this,i)},addHooks:function(){var e=this._shape;this._shape._map&&(this._map=this._shape._map,e.setStyle(e.options.editing),e._map&&(this._map=e._map,this._markerGroup||this._initMarkers(),this._map.addLayer(this._markerGroup)))},removeHooks:function(){var e=this._shape;if(e.setStyle(e.options.original),e._map){this._unbindMarker(this._moveMarker);for(var i=0,s=this._resizeMarkers.length;i<s;i++)this._unbindMarker(this._resizeMarkers[i]);this._resizeMarkers=null,this._map.removeLayer(this._markerGroup),delete this._markerGroup}this._map=null},updateMarkers:function(){this._markerGroup.clearLayers(),this._initMarkers()},_initMarkers:function(){this._markerGroup||(this._markerGroup=new L.LayerGroup),this._createMoveMarker(),this._createResizeMarker()},_createMoveMarker:function(){},_createResizeMarker:function(){},_createMarker:function(e,i){var s=new L.Marker.Touch(e,{draggable:!0,icon:i,zIndexOffset:10});return this._bindMarker(s),this._markerGroup.addLayer(s),s},_bindMarker:function(e){e.on("dragstart",this._onMarkerDragStart,this).on("drag",this._onMarkerDrag,this).on("dragend",this._onMarkerDragEnd,this).on("touchstart",this._onTouchStart,this).on("touchmove",this._onTouchMove,this).on("MSPointerMove",this._onTouchMove,this).on("touchend",this._onTouchEnd,this).on("MSPointerUp",this._onTouchEnd,this)},_unbindMarker:function(e){e.off("dragstart",this._onMarkerDragStart,this).off("drag",this._onMarkerDrag,this).off("dragend",this._onMarkerDragEnd,this).off("touchstart",this._onTouchStart,this).off("touchmove",this._onTouchMove,this).off("MSPointerMove",this._onTouchMove,this).off("touchend",this._onTouchEnd,this).off("MSPointerUp",this._onTouchEnd,this)},_onMarkerDragStart:function(e){e.target.setOpacity(0),this._shape.fire("editstart")},_fireEdit:function(){this._shape.edited=!0,this._shape.fire("edit")},_onMarkerDrag:function(e){var i=e.target,s=i.getLatLng();i===this._moveMarker?this._move(s):this._resize(s),this._shape.redraw(),this._shape.fire("editdrag")},_onMarkerDragEnd:function(e){e.target.setOpacity(1),this._fireEdit()},_onTouchStart:function(e){if(L.Edit.SimpleShape.prototype._onMarkerDragStart.call(this,e),typeof this._getCorners=="function"){var i=this._getCorners(),s=e.target,d=s._cornerIndex;s.setOpacity(0),this._oppositeCorner=i[(d+2)%4],this._toggleCornerMarkers(0,d)}this._shape.fire("editstart")},_onTouchMove:function(e){var i=this._map.mouseEventToLayerPoint(e.originalEvent.touches[0]),s=this._map.layerPointToLatLng(i);return e.target===this._moveMarker?this._move(s):this._resize(s),this._shape.redraw(),!1},_onTouchEnd:function(e){e.target.setOpacity(1),this.updateMarkers(),this._fireEdit()},_move:function(){},_resize:function(){}}),L.Edit=L.Edit||{},L.Edit.Rectangle=L.Edit.SimpleShape.extend({_createMoveMarker:function(){var e=this._shape.getBounds(),i=e.getCenter();this._moveMarker=this._createMarker(i,this.options.moveIcon)},_createResizeMarker:function(){var e=this._getCorners();this._resizeMarkers=[];for(var i=0,s=e.length;i<s;i++)this._resizeMarkers.push(this._createMarker(e[i],this.options.resizeIcon)),this._resizeMarkers[i]._cornerIndex=i},_onMarkerDragStart:function(e){L.Edit.SimpleShape.prototype._onMarkerDragStart.call(this,e);var i=this._getCorners(),s=e.target,d=s._cornerIndex;this._oppositeCorner=i[(d+2)%4],this._toggleCornerMarkers(0,d)},_onMarkerDragEnd:function(e){var i,s,d=e.target;d===this._moveMarker&&(i=this._shape.getBounds(),s=i.getCenter(),d.setLatLng(s)),this._toggleCornerMarkers(1),this._repositionCornerMarkers(),L.Edit.SimpleShape.prototype._onMarkerDragEnd.call(this,e)},_move:function(e){for(var i,s=this._shape._defaultShape?this._shape._defaultShape():this._shape.getLatLngs(),d=this._shape.getBounds(),v=d.getCenter(),y=[],w=0,x=s.length;w<x;w++)i=[s[w].lat-v.lat,s[w].lng-v.lng],y.push([e.lat+i[0],e.lng+i[1]]);this._shape.setLatLngs(y),this._repositionCornerMarkers(),this._map.fire(L.Draw.Event.EDITMOVE,{layer:this._shape})},_resize:function(e){var i;this._shape.setBounds(L.latLngBounds(e,this._oppositeCorner)),i=this._shape.getBounds(),this._moveMarker.setLatLng(i.getCenter()),this._map.fire(L.Draw.Event.EDITRESIZE,{layer:this._shape})},_getCorners:function(){var e=this._shape.getBounds();return[e.getNorthWest(),e.getNorthEast(),e.getSouthEast(),e.getSouthWest()]},_toggleCornerMarkers:function(e){for(var i=0,s=this._resizeMarkers.length;i<s;i++)this._resizeMarkers[i].setOpacity(e)},_repositionCornerMarkers:function(){for(var e=this._getCorners(),i=0,s=this._resizeMarkers.length;i<s;i++)this._resizeMarkers[i].setLatLng(e[i])}}),L.Rectangle.addInitHook(function(){L.Edit.Rectangle&&(this.editing=new L.Edit.Rectangle(this),this.options.editable&&this.editing.enable())}),L.Edit=L.Edit||{},L.Edit.CircleMarker=L.Edit.SimpleShape.extend({_createMoveMarker:function(){var e=this._shape.getLatLng();this._moveMarker=this._createMarker(e,this.options.moveIcon)},_createResizeMarker:function(){this._resizeMarkers=[]},_move:function(e){if(this._resizeMarkers.length){var i=this._getResizeMarkerPoint(e);this._resizeMarkers[0].setLatLng(i)}this._shape.setLatLng(e),this._map.fire(L.Draw.Event.EDITMOVE,{layer:this._shape})}}),L.CircleMarker.addInitHook(function(){L.Edit.CircleMarker&&(this.editing=new L.Edit.CircleMarker(this),this.options.editable&&this.editing.enable()),this.on("add",function(){this.editing&&this.editing.enabled()&&this.editing.addHooks()}),this.on("remove",function(){this.editing&&this.editing.enabled()&&this.editing.removeHooks()})}),L.Edit=L.Edit||{},L.Edit.Circle=L.Edit.CircleMarker.extend({_createResizeMarker:function(){var e=this._shape.getLatLng(),i=this._getResizeMarkerPoint(e);this._resizeMarkers=[],this._resizeMarkers.push(this._createMarker(i,this.options.resizeIcon))},_getResizeMarkerPoint:function(e){var i=this._shape._radius*Math.cos(Math.PI/4),s=this._map.project(e);return this._map.unproject([s.x+i,s.y-i])},_resize:function(e){var i=this._moveMarker.getLatLng();L.GeometryUtil.isVersion07x()?radius=i.distanceTo(e):radius=this._map.distance(i,e),this._shape.setRadius(radius),this._map.editTooltip&&this._map._editTooltip.updateContent({text:L.drawLocal.edit.handlers.edit.tooltip.subtext+"<br />"+L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.draw.handlers.circle.radius+": "+L.GeometryUtil.readableDistance(radius,!0,this.options.feet,this.options.nautic)}),this._shape.setRadius(radius),this._map.fire(L.Draw.Event.EDITRESIZE,{layer:this._shape})}}),L.Circle.addInitHook(function(){L.Edit.Circle&&(this.editing=new L.Edit.Circle(this),this.options.editable&&this.editing.enable())}),L.Map.mergeOptions({touchExtend:!0}),L.Map.TouchExtend=L.Handler.extend({initialize:function(e){this._map=e,this._container=e._container,this._pane=e._panes.overlayPane},addHooks:function(){L.DomEvent.on(this._container,"touchstart",this._onTouchStart,this),L.DomEvent.on(this._container,"touchend",this._onTouchEnd,this),L.DomEvent.on(this._container,"touchmove",this._onTouchMove,this),this._detectIE()?(L.DomEvent.on(this._container,"MSPointerDown",this._onTouchStart,this),L.DomEvent.on(this._container,"MSPointerUp",this._onTouchEnd,this),L.DomEvent.on(this._container,"MSPointerMove",this._onTouchMove,this),L.DomEvent.on(this._container,"MSPointerCancel",this._onTouchCancel,this)):(L.DomEvent.on(this._container,"touchcancel",this._onTouchCancel,this),L.DomEvent.on(this._container,"touchleave",this._onTouchLeave,this))},removeHooks:function(){L.DomEvent.off(this._container,"touchstart",this._onTouchStart,this),L.DomEvent.off(this._container,"touchend",this._onTouchEnd,this),L.DomEvent.off(this._container,"touchmove",this._onTouchMove,this),this._detectIE()?(L.DomEvent.off(this._container,"MSPointerDown",this._onTouchStart,this),L.DomEvent.off(this._container,"MSPointerUp",this._onTouchEnd,this),L.DomEvent.off(this._container,"MSPointerMove",this._onTouchMove,this),L.DomEvent.off(this._container,"MSPointerCancel",this._onTouchCancel,this)):(L.DomEvent.off(this._container,"touchcancel",this._onTouchCancel,this),L.DomEvent.off(this._container,"touchleave",this._onTouchLeave,this))},_touchEvent:function(e,i){var s={};if(e.touches!==void 0){if(!e.touches.length)return;s=e.touches[0]}else if(e.pointerType!=="touch"||(s=e,!this._filterClick(e)))return;var d=this._map.mouseEventToContainerPoint(s),v=this._map.mouseEventToLayerPoint(s),y=this._map.layerPointToLatLng(v);this._map.fire(i,{latlng:y,layerPoint:v,containerPoint:d,pageX:s.pageX,pageY:s.pageY,originalEvent:e})},_filterClick:function(e){var i=e.timeStamp||e.originalEvent.timeStamp,s=L.DomEvent._lastClick&&i-L.DomEvent._lastClick;return s&&s>100&&s<500||e.target._simulatedClick&&!e._simulated?(L.DomEvent.stop(e),!1):(L.DomEvent._lastClick=i,!0)},_onTouchStart:function(e){this._map._loaded&&this._touchEvent(e,"touchstart")},_onTouchEnd:function(e){this._map._loaded&&this._touchEvent(e,"touchend")},_onTouchCancel:function(e){if(this._map._loaded){var i="touchcancel";this._detectIE()&&(i="pointercancel"),this._touchEvent(e,i)}},_onTouchLeave:function(e){this._map._loaded&&this._touchEvent(e,"touchleave")},_onTouchMove:function(e){this._map._loaded&&this._touchEvent(e,"touchmove")},_detectIE:function(){var e=o.navigator.userAgent,i=e.indexOf("MSIE ");if(i>0)return parseInt(e.substring(i+5,e.indexOf(".",i)),10);if(e.indexOf("Trident/")>0){var s=e.indexOf("rv:");return parseInt(e.substring(s+3,e.indexOf(".",s)),10)}var d=e.indexOf("Edge/");return d>0&&parseInt(e.substring(d+5,e.indexOf(".",d)),10)}}),L.Map.addInitHook("addHandler","touchExtend",L.Map.TouchExtend),L.Marker.Touch=L.Marker.extend({_initInteraction:function(){return this.addInteractiveTarget?L.Marker.prototype._initInteraction.apply(this):this._initInteractionLegacy()},_initInteractionLegacy:function(){if(this.options.clickable){var e=this._icon,i=["dblclick","mousedown","mouseover","mouseout","contextmenu","touchstart","touchend","touchmove"];this._detectIE?i.concat(["MSPointerDown","MSPointerUp","MSPointerMove","MSPointerCancel"]):i.concat(["touchcancel"]),L.DomUtil.addClass(e,"leaflet-clickable"),L.DomEvent.on(e,"click",this._onMouseClick,this),L.DomEvent.on(e,"keypress",this._onKeyPress,this);for(var s=0;s<i.length;s++)L.DomEvent.on(e,i[s],this._fireMouseEvent,this);L.Handler.MarkerDrag&&(this.dragging=new L.Handler.MarkerDrag(this),this.options.draggable&&this.dragging.enable())}},_detectIE:function(){var e=o.navigator.userAgent,i=e.indexOf("MSIE ");if(i>0)return parseInt(e.substring(i+5,e.indexOf(".",i)),10);if(e.indexOf("Trident/")>0){var s=e.indexOf("rv:");return parseInt(e.substring(s+3,e.indexOf(".",s)),10)}var d=e.indexOf("Edge/");return d>0&&parseInt(e.substring(d+5,e.indexOf(".",d)),10)}}),L.LatLngUtil={cloneLatLngs:function(e){for(var i=[],s=0,d=e.length;s<d;s++)Array.isArray(e[s])?i.push(L.LatLngUtil.cloneLatLngs(e[s])):i.push(this.cloneLatLng(e[s]));return i},cloneLatLng:function(e){return L.latLng(e.lat,e.lng)}},function(){var e={km:2,ha:2,m:0,mi:2,ac:2,yd:0,ft:0,nm:2};L.GeometryUtil=L.extend(L.GeometryUtil||{},{geodesicArea:function(i){var s,d,v=i.length,y=0,w=Math.PI/180;if(v>2){for(var x=0;x<v;x++)s=i[x],d=i[(x+1)%v],y+=(d.lng-s.lng)*w*(2+Math.sin(s.lat*w)+Math.sin(d.lat*w));y=6378137*y*6378137/2}return Math.abs(y)},formattedNumber:function(i,s){var d=parseFloat(i).toFixed(s),v=L.drawLocal.format&&L.drawLocal.format.numeric,y=v&&v.delimiters,w=y&&y.thousands,x=y&&y.decimal;if(w||x){var Z=d.split(".");d=w?Z[0].replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1"+w):Z[0],x=x||".",Z.length>1&&(d=d+x+Z[1])}return d},readableArea:function(i,s,w){var v,y,w=L.Util.extend({},e,w);return s?(y=["ha","m"],type=typeof s,type==="string"?y=[s]:type!=="boolean"&&(y=s),v=i>=1e6&&y.indexOf("km")!==-1?L.GeometryUtil.formattedNumber(1e-6*i,w.km)+" km\xB2":i>=1e4&&y.indexOf("ha")!==-1?L.GeometryUtil.formattedNumber(1e-4*i,w.ha)+" ha":L.GeometryUtil.formattedNumber(i,w.m)+" m\xB2"):(i/=.836127,v=i>=3097600?L.GeometryUtil.formattedNumber(i/3097600,w.mi)+" mi\xB2":i>=4840?L.GeometryUtil.formattedNumber(i/4840,w.ac)+" acres":L.GeometryUtil.formattedNumber(i,w.yd)+" yd\xB2"),v},readableDistance:function(i,s,d,v,x){var w,x=L.Util.extend({},e,x);switch(s?typeof s=="string"?s:"metric":d?"feet":v?"nauticalMile":"yards"){case"metric":w=i>1e3?L.GeometryUtil.formattedNumber(i/1e3,x.km)+" km":L.GeometryUtil.formattedNumber(i,x.m)+" m";break;case"feet":i*=3.28083,w=L.GeometryUtil.formattedNumber(i,x.ft)+" ft";break;case"nauticalMile":i*=.53996,w=L.GeometryUtil.formattedNumber(i/1e3,x.nm)+" nm";break;case"yards":default:i*=1.09361,w=i>1760?L.GeometryUtil.formattedNumber(i/1760,x.mi)+" miles":L.GeometryUtil.formattedNumber(i,x.yd)+" yd"}return w},isVersion07x:function(){var i=L.version.split(".");return parseInt(i[0],10)===0&&parseInt(i[1],10)===7}})}(),L.Util.extend(L.LineUtil,{segmentsIntersect:function(e,i,s,d){return this._checkCounterclockwise(e,s,d)!==this._checkCounterclockwise(i,s,d)&&this._checkCounterclockwise(e,i,s)!==this._checkCounterclockwise(e,i,d)},_checkCounterclockwise:function(e,i,s){return(s.y-e.y)*(i.x-e.x)>(i.y-e.y)*(s.x-e.x)}}),L.Polyline.include({intersects:function(){var e,i,s,d=this._getProjectedPoints(),v=d?d.length:0;if(this._tooFewPointsForIntersection())return!1;for(e=v-1;e>=3;e--)if(i=d[e-1],s=d[e],this._lineSegmentsIntersectsRange(i,s,e-2))return!0;return!1},newLatLngIntersects:function(e,i){return!!this._map&&this.newPointIntersects(this._map.latLngToLayerPoint(e),i)},newPointIntersects:function(e,i){var s=this._getProjectedPoints(),d=s?s.length:0,v=s?s[d-1]:null,y=d-2;return!this._tooFewPointsForIntersection(1)&&this._lineSegmentsIntersectsRange(v,e,y,i?1:0)},_tooFewPointsForIntersection:function(e){var i=this._getProjectedPoints(),s=i?i.length:0;return s+=e||0,!i||s<=3},_lineSegmentsIntersectsRange:function(e,i,s,d){var v,y,w=this._getProjectedPoints();d=d||0;for(var x=s;x>d;x--)if(v=w[x-1],y=w[x],L.LineUtil.segmentsIntersect(e,i,v,y))return!0;return!1},_getProjectedPoints:function(){if(!this._defaultShape)return this._originalPoints;for(var e=[],i=this._defaultShape(),s=0;s<i.length;s++)e.push(this._map.latLngToLayerPoint(i[s]));return e}}),L.Polygon.include({intersects:function(){var e,i,s,d,v=this._getProjectedPoints();return!this._tooFewPointsForIntersection()&&(!!L.Polyline.prototype.intersects.call(this)||(e=v.length,i=v[0],s=v[e-1],d=e-2,this._lineSegmentsIntersectsRange(s,i,d,1)))}}),L.Control.Draw=L.Control.extend({options:{position:"topleft",draw:{},edit:!1},initialize:function(e){if(L.version<"0.7")throw new Error("Leaflet.draw 0.2.3+ requires Leaflet 0.7.0+. Download latest from https://github.com/Leaflet/Leaflet/");L.Control.prototype.initialize.call(this,e);var i;this._toolbars={},L.DrawToolbar&&this.options.draw&&(i=new L.DrawToolbar(this.options.draw),this._toolbars[L.DrawToolbar.TYPE]=i,this._toolbars[L.DrawToolbar.TYPE].on("enable",this._toolbarEnabled,this)),L.EditToolbar&&this.options.edit&&(i=new L.EditToolbar(this.options.edit),this._toolbars[L.EditToolbar.TYPE]=i,this._toolbars[L.EditToolbar.TYPE].on("enable",this._toolbarEnabled,this)),L.toolbar=this},onAdd:function(e){var i,s=L.DomUtil.create("div","leaflet-draw"),d=!1;for(var v in this._toolbars)this._toolbars.hasOwnProperty(v)&&(i=this._toolbars[v].addToolbar(e))&&(d||(L.DomUtil.hasClass(i,"leaflet-draw-toolbar-top")||L.DomUtil.addClass(i.childNodes[0],"leaflet-draw-toolbar-top"),d=!0),s.appendChild(i));return s},onRemove:function(){for(var e in this._toolbars)this._toolbars.hasOwnProperty(e)&&this._toolbars[e].removeToolbar()},setDrawingOptions:function(e){for(var i in this._toolbars)this._toolbars[i]instanceof L.DrawToolbar&&this._toolbars[i].setOptions(e)},_toolbarEnabled:function(e){var i=e.target;for(var s in this._toolbars)this._toolbars[s]!==i&&this._toolbars[s].disable()}}),L.Map.mergeOptions({drawControlTooltips:!0,drawControl:!1}),L.Map.addInitHook(function(){this.options.drawControl&&(this.drawControl=new L.Control.Draw,this.addControl(this.drawControl))}),L.Toolbar=L.Class.extend({initialize:function(e){L.setOptions(this,e),this._modes={},this._actionButtons=[],this._activeMode=null;var i=L.version.split(".");parseInt(i[0],10)===1&&parseInt(i[1],10)>=2?L.Toolbar.include(L.Evented.prototype):L.Toolbar.include(L.Mixin.Events)},enabled:function(){return this._activeMode!==null},disable:function(){this.enabled()&&this._activeMode.handler.disable()},addToolbar:function(e){var i,s=L.DomUtil.create("div","leaflet-draw-section"),d=0,v=this._toolbarClass||"",y=this.getModeHandlers(e);for(this._toolbarContainer=L.DomUtil.create("div","leaflet-draw-toolbar leaflet-bar"),this._map=e,i=0;i<y.length;i++)y[i].enabled&&this._initModeHandler(y[i].handler,this._toolbarContainer,d++,v,y[i].title);if(d)return this._lastButtonIndex=--d,this._actionsContainer=L.DomUtil.create("ul","leaflet-draw-actions"),s.appendChild(this._toolbarContainer),s.appendChild(this._actionsContainer),s},removeToolbar:function(){for(var e in this._modes)this._modes.hasOwnProperty(e)&&(this._disposeButton(this._modes[e].button,this._modes[e].handler.enable,this._modes[e].handler),this._modes[e].handler.disable(),this._modes[e].handler.off("enabled",this._handlerActivated,this).off("disabled",this._handlerDeactivated,this));this._modes={};for(var i=0,s=this._actionButtons.length;i<s;i++)this._disposeButton(this._actionButtons[i].button,this._actionButtons[i].callback,this);this._actionButtons=[],this._actionsContainer=null},_initModeHandler:function(e,i,s,d,v){var y=e.type;this._modes[y]={},this._modes[y].handler=e,this._modes[y].button=this._createButton({type:y,title:v,className:d+"-"+y,container:i,callback:this._modes[y].handler.enable,context:this._modes[y].handler}),this._modes[y].buttonIndex=s,this._modes[y].handler.on("enabled",this._handlerActivated,this).on("disabled",this._handlerDeactivated,this)},_detectIOS:function(){return/iPad|iPhone|iPod/.test(navigator.userAgent)&&!o.MSStream},_createButton:function(e){var i=L.DomUtil.create("a",e.className||"",e.container),s=L.DomUtil.create("span","sr-only",e.container);i.href="#",i.appendChild(s),e.title&&(i.title=e.title,s.innerHTML=e.title),e.text&&(i.innerHTML=e.text,s.innerHTML=e.text);var d=this._detectIOS()?"touchstart":"click";return L.DomEvent.on(i,"click",L.DomEvent.stopPropagation).on(i,"mousedown",L.DomEvent.stopPropagation).on(i,"dblclick",L.DomEvent.stopPropagation).on(i,"touchstart",L.DomEvent.stopPropagation).on(i,"click",L.DomEvent.preventDefault).on(i,d,e.callback,e.context),i},_disposeButton:function(e,i){var s=this._detectIOS()?"touchstart":"click";L.DomEvent.off(e,"click",L.DomEvent.stopPropagation).off(e,"mousedown",L.DomEvent.stopPropagation).off(e,"dblclick",L.DomEvent.stopPropagation).off(e,"touchstart",L.DomEvent.stopPropagation).off(e,"click",L.DomEvent.preventDefault).off(e,s,i)},_handlerActivated:function(e){this.disable(),this._activeMode=this._modes[e.handler],L.DomUtil.addClass(this._activeMode.button,"leaflet-draw-toolbar-button-enabled"),this._showActionsToolbar(),this.fire("enable")},_handlerDeactivated:function(){this._hideActionsToolbar(),L.DomUtil.removeClass(this._activeMode.button,"leaflet-draw-toolbar-button-enabled"),this._activeMode=null,this.fire("disable")},_createActions:function(e){var i,s,d,v,y=this._actionsContainer,w=this.getActions(e),x=w.length;for(s=0,d=this._actionButtons.length;s<d;s++)this._disposeButton(this._actionButtons[s].button,this._actionButtons[s].callback);for(this._actionButtons=[];y.firstChild;)y.removeChild(y.firstChild);for(var Z=0;Z<x;Z++)"enabled"in w[Z]&&!w[Z].enabled||(i=L.DomUtil.create("li","",y),v=this._createButton({title:w[Z].title,text:w[Z].text,container:i,callback:w[Z].callback,context:w[Z].context}),this._actionButtons.push({button:v,callback:w[Z].callback}))},_showActionsToolbar:function(){var e=this._activeMode.buttonIndex,i=this._lastButtonIndex,s=this._activeMode.button.offsetTop-1;this._createActions(this._activeMode.handler),this._actionsContainer.style.top=s+"px",e===0&&(L.DomUtil.addClass(this._toolbarContainer,"leaflet-draw-toolbar-notop"),L.DomUtil.addClass(this._actionsContainer,"leaflet-draw-actions-top")),e===i&&(L.DomUtil.addClass(this._toolbarContainer,"leaflet-draw-toolbar-nobottom"),L.DomUtil.addClass(this._actionsContainer,"leaflet-draw-actions-bottom")),this._actionsContainer.style.display="block",this._map.fire(L.Draw.Event.TOOLBAROPENED)},_hideActionsToolbar:function(){this._actionsContainer.style.display="none",L.DomUtil.removeClass(this._toolbarContainer,"leaflet-draw-toolbar-notop"),L.DomUtil.removeClass(this._toolbarContainer,"leaflet-draw-toolbar-nobottom"),L.DomUtil.removeClass(this._actionsContainer,"leaflet-draw-actions-top"),L.DomUtil.removeClass(this._actionsContainer,"leaflet-draw-actions-bottom"),this._map.fire(L.Draw.Event.TOOLBARCLOSED)}}),L.Draw=L.Draw||{},L.Draw.Tooltip=L.Class.extend({initialize:function(e){this._map=e,this._popupPane=e._panes.popupPane,this._visible=!1,this._container=e.options.drawControlTooltips?L.DomUtil.create("div","leaflet-draw-tooltip",this._popupPane):null,this._singleLineLabel=!1,this._map.on("mouseout",this._onMouseOut,this)},dispose:function(){this._map.off("mouseout",this._onMouseOut,this),this._container&&(this._popupPane.removeChild(this._container),this._container=null)},updateContent:function(e){return this._container?(e.subtext=e.subtext||"",e.subtext.length!==0||this._singleLineLabel?e.subtext.length>0&&this._singleLineLabel&&(L.DomUtil.removeClass(this._container,"leaflet-draw-tooltip-single"),this._singleLineLabel=!1):(L.DomUtil.addClass(this._container,"leaflet-draw-tooltip-single"),this._singleLineLabel=!0),this._container.innerHTML=(e.subtext.length>0?'<span class="leaflet-draw-tooltip-subtext">'+e.subtext+"</span><br />":"")+"<span>"+e.text+"</span>",e.text||e.subtext?(this._visible=!0,this._container.style.visibility="inherit"):(this._visible=!1,this._container.style.visibility="hidden"),this):this},updatePosition:function(e){var i=this._map.latLngToLayerPoint(e),s=this._container;return this._container&&(this._visible&&(s.style.visibility="inherit"),L.DomUtil.setPosition(s,i)),this},showAsError:function(){return this._container&&L.DomUtil.addClass(this._container,"leaflet-error-draw-tooltip"),this},removeError:function(){return this._container&&L.DomUtil.removeClass(this._container,"leaflet-error-draw-tooltip"),this},_onMouseOut:function(){this._container&&(this._container.style.visibility="hidden")}}),L.DrawToolbar=L.Toolbar.extend({statics:{TYPE:"draw"},options:{polyline:{},polygon:{},rectangle:{},circle:{},marker:{},circlemarker:{}},initialize:function(e){for(var i in this.options)this.options.hasOwnProperty(i)&&e[i]&&(e[i]=L.extend({},this.options[i],e[i]));this._toolbarClass="leaflet-draw-draw",L.Toolbar.prototype.initialize.call(this,e)},getModeHandlers:function(e){return[{enabled:this.options.polyline,handler:new L.Draw.Polyline(e,this.options.polyline),title:L.drawLocal.draw.toolbar.buttons.polyline},{enabled:this.options.polygon,handler:new L.Draw.Polygon(e,this.options.polygon),title:L.drawLocal.draw.toolbar.buttons.polygon},{enabled:this.options.rectangle,handler:new L.Draw.Rectangle(e,this.options.rectangle),title:L.drawLocal.draw.toolbar.buttons.rectangle},{enabled:this.options.circle,handler:new L.Draw.Circle(e,this.options.circle),title:L.drawLocal.draw.toolbar.buttons.circle},{enabled:this.options.marker,handler:new L.Draw.Marker(e,this.options.marker),title:L.drawLocal.draw.toolbar.buttons.marker},{enabled:this.options.circlemarker,handler:new L.Draw.CircleMarker(e,this.options.circlemarker),title:L.drawLocal.draw.toolbar.buttons.circlemarker}]},getActions:function(e){return[{enabled:e.completeShape,title:L.drawLocal.draw.toolbar.finish.title,text:L.drawLocal.draw.toolbar.finish.text,callback:e.completeShape,context:e},{enabled:e.deleteLastVertex,title:L.drawLocal.draw.toolbar.undo.title,text:L.drawLocal.draw.toolbar.undo.text,callback:e.deleteLastVertex,context:e},{title:L.drawLocal.draw.toolbar.actions.title,text:L.drawLocal.draw.toolbar.actions.text,callback:this.disable,context:this}]},setOptions:function(e){L.setOptions(this,e);for(var i in this._modes)this._modes.hasOwnProperty(i)&&e.hasOwnProperty(i)&&this._modes[i].handler.setOptions(e[i])}}),L.EditToolbar=L.Toolbar.extend({statics:{TYPE:"edit"},options:{edit:{selectedPathOptions:{dashArray:"10, 10",fill:!0,fillColor:"#fe57a1",fillOpacity:.1,maintainColor:!1}},remove:{},poly:null,featureGroup:null},initialize:function(e){e.edit&&(e.edit.selectedPathOptions===void 0&&(e.edit.selectedPathOptions=this.options.edit.selectedPathOptions),e.edit.selectedPathOptions=L.extend({},this.options.edit.selectedPathOptions,e.edit.selectedPathOptions)),e.remove&&(e.remove=L.extend({},this.options.remove,e.remove)),e.poly&&(e.poly=L.extend({},this.options.poly,e.poly)),this._toolbarClass="leaflet-draw-edit",L.Toolbar.prototype.initialize.call(this,e),this._selectedFeatureCount=0},getModeHandlers:function(e){var i=this.options.featureGroup;return[{enabled:this.options.edit,handler:new L.EditToolbar.Edit(e,{featureGroup:i,selectedPathOptions:this.options.edit.selectedPathOptions,poly:this.options.poly}),title:L.drawLocal.edit.toolbar.buttons.edit},{enabled:this.options.remove,handler:new L.EditToolbar.Delete(e,{featureGroup:i}),title:L.drawLocal.edit.toolbar.buttons.remove}]},getActions:function(e){var i=[{title:L.drawLocal.edit.toolbar.actions.save.title,text:L.drawLocal.edit.toolbar.actions.save.text,callback:this._save,context:this},{title:L.drawLocal.edit.toolbar.actions.cancel.title,text:L.drawLocal.edit.toolbar.actions.cancel.text,callback:this.disable,context:this}];return e.removeAllLayers&&i.push({title:L.drawLocal.edit.toolbar.actions.clearAll.title,text:L.drawLocal.edit.toolbar.actions.clearAll.text,callback:this._clearAllLayers,context:this}),i},addToolbar:function(e){var i=L.Toolbar.prototype.addToolbar.call(this,e);return this._checkDisabled(),this.options.featureGroup.on("layeradd layerremove",this._checkDisabled,this),i},removeToolbar:function(){this.options.featureGroup.off("layeradd layerremove",this._checkDisabled,this),L.Toolbar.prototype.removeToolbar.call(this)},disable:function(){this.enabled()&&(this._activeMode.handler.revertLayers(),L.Toolbar.prototype.disable.call(this))},_save:function(){this._activeMode.handler.save(),this._activeMode&&this._activeMode.handler.disable()},_clearAllLayers:function(){this._activeMode.handler.removeAllLayers(),this._activeMode&&this._activeMode.handler.disable()},_checkDisabled:function(){var e,i=this.options.featureGroup,s=i.getLayers().length!==0;this.options.edit&&(e=this._modes[L.EditToolbar.Edit.TYPE].button,s?L.DomUtil.removeClass(e,"leaflet-disabled"):L.DomUtil.addClass(e,"leaflet-disabled"),e.setAttribute("title",s?L.drawLocal.edit.toolbar.buttons.edit:L.drawLocal.edit.toolbar.buttons.editDisabled)),this.options.remove&&(e=this._modes[L.EditToolbar.Delete.TYPE].button,s?L.DomUtil.removeClass(e,"leaflet-disabled"):L.DomUtil.addClass(e,"leaflet-disabled"),e.setAttribute("title",s?L.drawLocal.edit.toolbar.buttons.remove:L.drawLocal.edit.toolbar.buttons.removeDisabled))}}),L.EditToolbar.Edit=L.Handler.extend({statics:{TYPE:"edit"},initialize:function(e,i){if(L.Handler.prototype.initialize.call(this,e),L.setOptions(this,i),this._featureGroup=i.featureGroup,!(this._featureGroup instanceof L.FeatureGroup))throw new Error("options.featureGroup must be a L.FeatureGroup");this._uneditedLayerProps={},this.type=L.EditToolbar.Edit.TYPE;var s=L.version.split(".");parseInt(s[0],10)===1&&parseInt(s[1],10)>=2?L.EditToolbar.Edit.include(L.Evented.prototype):L.EditToolbar.Edit.include(L.Mixin.Events)},enable:function(){!this._enabled&&this._hasAvailableLayers()&&(this.fire("enabled",{handler:this.type}),this._map.fire(L.Draw.Event.EDITSTART,{handler:this.type}),L.Handler.prototype.enable.call(this),this._featureGroup.on("layeradd",this._enableLayerEdit,this).on("layerremove",this._disableLayerEdit,this))},disable:function(){this._enabled&&(this._featureGroup.off("layeradd",this._enableLayerEdit,this).off("layerremove",this._disableLayerEdit,this),L.Handler.prototype.disable.call(this),this._map.fire(L.Draw.Event.EDITSTOP,{handler:this.type}),this.fire("disabled",{handler:this.type}))},addHooks:function(){var e=this._map;e&&(e.getContainer().focus(),this._featureGroup.eachLayer(this._enableLayerEdit,this),this._tooltip=new L.Draw.Tooltip(this._map),this._tooltip.updateContent({text:L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.edit.handlers.edit.tooltip.subtext}),e._editTooltip=this._tooltip,this._updateTooltip(),this._map.on("mousemove",this._onMouseMove,this).on("touchmove",this._onMouseMove,this).on("MSPointerMove",this._onMouseMove,this).on(L.Draw.Event.EDITVERTEX,this._updateTooltip,this))},removeHooks:function(){this._map&&(this._featureGroup.eachLayer(this._disableLayerEdit,this),this._uneditedLayerProps={},this._tooltip.dispose(),this._tooltip=null,this._map.off("mousemove",this._onMouseMove,this).off("touchmove",this._onMouseMove,this).off("MSPointerMove",this._onMouseMove,this).off(L.Draw.Event.EDITVERTEX,this._updateTooltip,this))},revertLayers:function(){this._featureGroup.eachLayer(function(e){this._revertLayer(e)},this)},save:function(){var e=new L.LayerGroup;this._featureGroup.eachLayer(function(i){i.edited&&(e.addLayer(i),i.edited=!1)}),this._map.fire(L.Draw.Event.EDITED,{layers:e})},_backupLayer:function(e){var i=L.Util.stamp(e);this._uneditedLayerProps[i]||(e instanceof L.Polyline||e instanceof L.Polygon||e instanceof L.Rectangle?this._uneditedLayerProps[i]={latlngs:L.LatLngUtil.cloneLatLngs(e.getLatLngs())}:e instanceof L.Circle?this._uneditedLayerProps[i]={latlng:L.LatLngUtil.cloneLatLng(e.getLatLng()),radius:e.getRadius()}:(e instanceof L.Marker||e instanceof L.CircleMarker)&&(this._uneditedLayerProps[i]={latlng:L.LatLngUtil.cloneLatLng(e.getLatLng())}))},_getTooltipText:function(){return{text:L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.edit.handlers.edit.tooltip.subtext}},_updateTooltip:function(){this._tooltip.updateContent(this._getTooltipText())},_revertLayer:function(e){var i=L.Util.stamp(e);e.edited=!1,this._uneditedLayerProps.hasOwnProperty(i)&&(e instanceof L.Polyline||e instanceof L.Polygon||e instanceof L.Rectangle?e.setLatLngs(this._uneditedLayerProps[i].latlngs):e instanceof L.Circle?(e.setLatLng(this._uneditedLayerProps[i].latlng),e.setRadius(this._uneditedLayerProps[i].radius)):(e instanceof L.Marker||e instanceof L.CircleMarker)&&e.setLatLng(this._uneditedLayerProps[i].latlng),e.fire("revert-edited",{layer:e}))},_enableLayerEdit:function(e){var i,s,d=e.layer||e.target||e;this._backupLayer(d),this.options.poly&&(s=L.Util.extend({},this.options.poly),d.options.poly=s),this.options.selectedPathOptions&&(i=L.Util.extend({},this.options.selectedPathOptions),i.maintainColor&&(i.color=d.options.color,i.fillColor=d.options.fillColor),d.options.original=L.extend({},d.options),d.options.editing=i),d instanceof L.Marker?(d.editing&&d.editing.enable(),d.dragging.enable(),d.on("dragend",this._onMarkerDragEnd).on("touchmove",this._onTouchMove,this).on("MSPointerMove",this._onTouchMove,this).on("touchend",this._onMarkerDragEnd,this).on("MSPointerUp",this._onMarkerDragEnd,this)):d.editing.enable()},_disableLayerEdit:function(e){var i=e.layer||e.target||e;i.edited=!1,i.editing&&i.editing.disable(),delete i.options.editing,delete i.options.original,this._selectedPathOptions&&(i instanceof L.Marker?this._toggleMarkerHighlight(i):(i.setStyle(i.options.previousOptions),delete i.options.previousOptions)),i instanceof L.Marker?(i.dragging.disable(),i.off("dragend",this._onMarkerDragEnd,this).off("touchmove",this._onTouchMove,this).off("MSPointerMove",this._onTouchMove,this).off("touchend",this._onMarkerDragEnd,this).off("MSPointerUp",this._onMarkerDragEnd,this)):i.editing.disable()},_onMouseMove:function(e){this._tooltip.updatePosition(e.latlng)},_onMarkerDragEnd:function(e){var i=e.target;i.edited=!0,this._map.fire(L.Draw.Event.EDITMOVE,{layer:i})},_onTouchMove:function(e){var i=e.originalEvent.changedTouches[0],s=this._map.mouseEventToLayerPoint(i),d=this._map.layerPointToLatLng(s);e.target.setLatLng(d)},_hasAvailableLayers:function(){return this._featureGroup.getLayers().length!==0}}),L.EditToolbar.Delete=L.Handler.extend({statics:{TYPE:"remove"},initialize:function(e,i){if(L.Handler.prototype.initialize.call(this,e),L.Util.setOptions(this,i),this._deletableLayers=this.options.featureGroup,!(this._deletableLayers instanceof L.FeatureGroup))throw new Error("options.featureGroup must be a L.FeatureGroup");this.type=L.EditToolbar.Delete.TYPE;var s=L.version.split(".");parseInt(s[0],10)===1&&parseInt(s[1],10)>=2?L.EditToolbar.Delete.include(L.Evented.prototype):L.EditToolbar.Delete.include(L.Mixin.Events)},enable:function(){!this._enabled&&this._hasAvailableLayers()&&(this.fire("enabled",{handler:this.type}),this._map.fire(L.Draw.Event.DELETESTART,{handler:this.type}),L.Handler.prototype.enable.call(this),this._deletableLayers.on("layeradd",this._enableLayerDelete,this).on("layerremove",this._disableLayerDelete,this))},disable:function(){this._enabled&&(this._deletableLayers.off("layeradd",this._enableLayerDelete,this).off("layerremove",this._disableLayerDelete,this),L.Handler.prototype.disable.call(this),this._map.fire(L.Draw.Event.DELETESTOP,{handler:this.type}),this.fire("disabled",{handler:this.type}))},addHooks:function(){var e=this._map;e&&(e.getContainer().focus(),this._deletableLayers.eachLayer(this._enableLayerDelete,this),this._deletedLayers=new L.LayerGroup,this._tooltip=new L.Draw.Tooltip(this._map),this._tooltip.updateContent({text:L.drawLocal.edit.handlers.remove.tooltip.text}),this._map.on("mousemove",this._onMouseMove,this))},removeHooks:function(){this._map&&(this._deletableLayers.eachLayer(this._disableLayerDelete,this),this._deletedLayers=null,this._tooltip.dispose(),this._tooltip=null,this._map.off("mousemove",this._onMouseMove,this))},revertLayers:function(){this._deletedLayers.eachLayer(function(e){this._deletableLayers.addLayer(e),e.fire("revert-deleted",{layer:e})},this)},save:function(){this._map.fire(L.Draw.Event.DELETED,{layers:this._deletedLayers})},removeAllLayers:function(){this._deletableLayers.eachLayer(function(e){this._removeLayer({layer:e})},this),this.save()},_enableLayerDelete:function(e){(e.layer||e.target||e).on("click",this._removeLayer,this)},_disableLayerDelete:function(e){var i=e.layer||e.target||e;i.off("click",this._removeLayer,this),this._deletedLayers.removeLayer(i)},_removeLayer:function(e){var i=e.layer||e.target||e;this._deletableLayers.removeLayer(i),this._deletedLayers.addLayer(i),i.fire("deleted")},_onMouseMove:function(e){this._tooltip.updatePosition(e.latlng)},_hasAvailableLayers:function(){return this._deletableLayers.getLayers().length!==0}})})(window,document);var ht=(()=>{class o{constructor(){this.mapData={}}setData(t,n,e){this.mapData={center:t,radius:n,type:e}}getData(){return this.mapData}static{this.\u0275fac=function(n){return new(n||o)}}static{this.\u0275prov=Ce({token:o,factory:o.\u0275fac,providedIn:"root"})}}return o})();function Ua(o,p){if(o&1){let t=R();a(0,"div",0)(1,"h5"),l(2,"Area On Map"),r(),a(3,"div",1),f("click",function(){S(t);let e=C();return E(e.close())}),u(4,"i",2),r()(),a(5,"div",3)(6,"div",4)(7,"div",5),u(8,"div",6),r()()()}}function Ba(o,p){o&1&&(a(0,"div",4)(1,"div",5),u(2,"div",6),r()())}var gt=(()=>{class o{constructor(t,n,e,i){this.platformId=t,this.http=n,this.modalService=e,this.mapService=i,this.mapAddress=new W,this.sourceMarker=null,this.destinationMarker=null,this.circle=null,this.polyline=null,this.polygon=null,this.drawnFeatures=new de.FeatureGroup}ngOnInit(){nt(this.platformId)&&this.initializeMap().then(()=>{this.mapType=="show on Map"&&this.formatMapData(this.mapData)})}initializeMap(){return Ye(this,null,function*(){let n=(yield import("./chunk-64NQCRD3.js")).default;this.map=n.map("area_map",{center:[28.6139,77.2088],zoom:6,zoomControl:!1}),n.control.zoom({position:"bottomright"}).addTo(this.map);let e=n.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:"\xA9 OpenStreetMap contributors"}),i=n.tileLayer("http://www.google.cn/maps/vt?lyrs=s@189&gl=cn&x={x}&y={y}&z={z}",{attribution:'Imagery \xA9 <a href="http://maps.google.com">Google</a>',maxZoom:21}),d={"Google Map":n.tileLayer("http://{s}.google.com/vt/lyrs=m&x={x}&y={y}&z={z}",{maxZoom:21,subdomains:["mt0","mt1","mt2","mt3"],attribution:"&copy; Google Maps"}).addTo(this.map),OpenStreetMap:e,Satellite:i};n.control.layers(d).addTo(this.map),this.map.addLayer(this.drawnFeatures),this.drawControl=new n.Control.Draw({position:"topleft",draw:{polyline:!1,polygon:!0,rectangle:!1,circle:!0,marker:!1,circlemarker:!1},edit:{featureGroup:this.drawnFeatures,remove:!0}}),this.map.addControl(this.drawControl),this.map.on("draw:created",v=>{this.clearMap();let y=v.layer;this.drawnFeatures.clearLayers(),this.drawnFeatures.addLayer(y),this.updateShapeDetails(y,v.layerType,"Add")}),this.map.on("draw:edited",v=>{v.layers.eachLayer(y=>{y instanceof n.Circle?this.updateShapeDetails(y,"circle","Update"):y instanceof n.Polygon&&this.updateShapeDetails(y,"polygon","Update")})}),this.map.on("draw:deleted",v=>{v.layers.eachLayer(y=>{this.handleRemovedLayer(y)})})})}handleRemovedLayer(t){let n=null;if(t instanceof de.Circle){let e=t.getLatLng(),i=t.getRadius();n={type:"circle",center:e,radius:i},this.mapService?.setData("",0,1),this.mapAddress.emit({circle:"",radius:"",shapeType:1})}else if(t instanceof de.Rectangle||t instanceof de.Polygon){let e=t.getLatLngs();n={type:t instanceof de.Rectangle?"rectangle":"polygon",points:e},this.mapService?.setData("",0,2),this.mapAddress.emit({circle:"",radius:"",shapeType:2})}console.log("Removed Layer Details:",n)}ngOnChanges(t){t.markerData&&this.markerData&&this.updateMarkersAndFitBounds()}clearMap(){this.drawnFeatures.clearLayers(),this.polygon&&(this.map.removeLayer(this.polygon),this.polygon=null)}updateMarkersAndFitBounds(){if(!this.map){console.error("Map is not initialized yet.");return}let t=de.latLngBounds([]);if(this.sourceMarker&&this.map.removeLayer(this.sourceMarker),this.destinationMarker&&this.map.removeLayer(this.destinationMarker),this.circle&&this.map.removeLayer(this.circle),this.polyline&&this.map.removeLayer(this.polyline),this.polygon&&this.map.removeLayer(this.polygon),this.markerData?.sourceLat&&this.markerData?.sourceLon&&(this.sourceMarker=de.marker([this.markerData.sourceLat,this.markerData.sourceLon],{icon:de.icon({iconUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-icon.png",iconSize:[25,41],iconAnchor:[12,41]})}).addTo(this.map),t.extend([this.markerData.sourceLat,this.markerData.sourceLon])),this.markerData?.destinationLat&&this.markerData?.destinationLon&&(this.destinationMarker&&this.map.removeLayer(this.destinationMarker),this.destinationMarker=de.marker([this.markerData.destinationLat,this.markerData.destinationLon],{icon:de.icon({iconUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-icon.png",iconSize:[25,41],iconAnchor:[12,41]})}).addTo(this.map),t.extend([this.markerData.destinationLat,this.markerData.destinationLon])),this.markerData?.shape==="1"&&this.markerData?.radius)this.circle&&this.map.removeLayer(this.circle),this.circle=de.circle([this.markerData.sourceLat,this.markerData.sourceLon],{radius:+this.markerData.radius,color:this.markerData.colour||"blue"}).addTo(this.map),t.extend(this.circle.getBounds());else if(this.markerData?.shape==="2"&&this.markerData?.sourceLat&&this.markerData?.sourceLon&&this.markerData?.destinationLat&&this.markerData?.destinationLon){let n=de.latLng(this.markerData?.sourceLat,this.markerData?.sourceLon),e=de.latLng(this.markerData.destinationLat,this.markerData.destinationLon);this.fetchRoute(n,e,this.markerData?.geofanceText)}t.isValid()&&this.map.fitBounds(t,{padding:[50,50]})}fetchRoute(t,n,e){let i=de.latLngBounds([]),d=JSON.parse(e).map(v=>de.latLng(v[1],v[0]));this.polyline=de.polyline(d,{color:this.markerData.colour||"green"}).addTo(this.map),i.extend(this.polyline.getBounds()),d.push(d[0]),this.map.fitBounds(i,{padding:[50,50]})}close(){this.modalService.hide()}formatMapData(t){let n={sourceLat:t.source_lat,sourceLon:t.source_lon,destinationLat:t.destination_lat,destinationLon:t.destination_lon,shape:t.shape_type.toString(),colour:t.color_code,radius:t.radius,geofanceText:t.geofence_text};this.markerData=n,this.markerData&&this.map&&this.updateMarkersAndFitBounds()}updateShapeDetails(t,n,e){if(n==="circle"){let i=t.getRadius(),s=t.getLatLng();this.mapAddress.emit({circle:s,radius:i,shapeType:1})}else if(n==="polygon"){let i=t.getLatLngs()[0],s=i.map(d=>[d.lat,d.lng]);s.push([i[0].lat,i[0].lng]),this.mapAddress.emit({circle:s,radius:0,shapeType:2})}}static{this.\u0275fac=function(n){return new(n||o)(_(et),_(ot),_(k),_(ht))}}static{this.\u0275cmp=D({type:o,selectors:[["area-map"]],inputs:{markerData:"markerData"},outputs:{mapAddress:"mapAddress"},features:[Xe],decls:2,vars:1,consts:[[1,"modal-header","text-center"],[1,"close-modal",3,"click"],[1,"fa","fa-close",2,"cursor","pointer"],[1,"modal-body"],[1,"map-part"],[1,"map-container"],["id","area_map"]],template:function(n,e){n&1&&h(0,Ua,9,0)(1,Ba,3,0),n&2&&He(0,e.mapType=="show on Map"?0:1)},styles:["#area_map[_ngcontent-%COMP%]{width:100%;height:calc(100vh - 130px);border-radius:11px;z-index:0!important}"]})}}return o})();function qa(o,p){if(o&1){let t=R();a(0,"div",0)(1,"h5"),l(2,"Area On Map"),r(),a(3,"div",1),f("click",function(){S(t);let e=C();return E(e.close())}),u(4,"i",2),r()(),a(5,"div",3)(6,"div",4)(7,"div",5),u(8,"div",6),r()()()}}function ja(o,p){o&1&&(a(0,"div",4)(1,"div",5),u(2,"div",6),r()())}var ft=(()=>{class o{constructor(t,n,e,i){this.platformId=t,this.http=n,this.modalService=e,this.mapService=i,this.mapAddress=new W,this.sourceMarker=null,this.destinationMarker=null,this.circle=null,this.polyline=null}ngAfterViewInit(){nt(this.platformId)&&this.initializeMap().then(()=>{this.mapType=="show on Map"&&this.formatMapData(this.mapData)})}initializeMap(){return Ye(this,null,function*(){this.map=new google.maps.Map(document.getElementById("area_map"),{center:{lat:28.6139,lng:77.2088},zoom:6,mapTypeControl:!0,mapTypeControlOptions:{style:google.maps.MapTypeControlStyle.HORIZONTAL_BAR,position:google.maps.ControlPosition.LEFT_TOP,mapTypeIds:["roadmap","satellite"]},zoomControl:!0,zoomControlOptions:{position:google.maps.ControlPosition.RIGHT_BOTTOM}}),this.drawingManager=new google.maps.drawing.DrawingManager({drawingMode:null,drawingControl:!0,drawingControlOptions:{position:google.maps.ControlPosition.TOP_LEFT,drawingModes:[google.maps.drawing.OverlayType.CIRCLE,google.maps.drawing.OverlayType.POLYGON]},circleOptions:{fillColor:"#FF0000",fillOpacity:.2,strokeWeight:2,clickable:!1,editable:!0,zIndex:1},polygonOptions:{fillColor:"#00FF00",fillOpacity:.2,strokeWeight:2,clickable:!1,editable:!0,zIndex:1}}),this.drawingManager.setMap(this.map),google.maps.event.addListener(this.drawingManager,"overlaycomplete",t=>{this.clearMap(),t.type==="circle"?(this.circle=t.overlay,this.updateShapeDetails(this.circle,"circle","Add")):t.type==="polygon"&&(this.polygon=t.overlay,this.updateShapeDetails(this.polygon,"polygon","Add"))}),google.maps.event.addListener(this.drawingManager,"overlaycomplete",t=>{t.type==="circle"?this.updateShapeDetails(t.overlay,"circle","Update"):t.type==="polygon"&&this.updateShapeDetails(t.overlay,"polygon","Update")})})}handleRemovedLayer(t){t instanceof google.maps.Circle?this.mapAddress.emit({circle:"",radius:"",shapeType:1}):t instanceof google.maps.Polygon&&this.mapAddress.emit({circle:"",radius:"",shapeType:2})}ngOnChanges(t){t.markerData&&this.markerData&&this.updateMarkersAndFitBounds()}clearMap(){this.circle&&(this.circle.setMap(null),this.circle=null),this.polygon&&(this.polygon.setMap(null),this.polygon=null)}updateMarkersAndFitBounds(){if(!this.map){console.error("Map is not initialized yet.");return}let t=new google.maps.LatLngBounds;if(this.sourceMarker&&this.sourceMarker.setMap(null),this.destinationMarker&&this.destinationMarker.setMap(null),this.circle&&this.circle.setMap(null),this.polyline&&this.polyline.setMap(null),this.polygon&&this.polygon.setMap(null),this.markerData?.sourceLat&&this.markerData?.sourceLon&&(this.sourceMarker=new google.maps.Marker({position:{lat:this.markerData.sourceLat,lng:this.markerData.sourceLon},map:this.map,icon:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-icon.png"}),t.extend(this.sourceMarker.getPosition())),this.markerData?.destinationLat&&this.markerData?.destinationLon&&(this.destinationMarker=new google.maps.Marker({position:{lat:this.markerData.destinationLat,lng:this.markerData.destinationLon},map:this.map,icon:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-icon.png"}),t.extend(this.destinationMarker.getPosition())),this.markerData?.shape==="1"&&this.markerData?.radius)this.circle=new google.maps.Circle({map:this.map,center:{lat:this.markerData.sourceLat,lng:this.markerData.sourceLon},radius:+this.markerData.radius,strokeColor:this.markerData.colour||"blue",strokeOpacity:.8,strokeWeight:2,fillColor:this.markerData.colour||"blue",fillOpacity:.2}),t.union(this.circle.getBounds());else if(this.markerData?.shape==="2"){let e=JSON.parse(this.markerData.geofanceText).map(i=>({lat:i[1],lng:i[0]}));this.polyline=new google.maps.Polyline({path:e,geodesic:!0,strokeColor:this.markerData.colour||"green",strokeOpacity:.8,strokeWeight:5}),this.polyline.setMap(this.map),e.forEach(i=>t.extend(i))}t.isEmpty()||this.map.fitBounds(t)}updateShapeDetails(t,n,e){if(n==="circle"){let i=t.getCenter(),s=t.getRadius();i={lat:i.lat(),lng:i.lng()},this.mapAddress.emit({circle:i,radius:s,shapeType:1})}else if(n==="polygon"){let s=t.getPath().getArray().map(d=>[d.lat(),d.lng()]);this.mapAddress.emit({circle:s,radius:0,shapeType:2})}}close(){this.modalService.hide()}formatMapData(t){let n={sourceLat:t.source_lat,sourceLon:t.source_lon,destinationLat:t.destination_lat,destinationLon:t.destination_lon,shape:t.shape_type.toString(),colour:t.color_code,radius:t.radius,geofanceText:t.geofence_text};this.markerData=n,this.markerData&&this.map&&this.updateMarkersAndFitBounds()}static{this.\u0275fac=function(n){return new(n||o)(_(et),_(ot),_(k),_(ht))}}static{this.\u0275cmp=D({type:o,selectors:[["app-area-google-map"]],inputs:{markerData:"markerData"},outputs:{mapAddress:"mapAddress"},features:[Xe],decls:2,vars:1,consts:[[1,"modal-header","text-center"],[1,"close-modal",3,"click"],[1,"fa","fa-close",2,"cursor","pointer"],[1,"modal-body"],[1,"map-part"],[1,"map-container"],["id","area_map"]],template:function(n,e){n&1&&h(0,qa,9,0)(1,ja,3,0),n&2&&He(0,e.mapType=="show on Map"?0:1)},styles:["#area_map[_ngcontent-%COMP%]{width:100%;height:calc(100vh - 130px);border-radius:11px;z-index:0!important}"]})}}return o})();var Ga=["table"],Wa=()=>[25,50,100],Ci=(o,p,t)=>({id:"deptID",itemsPerPage:o,currentPage:p,totalItems:t});function Za(o,p){if(o&1){let t=R();a(0,"div",22)(1,"div",26)(2,"pagination-controls",27),f("pageChange",function(e){S(t);let i=C();return E(i.onTablePageChange(e))}),r()()()}o&2&&(c(2),m("maxSize",10)("responsive",!0)("nextLabel","")("previousLabel",""))}function Ha(o,p){if(o&1&&(a(0,"option",28),l(1),r()),o&2){let t=p.$implicit;m("value",t),c(),b(t)}}function Ka(o,p){if(o&1&&(pe(0),u(1,"app-skeleton-loader",29),F(2,"paginate"),ue()),o&2){let t=C();c(),m("columns",t.columns)("items",M(2,2,t.areaData,X(5,Ci,t.pagesize.limit,t.pagesize.offset,t.pagesize.count)))}}function $a(o,p){if(o&1&&(a(0,"th")(1,"span"),l(2),r()()),o&2){let t=p.$implicit;c(2),b(t==null?null:t.title)}}function Ya(o,p){o&1&&(a(0,"span",42),l(1,"Active"),r())}function Ja(o,p){o&1&&(a(0,"span",43),l(1,"Inactive"),r())}function Qa(o,p){if(o&1){let t=R();a(0,"tr")(1,"td"),l(2),r(),a(3,"td"),l(4),r(),a(5,"td"),l(6),r(),a(7,"td"),l(8),r(),a(9,"td"),l(10),r(),a(11,"td"),l(12),r(),a(13,"td"),l(14),r(),a(15,"td"),h(16,Ya,2,0,"span",35)(17,Ja,2,0,"ng-template",null,2,J),r(),a(19,"td",36)(20,"button",37),f("click",function(){let e=S(t).$implicit,i=C(2);return E(i.onCreateArea(e))}),u(21,"i",38),r(),a(22,"button",39),f("click",function(){let e=S(t).$implicit,i=C(2);return E(i.deleteArea(e))}),u(23,"i",40),r()(),a(24,"td")(25,"button",20),f("click",function(){let e=S(t).$implicit,i=C(2);return E(i.showOnMap(e))}),u(26,"i",41),r()()()}if(o&2){let t=p.$implicit,n=p.index,e=Y(18),i=C(2);c(2),b((i.pagesize.offset-1)*i.pagesize.limit+n+1),c(2),b(t==null?null:t.district_name),c(2),b(t==null?null:t.area_name),c(2),b(t==null?null:t.source_lat),c(2),b(t==null?null:t.source_lon),c(2),b((t==null?null:t.shape_type)===1?"Circle":(t==null?null:t.shape_type)===2?"Polygon":""),c(2),b(t==null?null:t.radius),c(2),m("ngIf",t==null?null:t.is_active)("ngIfElse",e)}}function Xa(o,p){o&1&&(a(0,"div",44),l(1," No area Available "),r())}function es(o,p){if(o&1&&(a(0,"div",30)(1,"table",31,1)(3,"thead")(4,"tr",32),h(5,$a,3,1,"th",33),r()(),a(6,"tbody"),h(7,Qa,27,9,"tr",33),F(8,"searchFilter"),F(9,"paginate"),r()(),h(10,Xa,2,0,"div",34),F(11,"searchFilter"),r()),o&2){let t,n=C();c(5),m("ngForOf",n.columns),c(2),m("ngForOf",M(9,6,M(8,3,n.areaData,n.searchKeyword),X(12,Ci,n.pagesize.limit,n.pagesize.offset,n.pagesize.count))),c(3),m("ngIf",!(n.areaData!=null&&n.areaData.length)||!((t=M(11,9,n.areaData,n.searchKeyword))!=null&&t.length))}}var Li=(()=>{class o{get startValue(){return this.pagesize.offset*this.pagesize.limit-(this.pagesize.limit-1)}get lastValue(){let t=this.startValue+this.pagesize.limit-1;return Math.min(t,this.pagesize.count)}constructor(t,n,e,i){this.modalService=t,this.areaService=n,this.notificationService=e,this.commonService=i,this.areaData=[],this.breadcrumbs=[{label:"Home",path:"/admin/dashboard/home"},{label:"Master",path:"/admin/master/zone-master"},{label:"Deparment Master",path:"/admin/master/department-master"}],this.isLoading=!0,this.pagesize={limit:25,offset:1,count:0}}ngOnInit(){this.userData=this.commonService.getUserDetails(),this.setInitialtable(),this.getAreaList(this.pagesize.offset,this.pagesize.limit)}setInitialtable(){this.columns=[{key:"S No.",title:"S No.",width:"5%"},{key:"City",title:"City"},{key:"Area",title:"Area"},{key:"Latitude",title:"Latitude"},{key:"Longitude",title:"Longitude"},{key:"Shape",title:"Shape"},{key:"Radius",title:"Radius"},{key:"Status",title:"Status"},{key:"Action",title:"Action",width:"10%"},{key:"Show On Map",title:"Show On Map"}]}getAreaList(t,n){this.isLoading=!0;let e={pageNo:t,pageSize:n};this.areaService.areaList(e).subscribe(i=>{this.isLoading=!1,this.areaData=i?.body?.result||[],this.pagesize.count=i?.body?.totalRow})}onTablePageChange(t){this.pagesize.offset=t,this.getAreaList(this.pagesize.offset,this.pagesize.limit)}onPageSizeChange(t){let n=parseInt(t.target.value,10);this.pagesize.limit=n,this.getAreaList(this.pagesize.offset,this.pagesize.limit)}onCreateArea(t){let n={initialState:{editData:t||""}};this.bsModalRef=this.modalService.show(ut,Object.assign(n,{id:"confirmation",class:"modal-xl modal-dialog-centered alert-popup"})),this.bsModalRef?.content?.mapdata?.subscribe(e=>{this.pagesize.offset=1,this.pagesize.limit=25,this.getAreaList(this.pagesize.offset,this.pagesize.limit)})}deleteArea(t){let n=this.areaService.deleteArea(t?.area_id),e={initialState:{title:t?.area_name,content:"Are you sure you want to delete?",primaryActionLabel:"Delete",secondaryActionLabel:"Cancel",service:n}};this.bsModalRef=this.modalService.show(be,Object.assign(e,{id:"confirmation",class:"modal-md modal-dialog-centered"})),this.bsModalRef?.content.mapdata.subscribe(i=>{i?.status==200?(this.notificationService.successAlert(i?.body?.actionResponse),this.pagesize.offset=1,this.pagesize.limit=25,this.getAreaList(this.pagesize.offset,this.pagesize.limit)):this.notificationService.errorAlert(i?.title)})}showOnMap(t){let n;this.userData?.is_gmap_enabled===0?n=gt:this.userData?.is_gmap_enabled===1&&(n=ft);let e={initialState:{mapData:t||"",mapType:"show on Map"}};this.bsModalRef=this.modalService.show(n,Object.assign(e,{id:"confirmation",class:"modal-xl modal-dialog-centered alert-popup"}))}static{this.\u0275fac=function(n){return new(n||o)(_(k),_(rt),_(V),_(G))}}static{this.\u0275cmp=D({type:o,selectors:[["area-list"]],viewQuery:function(n,e){if(n&1&&Ve(Ga,7),n&2){let i;Te(i=Ne())&&(e.table=i.first)}},decls:31,vars:10,consts:[["content",""],["TABLE",""],["inactive",""],[1,"card"],[1,"card-header"],[1,"header-part"],[1,"counting"],["class","row",4,"ngIf"],[1,"card-body"],[1,"header-container"],[1,"left-section"],[1,"search-form"],["placeholder","Search for...","type","text",1,"form-control","search-input",3,"ngModelChange","ngModel"],["type","button",1,"btn-search"],["aria-hidden","true",1,"fa","fa-search"],[1,"right-section","flex","gap-x-2"],[1,"flex","items-center","space-x-2"],["for","itemsPerPage",1,"text-sm","text-gray-700"],["id","itemsPerPage",1,"block","w-20","p-2","bg-white","border","border-gray-300","rounded","shadow-sm","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:border-blue-500","text-gray-700",3,"ngModelChange","change","ngModel"],[3,"value",4,"ngFor","ngForOf"],[1,"btn","btn-primary",3,"click"],["aria-hidden","true",1,"fa","fa-plus"],[1,"row"],[1,"col-md-12"],[1,"overflow-auto"],[4,"ngIf","ngIfElse"],[1,"d-flex","justify-content-center"],["id","deptID",3,"pageChange","maxSize","responsive","nextLabel","previousLabel"],[3,"value"],[3,"columns","items"],["id","datatable_wrapper"],["id","datatable","role","grid","aria-describedby","datatable_info","width","100%",1,"table","table-striped","nowrap","dataTable","no-footer","dtr-inline",2,"width","100%"],["role","row"],[4,"ngFor","ngForOf"],["class","text-center py-4 text-gray-500",4,"ngIf"],["class","text-green-600 font-medium",4,"ngIf","ngIfElse"],[1,"flex","space-x-2"],[1,"btn","btn-success",3,"click"],[1,"fa","fa-pencil"],[1,"btn","btn-danger",3,"click"],[1,"fa","fa-trash"],[1,"fa","fa-long-arrow-up","rotate-45"],[1,"text-green-600","font-medium"],[1,"text-red-600","font-medium"],[1,"text-center","py-4","text-gray-500"]],template:function(n,e){if(n&1){let i=R();a(0,"div",3)(1,"div",4)(2,"div",5)(3,"span"),l(4,"Area Master"),r(),a(5,"div",6)(6,"span"),l(7),r()(),h(8,Za,3,4,"div",7),r()(),a(9,"div",8)(10,"div",9)(11,"div",10)(12,"div",11)(13,"input",12),$("ngModelChange",function(d){return S(i),K(e.searchKeyword,d)||(e.searchKeyword=d),E(d)}),r(),a(14,"button",13),u(15,"i",14),r()()(),a(16,"div",15)(17,"div",16)(18,"label",17),l(19,"Items per page:"),r(),a(20,"select",18),$("ngModelChange",function(d){return S(i),K(e.pagesize.limit,d)||(e.pagesize.limit=d),E(d)}),f("change",function(d){return S(i),E(e.onPageSizeChange(d))}),h(21,Ha,2,2,"option",19),r()(),a(22,"button",20),f("click",function(){return S(i),E(e.onCreateArea(""))}),u(23,"i",21),l(24," Create Area "),r()()(),a(25,"div",22)(26,"div",23)(27,"div",24),h(28,Ka,3,9,"ng-container",25)(29,es,12,16,"ng-template",null,0,J),r()()()()()}if(n&2){let i=Y(30);c(7),he(" ",e.pagesize.count>0?e.startValue:0," - ",e.pagesize.count>0?e.lastValue:0," OF ",e.pagesize.count>0?e.pagesize.count:0," Area "),c(),m("ngIf",e.pagesize.count&&e.pagesize.count>0),c(5),H("ngModel",e.searchKeyword),c(7),H("ngModel",e.pagesize.limit),c(),m("ngForOf",me(9,Wa)),c(7),m("ngIf",e.isLoading)("ngIfElse",i)}},dependencies:[I,z,ve,A,O,T,P,N,ge,ye,_e,fe]})}}return o})();var Si=(()=>{class o{static{this.\u0275fac=function(n){return new(n||o)}}static{this.\u0275cmp=D({type:o,selectors:[["app-manage-area"]],decls:2,vars:0,consts:[[1,"main-section"]],template:function(n,e){n&1&&(a(0,"div",0),u(1,"area-list"),r())},dependencies:[Li]})}}return o})();function is(o,p){o&1&&(a(0,"span",22),l(1," Nature Of Work is Required "),r())}function ns(o,p){o&1&&(a(0,"span",23),l(1," Work Uniq Id is Required "),r())}function os(o,p){if(o&1&&(a(0,"option",24),l(1),r()),o&2){let t=p.$implicit;m("ngValue",t.id),c(),b(t.value)}}function rs(o,p){o&1&&(a(0,"span",22),l(1," Status is Required "),r())}var Ei=(()=>{class o{constructor(t,n,e,i,s){this.commonService=t,this.fb=n,this.workService=e,this.notificationSerivce=i,this.bsModelService=s,this.mapdata=new W,this.config={displayKey:"text",search:!0,height:"300px"},this.natureWoekList=[],this.status=[{id:1,value:"Active"},{id:0,value:"Inactive"}],this.label="Create"}ngOnInit(){console.log(this.editData),this.setInitialvalue()}getNatureWorkList(){this.workService.natureWorkList().subscribe(t=>{if(this.natureWoekList=t?.body?.result,this.editData&&this.editData?.work_id){let n=this.natureWoekList.find(e=>e.value==this.editData?.nowtype_id);this.workForm.controls.nof.setValue(n)}})}setInitialvalue(){this.editData?(this.getNatureWorkList(),this.label="Update",this.workForm=this.fb.group({nof:[null,[g.required]],workId:[this.editData?.work_unique_code,g.required],mobile:[this.editData?.mobile_no],roadId:[this.editData?.road_id],status:[this.editData?.is_active,[g.required]]})):(this.workForm=this.fb.group({nof:[null,[g.required]],workId:["",g.required],mobile:[""],roadId:[""],status:[1,[g.required]]}),this.getNatureWorkList())}submit(t){if(this.workForm.invalid){this.workForm.markAllAsTouched();return}let n=this.commonService.getUserDetails(),e={work_id:0,work_unique_code:t.workId,mobile_no:t.mobile,road_id:t.roadId,nowtype_id:t?.nof?Number(t?.nof?.value):null,nowtype_name:t?.nof?t?.nof?.text:null,is_active:t?.status,created_by:n.user_id},i=this.workService.addWork(e);this.editData?.work_id&&(e.work_id=this.editData?.work_id,i=this.workService.updateWork(e,this.editData?.work_id)),i.subscribe(s=>{s?.status==200?(this.bsModelService.hide(),this.mapdata.emit(),this.notificationSerivce.successAlert(s?.body?.actionResponse)):this.notificationSerivce.errorAlert(s?.title)})}close(){this.bsModelService.hide()}static{this.\u0275fac=function(n){return new(n||o)(_(G),_(oe),_($e),_(V),_(k))}}static{this.\u0275cmp=D({type:o,selectors:[["app-create-work"]],outputs:{mapdata:"mapdata"},decls:43,vars:8,consts:[[1,"modal-header","text-center"],[1,"close-modal",3,"click"],[1,"fa","fa-close",2,"cursor","pointer"],[1,"modal-body"],[3,"formGroup"],[1,"_card","white-bg"],[1,"row"],[1,"col-md-6","mb-2"],[1,"form-label"],["formControlName","nof",3,"config","options"],["class","text-danger mt-2",4,"ngIf"],[1,"input-group","mb-2"],["type","text","formControlName","workId","placeholder","Enter Work Uniq Id","aria-describedby","button-addon2",1,"form-control"],["class","text-danger",4,"ngIf"],["type","text","formControlName","mobile","placeholder","Enter Mobile No.","aria-describedby","button-addon2",1,"form-control"],["type","text","formControlName","roadId","placeholder","Enter Road Id","aria-describedby","button-addon2",1,"form-control"],["formControlName","status",1,"form-control"],[3,"ngValue",4,"ngFor","ngForOf"],[1,"footer"],[1,"button-container"],["type","submit",1,"btn","btn-success",3,"click"],["type","button",1,"btn","btn-danger",3,"click"],[1,"text-danger","mt-2"],[1,"text-danger"],[3,"ngValue"]],template:function(n,e){if(n&1&&(a(0,"div",0)(1,"h5"),l(2),r(),a(3,"div",1),f("click",function(){return e.close()}),u(4,"i",2),r()(),a(5,"div",3)(6,"div")(7,"form",4)(8,"div",5)(9,"div",6)(10,"div",7)(11,"label",8),l(12,"Nature Of Work"),r(),u(13,"ngx-select-dropdown",9),h(14,is,2,0,"span",10),r(),a(15,"div",7)(16,"label",8),l(17,"Work Uniq Id"),r(),a(18,"div",11),u(19,"input",12),r(),h(20,ns,2,0,"span",13),r(),a(21,"div",7)(22,"label",8),l(23,"Mobile No."),r(),a(24,"div",11),u(25,"input",14),r()(),a(26,"div",7)(27,"label",8),l(28,"Road Id"),r(),a(29,"div",11),u(30,"input",15),r()(),a(31,"div",7)(32,"label",8),l(33,"Status"),r(),a(34,"select",16),h(35,os,2,2,"option",17),r(),h(36,rs,2,0,"span",10),r()()(),a(37,"div",18)(38,"div",19)(39,"button",20),f("click",function(){return e.submit(e.workForm.value)}),l(40,"Submit"),r(),a(41,"button",21),f("click",function(){return e.close()}),l(42,"Cancel"),r()()()()()()),n&2){let i,s,d;c(2),Q("",e.label," work"),c(5),m("formGroup",e.workForm),c(6),m("config",e.config)("options",e.natureWoekList),c(),m("ngIf",(e.workForm==null||(i=e.workForm.get("nof"))==null?null:i.invalid)&&((e.workForm==null||(i=e.workForm.get("nof"))==null?null:i.dirty)||(e.workForm==null||(i=e.workForm.get("nof"))==null?null:i.touched))),c(6),m("ngIf",(e.workForm==null||(s=e.workForm.get("workId"))==null?null:s.invalid)&&((e.workForm==null||(s=e.workForm.get("workId"))==null?null:s.dirty)||(e.workForm==null||(s=e.workForm.get("workId"))==null?null:s.touched))),c(15),m("ngForOf",e.status),c(),m("ngIf",(e.workForm==null||(d=e.workForm.get("status"))==null?null:d.invalid)&&((e.workForm==null||(d=e.workForm.get("status"))==null?null:d.dirty)||(e.workForm==null||(d=e.workForm.get("status"))==null?null:d.touched)))}},dependencies:[I,z,se,te,A,O,T,P,N,ee,ie,ne]})}}return o})();var as=["table"],ss=()=>[25,50,100],wi=(o,p,t)=>({id:"workID",itemsPerPage:o,currentPage:p,totalItems:t});function ls(o,p){if(o&1){let t=R();a(0,"div",22)(1,"div",26)(2,"pagination-controls",27),f("pageChange",function(e){S(t);let i=C();return E(i.onTablePageChange(e))}),r()()()}o&2&&(c(2),m("maxSize",10)("responsive",!0)("nextLabel","")("previousLabel",""))}function cs(o,p){if(o&1&&(a(0,"option",28),l(1),r()),o&2){let t=p.$implicit;m("value",t),c(),b(t)}}function ds(o,p){if(o&1&&(pe(0),u(1,"app-skeleton-loader",29),F(2,"paginate"),ue()),o&2){let t=C();c(),m("isLoading",t.isLoading)("columns",t.columns)("items",M(2,3,t.workList,X(6,wi,t.pagesize.limit,t.pagesize.offset,t.pagesize.count)))}}function ms(o,p){if(o&1&&(a(0,"th")(1,"span"),l(2),r()()),o&2){let t=p.$implicit;c(2),b(t==null?null:t.title)}}function ps(o,p){o&1&&(a(0,"span",41),l(1,"Active"),r())}function us(o,p){o&1&&(a(0,"span",42),l(1,"Inactive"),r())}function hs(o,p){if(o&1){let t=R();a(0,"tr")(1,"td"),l(2),r(),a(3,"td"),l(4),r(),a(5,"td"),l(6),r(),a(7,"td"),l(8),r(),a(9,"td"),l(10),r(),a(11,"td"),h(12,ps,2,0,"span",35)(13,us,2,0,"ng-template",null,2,J),r(),a(15,"td",36)(16,"button",37),f("click",function(){let e=S(t).$implicit,i=C(2);return E(i.onCreateWork(e))}),u(17,"i",38),r(),a(18,"button",39),f("click",function(){let e=S(t).$implicit,i=C(2);return E(i.deleteWork(e))}),u(19,"i",40),r()()()}if(o&2){let t=p.$implicit,n=p.index,e=Y(14),i=C(2);c(2),b((i.pagesize.offset-1)*i.pagesize.limit+n+1),c(2),b(t==null?null:t.nowtype_name),c(2),b(t==null?null:t.work_unique_code),c(2),b(t==null?null:t.mobile_no),c(2),b(t==null?null:t.road_id),c(2),m("ngIf",t==null?null:t.is_active)("ngIfElse",e)}}function gs(o,p){o&1&&(a(0,"div",43),l(1," No Work Available "),r())}function fs(o,p){if(o&1&&(a(0,"div",30)(1,"table",31,1)(3,"thead")(4,"tr",32),h(5,ms,3,1,"th",33),r()(),a(6,"tbody"),h(7,hs,20,7,"tr",33),F(8,"searchFilter"),F(9,"paginate"),r()(),h(10,gs,2,0,"div",34),F(11,"searchFilter"),r()),o&2){let t,n=C();c(5),m("ngForOf",n.columns),c(2),m("ngForOf",M(9,6,M(8,3,n.workList,n.searchKeyword),X(12,wi,n.pagesize.limit,n.pagesize.offset,n.pagesize.count))),c(3),m("ngIf",!(n.workList!=null&&n.workList.length)||!((t=M(11,9,n.workList,n.searchKeyword))!=null&&t.length))}}var Di=(()=>{class o{get startValue(){return this.pagesize.offset*this.pagesize.limit-(this.pagesize.limit-1)}get lastValue(){let t=this.startValue+this.pagesize.limit-1;return Math.min(t,this.pagesize.count)}constructor(t,n,e){this.workService=t,this.modalService=n,this.notificationSerivce=e,this.workList=[],this.breadcrumbs=[{label:"Home",path:"/admin/dashboard/home"},{label:"Master",path:"/admin/master/zone-master"},{label:"Deparment Master",path:"/admin/master/department-master"}],this.isLoading=!1,this.pagesize={limit:25,offset:1,count:0}}ngOnInit(){this.setInitialtable(),this.getWorkList(this.pagesize.offset,this.pagesize.limit)}setInitialtable(){this.columns=[{key:"S No.",title:"S No.",width:"5%"},{key:"Nature of Work",title:"Nature of Work"},{key:"Work Uniq ID",title:"Work Uniq ID"},{key:"Mobile No",title:"Mobile No"},{key:"Road Id",title:"Road Id"},{key:"Status",title:"Status"},{key:"Action",title:"Action",width:"10%"}]}getWorkList(t,n){this.isLoading=!0;let e={pageNo:t,pageSize:n};this.workService.workList(e).subscribe(i=>{this.isLoading=!1,this.workList=i?.body?.result||[],this.pagesize.count=i?.body?.totalRow})}onTablePageChange(t){this.pagesize.offset=t,this.getWorkList(this.pagesize.offset,this.pagesize.limit)}onPageSizeChange(t){let n=parseInt(t.target.value,10);this.pagesize.limit=n,this.getWorkList(this.pagesize.offset,this.pagesize.limit)}onCreateWork(t){let n={initialState:{editData:t||""}};this.bsModalRef=this.modalService.show(Ei,Object.assign(n,{id:"confirmation",class:"modal-md modal-dialog-centered alert-popup"})),this.bsModalRef?.content?.mapdata?.subscribe(e=>{this.pagesize.offset=1,this.pagesize.limit=25,this.getWorkList(this.pagesize.offset,this.pagesize.limit)})}deleteWork(t){let n=this.workService.deleteWork(t?.work_id),e={initialState:{title:t?.work_unique_code,content:"Are you sure you want to delete?",primaryActionLabel:"Delete",secondaryActionLabel:"Cancel",service:n}};this.bsModalRef=this.modalService.show(be,Object.assign(e,{id:"confirmation",class:"modal-md modal-dialog-centered"})),this.bsModalRef?.content.mapdata.subscribe(i=>{i?.status==200?(this.notificationSerivce.successAlert(i?.body?.actionResponse),this.pagesize.offset=1,this.pagesize.limit=25,this.getWorkList(this.pagesize.offset,this.pagesize.limit)):this.notificationSerivce.errorAlert(i?.title)})}static{this.\u0275fac=function(n){return new(n||o)(_($e),_(k),_(V))}}static{this.\u0275cmp=D({type:o,selectors:[["work-list"]],viewQuery:function(n,e){if(n&1&&Ve(as,7),n&2){let i;Te(i=Ne())&&(e.table=i.first)}},decls:31,vars:10,consts:[["content",""],["TABLE",""],["inactive",""],[1,"card"],[1,"card-header"],[1,"header-part"],[1,"counting"],["class","row",4,"ngIf"],[1,"card-body"],[1,"header-container"],[1,"left-section"],[1,"search-form"],["placeholder","Search for...","type","text",1,"form-control","search-input",3,"ngModelChange","ngModel"],["type","button",1,"btn-search"],["aria-hidden","true",1,"fa","fa-search"],[1,"right-section","flex","gap-x-2"],[1,"flex","items-center","space-x-2"],["for","itemsPerPage",1,"text-sm","text-gray-700"],["id","itemsPerPage",1,"block","w-20","p-2","bg-white","border","border-gray-300","rounded","shadow-sm","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:border-blue-500","text-gray-700",3,"ngModelChange","change","ngModel"],[3,"value",4,"ngFor","ngForOf"],[1,"btn","btn-primary",3,"click"],["aria-hidden","true",1,"fa","fa-plus"],[1,"row"],[1,"col-md-12"],[1,"overflow-auto"],[4,"ngIf","ngIfElse"],[1,"d-flex","justify-content-center"],["id","workID",3,"pageChange","maxSize","responsive","nextLabel","previousLabel"],[3,"value"],[3,"isLoading","columns","items"],["id","datatable_wrapper"],["id","datatable","role","grid","aria-describedby","datatable_info","width","100%",1,"table","table-striped","nowrap","dataTable","no-footer","dtr-inline",2,"width","100%"],["role","row"],[4,"ngFor","ngForOf"],["class","text-center py-4 text-gray-500",4,"ngIf"],["class","text-green-600 font-medium",4,"ngIf","ngIfElse"],[1,"flex","space-x-2"],[1,"btn","btn-success",3,"click"],[1,"fa","fa-pencil"],[1,"btn","btn-danger",3,"click"],[1,"fa","fa-trash"],[1,"text-green-600","font-medium"],[1,"text-red-600","font-medium"],[1,"text-center","py-4","text-gray-500"]],template:function(n,e){if(n&1){let i=R();a(0,"div",3)(1,"div",4)(2,"div",5)(3,"span"),l(4,"Work Master"),r(),a(5,"div",6)(6,"span"),l(7),r()(),h(8,ls,3,4,"div",7),r()(),a(9,"div",8)(10,"div",9)(11,"div",10)(12,"div",11)(13,"input",12),$("ngModelChange",function(d){return S(i),K(e.searchKeyword,d)||(e.searchKeyword=d),E(d)}),r(),a(14,"button",13),u(15,"i",14),r()()(),a(16,"div",15)(17,"div",16)(18,"label",17),l(19,"Items per page:"),r(),a(20,"select",18),$("ngModelChange",function(d){return S(i),K(e.pagesize.limit,d)||(e.pagesize.limit=d),E(d)}),f("change",function(d){return S(i),E(e.onPageSizeChange(d))}),h(21,cs,2,2,"option",19),r()(),a(22,"button",20),f("click",function(){return S(i),E(e.onCreateWork(""))}),u(23,"i",21),l(24," Create Work "),r()()(),a(25,"div",22)(26,"div",23)(27,"div",24),h(28,ds,3,10,"ng-container",25)(29,fs,12,16,"ng-template",null,0,J),r()()()()()}if(n&2){let i=Y(30);c(7),he(" ",e.pagesize.count>0?e.startValue:0," - ",e.pagesize.count>0?e.lastValue:0," OF ",e.pagesize.count>0?e.pagesize.count:0," Work "),c(),m("ngIf",e.pagesize.count&&e.pagesize.count>0),c(5),H("ngModel",e.searchKeyword),c(7),H("ngModel",e.pagesize.limit),c(),m("ngForOf",me(9,ss)),c(7),m("ngIf",e.isLoading)("ngIfElse",i)}},dependencies:[I,z,ve,A,O,T,P,N,ge,ye,_e,fe]})}}return o})();var xi=(()=>{class o{static{this.\u0275fac=function(n){return new(n||o)}}static{this.\u0275cmp=D({type:o,selectors:[["app-maange-work"]],decls:2,vars:0,consts:[[1,"main-section"]],template:function(n,e){n&1&&(a(0,"div",0),u(1,"work-list"),r())},dependencies:[Di]})}}return o})();var vs=[{path:"",children:[{path:"department-master",component:hi},{path:"designation-master",component:yi},{path:"zone-master",component:Nt},{path:"user-master",component:Ot},{path:"circle-master",component:jt},{path:"district-master",component:Kt},{path:"division-master",component:Xt},{path:"category-master",component:oi},{path:"subcategory-master",component:ci},{path:"area-master",component:Si},{path:"work-master",component:xi}]}],ki=(()=>{class o{static{this.\u0275fac=function(n){return new(n||o)}}static{this.\u0275mod=Qe({type:o})}static{this.\u0275inj=Je({imports:[_t.forChild(vs),_t]})}}return o})();var Lp=(()=>{class o{static{this.\u0275fac=function(n){return new(n||o)}}static{this.\u0275mod=Qe({type:o})}static{this.\u0275inj=Je({imports:[xt,ki,Mt]})}}return o})();Dt(ut,[I,z,se,te,A,O,T,kt,P,Ft,N,ee,ie,ne,gt,ft],[]);export{Lp as MasterModule};
