import{a as Y}from"./chunk-CVUUHYCZ.js";import{a as U}from"./chunk-CYXIDJUQ.js";import{A as g,B as m,Ha as I,K as a,L as n,M as p,N as v,Na as L,O as C,Oa as _,Pa as V,Q as O,Qa as z,Sa as j,Va as G,W as E,Wa as R,X as s,Xa as B,Y as b,Ya as D,Za as F,_a as A,la as H,lb as q,n as y,oa as M,p as f,pa as x,pb as W,q as h,sa as T,ta as N,ua as k,v as w,x as l,y as c}from"./chunk-XSDZE57B.js";import"./chunk-7RV22KDK.js";import{i as P}from"./chunk-P2VZOJAX.js";function te(e,u){if(e&1&&(a(0,"option",16),s(1),n()),e&2){let t=u.$implicit;m("value",t.id),l(),b(t.dateValue)}}function ie(e,u){e&1&&(v(0),a(1,"div",5)(2,"label",17),s(3,"From Date"),n(),a(4,"div",18),p(5,"input",19),n()(),a(6,"div",5)(7,"label",17),s(8,"To Date"),n(),p(9,"input",20),n(),C())}var Z=(()=>{class e{constructor(t,i,o,r){this.commonService=t,this.poiService=i,this.fb=o,this.datepipe=r,this.config={displayKey:"text",search:!0,height:"300px"},this.selectDate=[{id:"Today",dateValue:"Today"},{id:"Yesterday",dateValue:"Yesterday"},{id:"Weekly",dateValue:"Weekly"},{id:"Last 30 Days",dateValue:"Last 30 Days"},{id:"Custom",dateValue:"Custom"}],this.customDate=!1}ngOnInit(){this.setInitialValue(),this.getDesignationList()}setInitialValue(){let t=new Date;t.setHours(0,0,0);let i=new Date(t);i.setHours(23,59,59),this.historyForm=this.fb.group({designation:[null,[_.required]],user:[null,[_.required]],timeformat:["Today",[_.required]],fromDate:[this.formatDateForInput(t)],toDate:[this.formatDateForInput(i)]}),this.historyForm.get("timeformat")?.valueChanges.subscribe(o=>{let r=new Date(t),d=new Date(i);if(o==="Custom")this.historyForm.get("fromDate")?.setValue(this.formatDateForInput(t)),this.historyForm.get("toDate")?.setValue(this.formatDateForInput(i));else{switch(o){case"Yesterday":r.setDate(r.getDate()-1),d.setDate(d.getDate()-1);break;case"Weekly":r.setDate(r.getDate()-7);break;case"Last 30 Days":r.setDate(r.getDate()-30);break;default:break}this.historyForm.get("fromDate")?.setValue(this.formatDateForInput(r)),this.historyForm.get("toDate")?.setValue(this.formatDateForInput(d))}})}formatDateForInput(t){return this.datepipe.transform(t,"yyyy-MM-ddTHH:mm:ss")}getDesignationList(){this.commonService.designationList().subscribe(t=>{this.desigantionList=t?.body?.result})}onChangeDesi(t){this.getUserBydesignation(t.value?.value)}getUserBydesignation(t){this.poiService.getUserBudesi(t).subscribe(i=>{this.userList=i?.body?.result})}timecheck(t){console.log(t.target.value),t.target.value==="Custom"?this.customDate=!0:this.customDate=!1}static{this.\u0275fac=function(i){return new(i||e)(c(U),c(Y),c(A),c(T))}}static{this.\u0275cmp=f({type:e,selectors:[["app-history-filter"]],decls:26,vars:7,consts:[[1,"card"],[1,"card-header"],[1,"card-body"],[3,"formGroup"],[1,"row"],[1,"col-md-6","mb-2"],[1,"form-label"],["formControlName","designation",3,"change","config","options"],["formControlName","user",3,"config","options"],[1,"col-md-12","mb-2"],["formControlName","timeformat",1,"form-control",3,"change"],[3,"value",4,"ngFor","ngForOf"],[4,"ngIf"],[1,"col-md-6"],["type","submit",1,"btn","btn-success",2,"width","100%"],["type","button",1,"btn","btn-danger",2,"width","100%"],[3,"value"],["for","exampleInputEmail1",1,"form-label"],[1,"input-group","mb-2"],["type","datetime-local","formControlName","fromDate","placeholder","dd/MM/yyy","aria-describedby","button-addon2",1,"form-control"],["type","datetime-local","formControlName","toDate","placeholder","dd/MM/yyy","aria-describedby","button-addon2",1,"form-control"]],template:function(i,o){i&1&&(a(0,"div",0)(1,"div",1),s(2," History Track "),n(),a(3,"div",2)(4,"form",3)(5,"div",4)(6,"div",5)(7,"label",6),s(8,"Designation"),n(),a(9,"ngx-select-dropdown",7),O("change",function(d){return o.onChangeDesi(d)}),n()(),a(10,"div",5)(11,"label",6),s(12,"User"),n(),p(13,"ngx-select-dropdown",8),n(),a(14,"div",9)(15,"label",6),s(16,"Time Format"),n(),a(17,"select",10),O("change",function(d){return o.timecheck(d)}),g(18,te,2,2,"option",11),n()(),g(19,ie,10,0,"ng-container",12),a(20,"div",13)(21,"button",14),s(22,"Submit"),n()(),a(23,"div",13)(24,"button",15),s(25,"Cancel"),n()()()()()()),i&2&&(l(4),m("formGroup",o.historyForm),l(5),m("config",o.config)("options",o.desigantionList),l(4),m("config",o.config)("options",o.userList),l(5),m("ngForOf",o.selectDate),l(),m("ngIf",o.customDate))},dependencies:[M,x,q,j,D,F,L,B,V,z,G,R],styles:[".mat-form-field[_ngcontent-%COMP%]{height:0px}.mat-form-field[_ngcontent-%COMP%]{position:relative;text-align:left;display:inline}"]})}}return e})();function ne(e,u){e&1&&(v(0),p(1,"i",18),C())}function ae(e,u){e&1&&p(0,"i",19)}function re(e,u){if(e&1&&(a(0,"option",20),s(1),n()),e&2){let t=u.$implicit;m("value",t.id),l(),b(t.value)}}var K=(()=>{class e{constructor(t){this.platformId=t,this.breadcrumbs=[{label:"Home",path:"/admin/dashboard/home"},{label:"History",path:"/admin/history/play-back"}],this.isPlaying=!1,this.sliderValue=0,this.speed=[{id:1,value:"1x"},{id:2,value:"2x"},{id:4,value:"3x"},{id:16,value:"4x"},{id:32,value:"5x"}]}ngOnInit(){k(this.platformId)&&this.initializeMap()}initializeMap(){return P(this,null,function*(){let i=(yield import("./chunk-64NQCRD3.js")).default;this.map=i.map("history_map",{center:[28.6139,77.2088],zoom:6});let o=document.getElementById("history_map");o&&(o.style.zIndex="100");let r=i.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:"&copy; OpenStreetMap contributors",maxZoom:21}),d=i.tileLayer("http://www.google.cn/maps/vt?lyrs=s@189&gl=cn&x={x}&y={y}&z={z}",{attribution:'Imagery \xA9 <a href="http://maps.google.com">Google</a>',maxZoom:21}),Q={"Google Map":i.tileLayer("http://{s}.google.com/vt/lyrs=m&x={x}&y={y}&z={z}",{maxZoom:21,subdomains:["mt0","mt1","mt2","mt3"],attribution:"&copy; Google Maps"}).addTo(this.map),OpenStreetMap:r,Satellite:d};i.control.layers(Q).addTo(this.map)})}togglePlayPause(t){this.isPlaying=!this.isPlaying}static{this.\u0275fac=function(i){return new(i||e)(c(w))}}static{this.\u0275cmp=f({type:e,selectors:[["history-map"]],decls:21,vars:5,consts:[["playIcon",""],[1,"row"],[1,"col-md-4"],[1,"col-md-8"],[1,"map-part"],[1,"map-container"],["id","history_map"],[1,"slider-part"],[1,"play-button"],[1,"button-play"],[4,"ngIf","ngIfElse"],[1,"slider-vehicle"],["type","range","min","1","id","myRange",1,"slider",3,"max","value"],[1,"speed-value",2,"margin-left","13px"],["name","","id",""],[3,"value",4,"ngFor","ngForOf"],[1,"total-distance"],[1,"distance"],["aria-hidden","true",1,"fa","fa-pause",2,"margin-right","5px"],["aria-hidden","true",1,"fa","fa-play"],[3,"value"]],template:function(i,o){if(i&1&&(a(0,"div",1)(1,"div",2),p(2,"app-history-filter"),n(),a(3,"div",3)(4,"div",4)(5,"div",5),p(6,"div",6),a(7,"div",7)(8,"div",8)(9,"button",9),g(10,ne,2,0,"ng-container",10)(11,ae,1,0,"ng-template",null,0,H),n()(),a(13,"div",11),p(14,"input",12),n(),a(15,"div",13)(16,"select",14),g(17,re,2,2,"option",15),n()(),a(18,"div",16)(19,"span",17),s(20,"Distance : Km"),n()()()()()()()),i&2){let r=E(12);l(10),m("ngIf",o.isPlaying)("ngIfElse",r),l(4),m("max",(o.historylist==null?null:o.historylist.length)-1)("value",o.sliderValue),l(3),m("ngForOf",o.speed)}},dependencies:[M,x,D,F,Z],styles:["#history_map[_ngcontent-%COMP%]{position:relative;width:100%;height:calc(100vh - 89px);border-radius:11px;z-index:0!important}.map-container[_ngcontent-%COMP%]{position:relative}.slider-part[_ngcontent-%COMP%]{position:absolute;display:flex;flex-wrap:wrap;gap:8px;justify-content:center;align-items:center;z-index:99999;top:calc(100% - 63px);left:50%;transform:translate(-50%);width:95%;padding:13px;background-color:#ffffffe6;border:1px solid grey;box-shadow:0 4px 8px #0000001a;border-radius:8px}.slider-part[_ngcontent-%COMP%]   .play-button[_ngcontent-%COMP%]{flex:0 0 10px}.slider-part[_ngcontent-%COMP%]   .play-button[_ngcontent-%COMP%]   .button-play[_ngcontent-%COMP%]{background:none;border:none}.slider-part[_ngcontent-%COMP%]   .play-button[_ngcontent-%COMP%]   .fa.fa-play[_ngcontent-%COMP%], .slider-part[_ngcontent-%COMP%]   .play-button[_ngcontent-%COMP%]   .fa.fa-pause[_ngcontent-%COMP%]{font-size:16px}.slider-part[_ngcontent-%COMP%]   .slider-vehicle[_ngcontent-%COMP%]{flex:4 0 140px}.slider-part[_ngcontent-%COMP%]   .speed-value[_ngcontent-%COMP%]{flex:0 0 10px}.slider-part[_ngcontent-%COMP%]   .total-distance[_ngcontent-%COMP%]{flex:1 0 60px}.slider-part[_ngcontent-%COMP%]   input#myRange[_ngcontent-%COMP%]{width:100%;height:3px;border-radius:2px;background:#6868fa;outline:none;opacity:1;-webkit-transition:.2s;transition:opacity .2s}"]})}}return e})();var $=(()=>{class e{static{this.\u0275fac=function(i){return new(i||e)}}static{this.\u0275cmp=f({type:e,selectors:[["app-manage-history"]],decls:2,vars:0,consts:[[1,"main-section"]],template:function(i,o){i&1&&(a(0,"div",0),p(1,"history-map"),n())},dependencies:[K]})}}return e})();var le=[{path:"play-back",component:$}],J=(()=>{class e{static{this.\u0275fac=function(i){return new(i||e)}}static{this.\u0275mod=h({type:e})}static{this.\u0275inj=y({imports:[I.forChild(le),I]})}}return e})();var He=(()=>{class e{static{this.\u0275fac=function(i){return new(i||e)}}static{this.\u0275mod=h({type:e})}static{this.\u0275inj=y({imports:[N,J,W]})}}return e})();export{He as HistoryTrackingModule};
